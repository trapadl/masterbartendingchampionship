import{m as A,r as h,j as e,N as T,p as M,M as P,P as W,c as B,s as H}from"./main-COXODfts.js";const k=B("PublicProfilePage"),I=({bartenderId:u,bartenderName:l})=>{const[C,D]=h.useState([]),[$,f]=h.useState(!0),[b,j]=h.useState(null);h.useEffect(()=>{(async()=>{if(!u){f(!1),j("Bartender ID is missing.");return}f(!0),j(null),k.debug(`Fetching history for bartender ID: ${u}`);try{const{data:c,error:r}=await H.from("legacy_results").select(`placement,
             post_competition_rating,
             pre_competition_rating,
             legacy_competition_id,
             legacy_competitions (
               id,
               name,
               date
             )`).eq("bartender_id",u).order("date",{ascending:!1,foreignTable:"legacy_competitions"}).limit(10);if(r)throw r;k.debug("Fetched competition history",{bartenderId:u,resultCount:c==null?void 0:c.length}),D(c||[])}catch(c){k.error("Error fetching competition history:",{bartenderId:u,error:c}),j(`Failed to load competition history: ${c.message}`)}finally{f(!1)}})()},[u]);const L=(m,c)=>m==null||c==null?"?":Math.round(c-m);return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-8",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Recent Competition History"}),$?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx("div",{className:"animate-spin h-6 w-6 border-4 border-blue-600 rounded-full border-t-transparent"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading history..."})]}):b?e.jsx("div",{className:"text-red-600 p-4 text-center bg-red-50 rounded border border-red-200 text-sm",children:b}):C.length===0?e.jsx("div",{className:"text-gray-500 p-6 text-center italic text-sm",children:"No competition history found."}):e.jsx("div",{className:"space-y-3",children:C.map((m,c)=>{var N,i,g;const r=L(m.pre_competition_rating,m.post_competition_rating),S=(N=m.legacy_competitions)!=null&&N.date?new Date(m.legacy_competitions.date).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"}):"Unknown Date",E=r==="?"?"text-gray-500":r>0?"text-green-600":"text-red-600",v=(i=m.legacy_competitions)!=null&&i.id?`${m.legacy_competitions.id}-${c}`:c;return e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm leading-tight",children:((g=m.legacy_competitions)==null?void 0:g.name)||"Unknown Competition"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:S}),e.jsx("div",{className:`text-xs font-medium ${E}`,children:r==="?"?"?":r>=0?`+${r}`:r})]})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("span",{className:"text-xs text-gray-600",children:["Position: #",m.placement||"N/A"]})})]},v)})})]})},J=()=>{const{slug:u}=A(),[l,C]=h.useState(null),[D,$]=h.useState(!0),[f,b]=h.useState(null),[j,L]=h.useState(!1),[m,c]=h.useState(!1),[r,S]=h.useState(null);h.useEffect(()=>{u&&(async()=>{try{$(!0),b(null);const n=await W.getProfileBySlug(u);if(!n){L(!0);return}C(n),k.info("Public profile loaded",{slug:u})}catch(n){k.error("Error loading public profile",n),b(n.message)}finally{$(!1)}})()},[u]);const E=h.useCallback(()=>{if(!l)return[];const t=[],{employment:n=[],awards:y=[],cityChanges:o=[]}=l,w=(()=>{var s;if(o.length>0){const p=[...o].sort((x,G)=>new Date(G.move_date)-new Date(x.move_date))[0];if(p.to_cities){const x=p.to_cities;return`${x.city}${x.state?", "+x.state:""}, ${x.country}`}}if((s=l.profile)!=null&&s.cities){const d=l.profile.cities;return`${d.city}${d.state?", "+d.state:""}, ${d.country}`}return null})();return n.forEach(s=>{var p,x;const d=s.is_current&&w?w:s.venues?`${s.venues.city||"Unknown City"}, ${s.venues.country||"Unknown Country"}`:"Location unknown";t.push({type:"job_start",title:`Started as ${s.position_title}`,company:((p=s.venues)==null?void 0:p.name)||"Unknown Venue",date:s.start_date,location:d,id:`job_start_${s.id}`,rawData:s}),s.end_date&&!s.is_current&&t.push({type:"job_end",title:`Left ${s.position_title} position`,company:((x=s.venues)==null?void 0:x.name)||"Unknown Venue",date:s.end_date,location:d,id:`job_end_${s.id}`,rawData:s})}),y.forEach(s=>{var d,p;t.push({type:"award",title:s.award_title,event:((d=s.organisers)==null?void 0:d.organisation_name)||"Competition",date:s.award_date,location:((p=s.organisers)==null?void 0:p.organisation_name)||"Competition Location",id:`award_${s.id}`,rawData:s})}),o.forEach(s=>{var d;t.push({type:"city_move",title:`Moved to ${((d=s.to_cities)==null?void 0:d.city)||"Unknown City"}`,location:s.to_cities?`${s.to_cities.city}${s.to_cities.state?", "+s.to_cities.state:""}, ${s.to_cities.country}`:"Unknown Location",date:s.move_date,previousCity:s.from_cities?`${s.from_cities.city}${s.from_cities.state?", "+s.from_cities.state:""}, ${s.from_cities.country}`:"Unknown Location",id:`city_move_${s.id}`,rawData:s})}),t.sort((s,d)=>new Date(d.date)-new Date(s.date))},[l]),v=()=>{var n,y;if(!l||!l.employment)return{name:"Current Workplace",position:"Position",location:"Location unknown"};const t=l.employment.find(o=>o.is_current);if(t){const o=N();return{name:((n=t.venues)==null?void 0:n.name)||"Current Workplace",position:t.position_title,location:o||"Location unknown"}}if(l.employment.length>0){const o=l.employment.reduce((_,w)=>new Date(w.start_date)>new Date(_.start_date)?w:_);return{name:((y=o.venues)==null?void 0:y.name)||"Recent Workplace",position:o.position_title,location:o.venues?`${o.venues.city||"Unknown City"}, ${o.venues.country||"Unknown Country"}`:"Unknown Location"}}return{name:"Current Workplace",position:"Position",location:"Location unknown"}},N=()=>{var t;if(!l)return null;if(l.cityChanges&&l.cityChanges.length>0){const y=[...l.cityChanges].sort((o,_)=>new Date(_.move_date)-new Date(o.move_date))[0];if(y.to_cities){const o=y.to_cities;return`${o.city}${o.state?", "+o.state:""}, ${o.country}`}}if((t=l.profile)!=null&&t.cities){const n=l.profile.cities;return`${n.city}${n.state?", "+n.state:""}, ${n.country}`}return null};if(D)return e.jsx("div",{className:"profile-page",children:e.jsx("div",{className:"profile-container loading",children:e.jsx("div",{className:"loading-spinner",children:"Loading profile..."})})});if(j)return e.jsx(T,{to:"/error",replace:!0});if(f)return e.jsx("div",{className:"profile-page",children:e.jsxs("div",{className:"profile-container error",children:[e.jsx("h2",{children:"Error Loading Profile"}),e.jsx("p",{children:f})]})});if(!l)return e.jsx(T,{to:"/error",replace:!0});const{profile:i,bartender:g}=l,U=E(),a={coverPhoto:(i==null?void 0:i.cover_image_url)||M.cover,profilePhoto:(i==null?void 0:i.profile_image_url)||M.profile,fullName:(g==null?void 0:g.full_name)||"Bartender",currentEmployer:v().name,currentPosition:v().position,currentLocation:v().location,city:N()||"Location unknown",experience:U,socialMedia:{instagram:i==null?void 0:i.instagram_handle,facebook:i==null?void 0:i.facebook_handle,linkedin:i==null?void 0:i.linkedin_handle,x:i==null?void 0:i.x_handle,tiktok:i==null?void 0:i.tiktok_handle,snapchat:i==null?void 0:i.snapchat_handle,youtube:i==null?void 0:i.youtube_handle,reddit:i==null?void 0:i.reddit_handle,discord:i==null?void 0:i.discord_handle},cocktails:[{id:1,name:"Smoky Manhattan",description:"A classic Manhattan with a smoky twist using mezcal",style:"Classic",category:"Whiskey",image:M.cocktail,details:{iceType:"Large cube",glassType:"Coupe",method:["Add ingredients to mixing glass with ice","Stir for 30 seconds until well chilled","Double strain into chilled coupe glass","Express orange peel over drink and garnish"],ingredients:["2 oz Rye Whiskey","0.5 oz Mezcal","1 oz Sweet Vermouth","2 dashes Angostura Bitters"],garnish:"Orange peel"}},{id:2,name:"Garden Gimlet",description:"A fresh take on the classic gimlet with cucumber and herbs",style:"Modern",category:"Gin",image:M.cocktail,details:{iceType:"Cubed ice",glassType:"Nick & Nora",method:["Muddle cucumber and basil in shaker","Add remaining ingredients and ice","Shake vigorously for 15 seconds","Double strain into chilled glass"],ingredients:["2 oz London Dry Gin","0.75 oz Fresh lime juice","0.75 oz Simple syrup","3 cucumber slices","4 fresh basil leaves"],garnish:"Cucumber wheel and basil sprig"}}]},z=t=>{switch(t){case"job_start":case"job_end":return"💼";case"award":return"🏅";case"competition":return"🏆";case"city_move":return"✈️";default:return"📝"}},R=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),F=t=>{S(t),c(!0)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsxs("div",{className:"h-48 bg-gradient-to-r from-blue-500 to-purple-600 relative",children:[e.jsx(P,{src:a.coverPhoto,alt:"Cover",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-4 right-4 bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:"Public Profile"}),e.jsx("div",{className:"absolute -bottom-16 left-6",children:e.jsx("div",{className:"w-32 h-32 bg-white rounded-full p-1 shadow-lg",children:e.jsx(P,{src:a.profilePhoto,alt:"Profile",className:"w-full h-full rounded-full object-cover"})})})]}),e.jsx("div",{className:"relative px-6 pt-20 pb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:a.fullName}),e.jsx("p",{className:"text-xl text-gray-600 mb-1",children:a.currentEmployer}),e.jsx("p",{className:"text-lg text-gray-500",children:a.city})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Experience"})}),e.jsx("div",{className:"space-y-6",children:a.experience.map((t,n)=>e.jsxs("div",{className:"flex items-start space-x-4 p-3 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-lg",children:z(t.type)})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.title}),e.jsxs("p",{className:"text-gray-600",children:[t.company||t.event,t.type==="city_move"&&t.previousCity&&e.jsxs("span",{children:[" (from ",t.previousCity,")"]})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[R(t.date)," • ",t.location]})]})]},t.id||n))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Cocktails"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.cocktails.map(t=>e.jsxs("div",{onClick:()=>F(t),className:"border rounded-lg p-4 cursor-pointer hover:shadow-md transition-shadow",children:[e.jsx(P,{src:t.image,alt:t.name,className:"w-full h-32 object-cover rounded-md mb-3"}),e.jsx("h3",{className:"font-semibold text-lg text-gray-900",children:t.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:t.description}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:t.style}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:t.category})]})]},t.id))})]}),Object.values(a.socialMedia).some(t=>t)&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Connect"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[a.socialMedia.instagram&&e.jsxs("a",{href:`https://instagram.com/${a.socialMedia.instagram}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("span",{children:"📷"})," Instagram"]}),a.socialMedia.facebook&&e.jsxs("a",{href:`https://facebook.com/${a.socialMedia.facebook}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("span",{children:"📘"})," Facebook"]}),a.socialMedia.linkedin&&e.jsxs("a",{href:`https://linkedin.com/in/${a.socialMedia.linkedin}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("span",{children:"💼"})," LinkedIn"]}),a.socialMedia.x&&e.jsxs("a",{href:`https://x.com/${a.socialMedia.x}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("span",{children:"🐦"})," X (Twitter)"]}),a.socialMedia.tiktok&&e.jsxs("a",{href:`https://tiktok.com/@${a.socialMedia.tiktok}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("span",{children:"🎵"})," TikTok"]}),a.socialMedia.youtube&&e.jsxs("a",{href:`https://youtube.com/@${a.socialMedia.youtube}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("span",{children:"📺"})," YouTube"]})]})]})]}),e.jsx("div",{className:"lg:col-span-1 space-y-6",children:e.jsx(I,{bartenderId:g==null?void 0:g.id,bartenderName:a.fullName})})]})}),m&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r.name}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),e.jsx(P,{src:r.image,alt:r.name,className:"w-full h-48 object-cover rounded-lg mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:r.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Ice Type:"})," ",r.details.iceType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Glass Type:"})," ",r.details.glassType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Garnish:"})," ",r.details.garnish]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Ingredients"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:r.details.ingredients.map((t,n)=>e.jsx("li",{className:"text-sm",children:t},n))})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Method"}),e.jsx("ol",{className:"list-decimal list-inside space-y-2",children:r.details.method.map((t,n)=>e.jsx("li",{className:"text-sm",children:t},n))})]})]})})})]})};export{J as default};
