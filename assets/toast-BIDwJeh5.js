import{d as M,r as d,j as i}from"./main-D1s2dzev.js";var v,I;let h=(I=(v=import.meta)==null?void 0:v.env)==null?void 0:I.VITE_SUPABASE_URL;var E,A;let b=(A=(E=import.meta)==null?void 0:E.env)==null?void 0:A.VITE_SUPABASE_ANON_KEY;h||(h=window.SUPABASE_URL||"https://cfmekmzbphxfshuhbtgg.supabase.co");b||(b=window.SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNmbWVrbXpicGh4ZnNodWhidGdnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjg0MjU2ODAsImV4cCI6MjA0NDAwMTY4MH0.ydjY0MOhjiPji1H3-2JDdESr3w8D51RrmrdOc83pNx8");(!h||!b)&&console.error("Missing Supabase environment variables");let c;typeof window<"u"&&window.reactSupabaseClient?(console.log("Using React Supabase client to prevent duplicate instances"),c=window.reactSupabaseClient):c=M(h,b,{auth:{storageKey:"mbc_auth_legacy",persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{"X-Client-Info":"mbc-web-legacy"}}});typeof window<"u"&&(window.supabase=c);const B=a=>{console.error("Supabase error:",{message:a.message,details:a.details,hint:a.hint,code:a.code})},m={debug:(a,n,e)=>console.debug(`[${a}] ${n}`,e||""),info:(a,n,e)=>console.info(`[${a}] ${n}`,e||""),warn:(a,n,e)=>console.warn(`[${a}] ${n}`,e||""),error:(a,n,e)=>console.error(`[${a}] ${n}`,e||""),trace:(a,n,e)=>console.debug(`[${a}] ${n} completed in ${Date.now()-e}ms`)},_=a=>({debug:(n,e)=>m.debug(a,n,e),info:(n,e)=>m.info(a,n,e),warn:(n,e)=>m.warn(a,n,e),error:(n,e)=>m.error(a,n,e),trace:(n,e)=>m.trace(a,n,e)}),L=["Afghanistan","Albania","Algeria","Andorra","Angola","Antigua and Barbuda","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Côte d'Ivoire","Cabo Verde","Cambodia","Cameroon","Canada","Central African Republic","Chad","Chile","China","Colombia","Comoros","Congo","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Eswatini","Ethiopia","Fiji","Finland","France","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea","Guinea-Bissau","Guyana","Haiti","Holy See","Honduras","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","North Korea","North Macedonia","Norway","Oman","Pakistan","Palau","Palestine","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russia","Rwanda","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Sweden","Switzerland","Syria","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"],U=({onSelect:a,placeholder:n="Select an organizer"})=>{const[e,u]=d.useState(""),[t,p]=d.useState(!1),[S,y]=d.useState([]),[C,x]=d.useState(!1),[w,z]=d.useState(null);d.useEffect(()=>{if(!e.trim()){y([]);return}const s=setTimeout(async()=>{x(!0);try{const{data:l,error:g}=await c.from("organisers").select("id, organisation_name").ilike("organisation_name",`%${e}%`).order("organisation_name").limit(5);if(g)throw g;y(l||[])}catch(l){console.error("Error fetching organizers:",l),z("Failed to load organizers")}finally{x(!1)}},300);return()=>clearTimeout(s)},[e]);const N=async()=>{var r;try{const{data:{user:s}}=await c.auth.getUser();if(!s)throw new Error("Please sign in to add a new organizer");const{data:l,error:g}=await c.from("organisers").insert({organisation_name:e.trim(),full_name:((r=s.user_metadata)==null?void 0:r.full_name)||"",brand:"",user_id:s.id}).select().single();if(g)throw g;a(l),u(l.organisation_name),p(!1)}catch(s){console.error("Error adding new organizer:",s),z(s.message)}};return i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:e,onChange:r=>{u(r.target.value),p(!0)},placeholder:n,className:"w-full p-2 bg-zinc-700 text-white rounded border border-gray-600"}),t&&e.trim()&&i.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-zinc-800 rounded-md border border-gray-700 shadow-lg",children:[C&&i.jsx("div",{className:"p-2 text-gray-300 text-center",children:"Loading..."}),w&&i.jsx("div",{className:"p-2 text-red-400",children:w}),!C&&!w&&S.length>0&&i.jsxs("div",{children:[S.map(r=>i.jsx("div",{className:"p-2 hover:bg-zinc-700 cursor-pointer text-white",onClick:()=>{a(r),u(r.organisation_name),p(!1)},children:i.jsx("div",{children:r.organisation_name})},r.id)),i.jsx("div",{className:"border-t border-gray-700 mt-2"})]}),i.jsxs("div",{className:"p-2 hover:bg-zinc-700 cursor-pointer text-white flex justify-between items-center",onClick:N,children:[i.jsxs("span",{children:['+ Add "',e.trim(),'" as new organizer']}),i.jsx("span",{className:"text-gray-400",children:"→"})]})]})]})};let o;function j(){return o||(o=document.createElement("div"),o.className="fixed top-4 right-4 z-50 flex flex-col gap-2",document.body.appendChild(o)),o}function f(a,n="info",e=3e3){const u=j(),t=document.createElement("div");return t.className=`
    px-4 py-2 rounded shadow-lg text-white
    ${n==="error"?"bg-red-600":""}
    ${n==="success"?"bg-green-600":""}
    ${n==="info"?"bg-black":""}
    ${n==="warning"?"bg-yellow-600":""}
  `,t.textContent=a,u.appendChild(t),setTimeout(()=>{t.parentElement&&t.parentElement.removeChild(t),o&&o.children.length===0&&(document.body.removeChild(o),o=null)},e),t}const k=a=>f(a,"success"),O=a=>f(a,"error"),G=a=>f(a,"info");export{U as O,L as a,G as b,_ as c,k as d,O as e,B as l,c as s};
