import{s as d,g as m,l as y,c as E,i as b,b as S}from"./countdown-DoZ-_L6Q.js";async function w(){const t=document.querySelectorAll(".auth-tab"),e=document.querySelectorAll(".auth-form"),a=await E.getCurrentUser();a&&v(a),t==null||t.forEach(s=>{s.addEventListener("click",()=>{var i;const n=s.dataset.form;t.forEach(c=>c.classList.remove("active")),e.forEach(c=>c.classList.remove("active")),s.classList.add("active"),(i=document.getElementById(`${n}-form`))==null||i.classList.add("active")})});const o=document.getElementById("signin-form"),r=document.getElementById("signup-form");o==null||o.addEventListener("submit",q),r==null||r.addEventListener("submit",L)}async function q(t){t.preventDefault();const e=t.target,a=e.querySelector('input[type="email"]').value,o=e.querySelector('input[type="password"]').value,r=g(e),s=h(e);r.style.display="none",s.style.display="none";try{const{data:n,error:i}=await d.auth.signInWithPassword({email:a,password:o});if(i)throw i;if(n.user){s.textContent="Login successful! Redirecting...",s.style.display="block",v(n.user);const c=m();setTimeout(()=>{window.location.href=c},1500)}}catch(n){y(n),r.textContent=n.message||"Error signing in",r.style.display="block"}}async function L(t){t.preventDefault();const e=t.target,a=e.querySelector('input[name="fullName"]').value,o=e.querySelector('input[name="email"]').value,r=e.querySelector('input[name="password"]').value,s=e.querySelector('select[name="role"]').value,n=s==="bartender"?e.querySelector('input[name="bar"]').value:null,i=s==="organiser"?e.querySelector('input[name="brand"]').value:null,c=g(e),u=h(e);c.style.display="none",u.style.display="none";try{const{data:l,error:f}=await d.auth.signUp({email:o,password:r,options:{data:{full_name:a,role:s,bar:n,brand:i}}});if(f)throw f;l.user&&(u.textContent="Account created successfully! Please check your email for verification.",u.style.display="block",setTimeout(()=>{const p=m();window.location.href=p},3e3))}catch(l){y(l),c.textContent=l.message||"Error creating account",c.style.display="block"}}function v(t){const e=document.querySelector(".auth-container");e&&(e.innerHTML=`
      <div class="profile-summary">
        <h2>Welcome, ${t.user_metadata.full_name||"User"}</h2>
        <button onclick="handleSignOut()" class="submit-button">Sign Out</button>
      </div>
    `)}function g(t){let e=t.querySelector(".error-message");return e||(e=document.createElement("div"),e.className="error-message",t.insertBefore(e,t.firstChild)),e}function h(t){let e=t.querySelector(".success-message");return e||(e=document.createElement("div"),e.className="success-message",t.insertBefore(e,t.firstChild)),e}window.handleSignOut=async function(){try{const{error:t}=await d.auth.signOut();if(t)throw t;const e=m();window.location.href=e+"enter"}catch(t){y(t),alert("Error signing out. Please try again.")}};document.addEventListener("DOMContentLoaded",()=>{b(),S(),w()});function C(){const t=document.querySelectorAll(".auth-tab"),e=document.querySelectorAll(".auth-form"),a=document.querySelector('select[name="role"]'),o=document.querySelector(".bartender-fields"),r=document.querySelector(".organiser-fields");t.forEach(s=>{s.addEventListener("click",()=>{t.forEach(n=>n.classList.remove("active")),e.forEach(n=>n.classList.remove("active")),s.classList.add("active"),document.getElementById(`${s.dataset.form}-form`).classList.add("active")})}),a==null||a.addEventListener("change",s=>{s.target.value==="bartender"?(o.style.display="block",r.style.display="none"):(o.style.display="none",r.style.display="block")})}C();
