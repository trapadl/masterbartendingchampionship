import{l as M,r as o,j as n}from"./main-CyxRsl2n.js";var z,I;let c=(I=(z=import.meta)==null?void 0:z.env)==null?void 0:I.VITE_SUPABASE_URL;var A,v;let g=(v=(A=import.meta)==null?void 0:A.env)==null?void 0:v.VITE_SUPABASE_ANON_KEY;c||(c=window.SUPABASE_URL||"https://cfmekmzbphxfshuhbtgg.supabase.co");g||(g=window.SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNmbWVrbXpicGh4ZnNodWhidGdnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjg0MjU2ODAsImV4cCI6MjA0NDAwMTY4MH0.ydjY0MOhjiPji1H3-2JDdESr3w8D51RrmrdOc83pNx8");(!c||!g)&&console.error("Missing Supabase environment variables");let l;typeof window<"u"&&window.reactSupabaseClient?(console.log("Using React Supabase client to prevent duplicate instances"),l=window.reactSupabaseClient):l=M(c,g,{auth:{storageKey:"mbc_auth_legacy",persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{"X-Client-Info":"mbc-web-legacy"}}});typeof window<"u"&&(window.supabase=l);const E=e=>{console.error("Supabase error:",{message:e.message,details:e.details,hint:e.hint,code:e.code})},u={debug:(e,i,a)=>console.debug(`[${e}] ${i}`,a||""),info:(e,i,a)=>console.info(`[${e}] ${i}`,a||""),warn:(e,i,a)=>console.warn(`[${e}] ${i}`,a||""),error:(e,i,a)=>console.error(`[${e}] ${i}`,a||""),trace:(e,i,a)=>console.debug(`[${e}] ${i} completed in ${Date.now()-a}ms`)},j=e=>({debug:(i,a)=>u.debug(e,i,a),info:(i,a)=>u.info(e,i,a),warn:(i,a)=>u.warn(e,i,a),error:(i,a)=>u.error(e,i,a),trace:(i,a)=>u.trace(e,i,a)}),B=["Afghanistan","Albania","Algeria","Andorra","Angola","Antigua and Barbuda","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Côte d'Ivoire","Cabo Verde","Cambodia","Cameroon","Canada","Central African Republic","Chad","Chile","China","Colombia","Comoros","Congo","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Eswatini","Ethiopia","Fiji","Finland","France","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea","Guinea-Bissau","Guyana","Haiti","Holy See","Honduras","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","North Korea","North Macedonia","Norway","Oman","Pakistan","Palau","Palestine","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russia","Rwanda","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Sweden","Switzerland","Syria","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"],_=({onSelect:e,placeholder:i="Select an organizer"})=>{const[a,m]=o.useState(""),[x,b]=o.useState(!1),[p,S]=o.useState([]),[w,f]=o.useState(!1),[h,y]=o.useState(null);o.useEffect(()=>{if(!a.trim()){S([]);return}const s=setTimeout(async()=>{f(!0);try{const{data:t,error:d}=await l.from("organisers").select("id, organisation_name").ilike("organisation_name",`%${a}%`).order("organisation_name").limit(5);if(d)throw d;S(t||[])}catch(t){console.error("Error fetching organizers:",t),y("Failed to load organizers")}finally{f(!1)}},300);return()=>clearTimeout(s)},[a]);const C=async()=>{var r;try{const{data:{user:s}}=await l.auth.getUser();if(!s)throw new Error("Please sign in to add a new organizer");const{data:t,error:d}=await l.from("organisers").insert({organisation_name:a.trim(),full_name:((r=s.user_metadata)==null?void 0:r.full_name)||"",brand:"",user_id:s.id}).select().single();if(d)throw d;e(t),m(t.organisation_name),b(!1)}catch(s){console.error("Error adding new organizer:",s),y(s.message)}};return n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",value:a,onChange:r=>{m(r.target.value),b(!0)},placeholder:i,className:"w-full p-2 bg-zinc-700 text-white rounded border border-gray-600"}),x&&a.trim()&&n.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-zinc-800 rounded-md border border-gray-700 shadow-lg",children:[w&&n.jsx("div",{className:"p-2 text-gray-300 text-center",children:"Loading..."}),h&&n.jsx("div",{className:"p-2 text-red-400",children:h}),!w&&!h&&p.length>0&&n.jsxs("div",{children:[p.map(r=>n.jsx("div",{className:"p-2 hover:bg-zinc-700 cursor-pointer text-white",onClick:()=>{e(r),m(r.organisation_name),b(!1)},children:n.jsx("div",{children:r.organisation_name})},r.id)),n.jsx("div",{className:"border-t border-gray-700 mt-2"})]}),n.jsxs("div",{className:"p-2 hover:bg-zinc-700 cursor-pointer text-white flex justify-between items-center",onClick:C,children:[n.jsxs("span",{children:['+ Add "',a.trim(),'" as new organizer']}),n.jsx("span",{className:"text-gray-400",children:"→"})]})]})]})};export{_ as O,B as a,j as c,E as l,l as s};
