import{r as x,d as Dt,C as rt,j as e,c as _e,s as we,e as Lt,g as Rt,u as zt,f as Pt,h as At,i as Mt,k as Wt,p as Ye,P as Bt,M as Ze}from"./main-CyxRsl2n.js";import{O as bt}from"./OrganizerSelect-CUkPV8eR.js";import{R as Ft}from"./ResultForm-Bq_5-dFp.js";const Xe=_e("CitySelect"),ke=({value:L,onSelect:E,placeholder:z="Select or enter city",initialLabel:I="",className:v="",required:S=!1,disabled:C=!1})=>{const[k,M]=x.useState(I),[_,A]=x.useState(!1),[F,X]=x.useState(!1),[q,ne]=x.useState(null),{cities:B,searchCities:T,findOrCreateCity:H}=Dt(),K=x.useRef(null),G=x.useRef(null);x.useEffect(()=>{if(!k.trim())return;const P=setTimeout(async()=>{try{X(!0),ne(null),await T(k.trim())}catch(re){Xe.error("Search error:",re),ne("Failed to search cities")}finally{X(!1)}},300);return()=>clearTimeout(P)},[k,T]),x.useEffect(()=>{const P=re=>{K.current&&!K.current.contains(re.target)&&A(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]);const je=P=>{const re=P.target.value;M(re),A(!0),ne(null)},Ee=()=>{A(!0),k.trim()&&T(k.trim())},ze=P=>{const re=rt.formatCityName(P);M(re),A(!1),E(P),Xe.info("City selected",{cityId:P.id,cityName:re})},Z=async()=>{if(k.trim())try{X(!0),ne(null);const P=await H(k.trim()),re=rt.formatCityName(P);M(re),A(!1),E(P),Xe.info("New city created and selected",{cityId:P.id,cityName:re})}catch(P){Xe.error("Error creating new city:",P),ne("Failed to create city. Please try again.")}finally{X(!1)}},ce=P=>{P.key==="Escape"?A(!1):P.key==="Enter"&&!B.length&&k.trim()&&(P.preventDefault(),Z())};return x.useEffect(()=>{L&&typeof L=="object"?M(rt.formatCityName(L)):L&&typeof L=="string"&&M(L)},[L]),e.jsxs("div",{className:`relative ${v}`,ref:K,children:[e.jsx("input",{ref:G,type:"text",value:k,onChange:je,onFocus:Ee,onKeyDown:ce,placeholder:z,required:S,disabled:C,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"}),_&&(k.trim()||F||q)&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-md border border-gray-300 shadow-lg max-h-60 overflow-y-auto",children:[F&&e.jsxs("div",{className:"p-3 text-gray-500 text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2",children:"Searching cities..."})]}),q&&e.jsx("div",{className:"p-3 text-red-500 text-center text-sm",children:q}),!F&&!q&&B.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 px-3 py-2 border-b border-gray-200",children:"Select a city:"}),B.map(P=>e.jsxs("div",{onClick:()=>ze(P),className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[P.city,P.state&&e.jsxs("span",{className:"text-gray-600",children:[", ",P.state]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:P.country})]},P.id))]}),!F&&!q&&k.trim()&&e.jsxs("div",{children:[B.length>0&&e.jsx("div",{className:"border-t border-gray-200 mt-1"}),e.jsxs("div",{onClick:Z,className:"p-3 hover:bg-blue-50 cursor-pointer text-blue-600 flex justify-between items-center transition-colors",children:[e.jsxs("span",{children:['+ Add "',k.trim(),'" as new city']}),e.jsx("span",{className:"text-gray-400",children:"→"})]})]}),!F&&!q&&!k.trim()&&B.length===0&&e.jsx("div",{className:"p-3 text-gray-500 text-center text-sm",children:"Start typing to search cities"})]})]})},It=_e("SupabaseAdapter");It.info("Supabase adapter configured - using real Supabase client");const it=_e("BarSelect"),vt=({value:L="",onSelect:E,placeholder:z="Select or enter a bar",className:I="w-full px-3 py-2 border border-gray-300 rounded-md"})=>{const[v,S]=x.useState(L),[C,k]=x.useState(!1),[M,_]=x.useState([]),[A,F]=x.useState(!1),[X,q]=x.useState(null);x.useEffect(()=>{S(L)},[L]),x.useEffect(()=>{if(!v.trim()){_([]);return}const K=setTimeout(async()=>{F(!0);try{const{data:G,error:je}=await we.from("venues").select("id, name, city, country").ilike("name",`%${v}%`).is("is_archived",!1).order("name").limit(8);if(je)throw je;_(G||[])}catch(G){it.error("Failed to load venues:",G),q("Failed to load venues")}finally{F(!1)}},300);return()=>clearTimeout(K)},[v]);const ne=H=>{S(H.name),k(!1),E(H)},B=async()=>{if(v.trim())try{F(!0),q(null);const{data:{user:H}}=await we.auth.getUser();if(!H)throw new Error("Please sign in to add a new venue");const{data:K,error:G}=await we.from("venues").insert({name:v.trim(),created_by:H.id}).select().single();if(G)throw G;it.info("Created new venue:",{id:K.id,name:K.name}),S(K.name),k(!1),E(K)}catch(H){it.error("Error adding new venue:",H),q(H.message)}finally{F(!1)}},T=H=>{const K=H.target.value;S(K),k(!0)};return e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:v,onChange:T,onFocus:()=>k(!0),onBlur:()=>setTimeout(()=>k(!1),200),placeholder:z,className:I}),C&&(v.trim()||A||X)&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-md border border-gray-300 shadow-lg max-h-60 overflow-y-auto",children:[A&&e.jsx("div",{className:"p-2 text-gray-500 text-center",children:"Loading..."}),X&&e.jsx("div",{className:"p-2 text-red-500",children:X}),!A&&!X&&M.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 px-3 py-2 border-b border-gray-200",children:"Select a venue:"}),M.map(H=>e.jsxs("div",{className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors",onClick:()=>ne(H),children:[e.jsx("div",{className:"font-medium text-gray-900",children:H.name}),H.city&&H.country&&e.jsxs("div",{className:"text-sm text-gray-500",children:[H.city,", ",H.country]})]},H.id))]}),v.trim()&&e.jsxs("div",{children:[M.length>0&&e.jsx("div",{className:"border-t border-gray-200 mt-1"}),e.jsxs("div",{className:"p-3 hover:bg-blue-50 cursor-pointer text-blue-600 flex justify-between items-center transition-colors",onClick:B,children:[e.jsxs("span",{children:['+ Add "',v.trim(),'" as new venue']}),e.jsx("span",{className:"text-gray-400",children:"→"})]})]}),!A&&!X&&v.trim()&&M.length===0&&e.jsx("div",{className:"p-2 text-gray-500 text-center text-sm",children:"No matching venues found"})]})]})};var st={exports:{}};(function(L,E){(function(z,I){typeof E.nodeName!="string"?L.exports=I():z.Croppie=I()})(typeof self<"u"?self:Lt,function(){if(typeof Promise!="function"){/*! promise-polyfill 3.1.0 */(function(t){function i(d,h){return function(){d.apply(h,arguments)}}function r(d){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof d!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],w(d,i(l,this),i(o,this))}function a(d){var h=this;return this._state===null?void this._deferreds.push(d):void j(function(){var m=h._state?d.onFulfilled:d.onRejected;if(m===null)return void(h._state?d.resolve:d.reject)(h._value);var g;try{g=m(h._value)}catch(N){return void d.reject(N)}d.resolve(g)})}function l(d){try{if(d===this)throw new TypeError("A promise cannot be resolved with itself.");if(d&&(typeof d=="object"||typeof d=="function")){var h=d.then;if(typeof h=="function")return void w(i(h,d),i(l,this),i(o,this))}this._state=!0,this._value=d,u.call(this)}catch(m){o.call(this,m)}}function o(d){this._state=!1,this._value=d,u.call(this)}function u(){for(var d=0,h=this._deferreds.length;h>d;d++)a.call(this,this._deferreds[d]);this._deferreds=null}function f(d,h,m,g){this.onFulfilled=typeof d=="function"?d:null,this.onRejected=typeof h=="function"?h:null,this.resolve=m,this.reject=g}function w(d,h,m){var g=!1;try{d(function(N){g||(g=!0,h(N))},function(N){g||(g=!0,m(N))})}catch(N){if(g)return;g=!0,m(N)}}var b=setTimeout,j=typeof setImmediate=="function"&&setImmediate||function(d){b(d,1)},D=Array.isArray||function(d){return Object.prototype.toString.call(d)==="[object Array]"};r.prototype.catch=function(d){return this.then(null,d)},r.prototype.then=function(d,h){var m=this;return new r(function(g,N){a.call(m,new f(d,h,g,N))})},r.all=function(){var d=Array.prototype.slice.call(arguments.length===1&&D(arguments[0])?arguments[0]:arguments);return new r(function(h,m){function g($,U){try{if(U&&(typeof U=="object"||typeof U=="function")){var J=U.then;if(typeof J=="function")return void J.call(U,function(V){g($,V)},m)}d[$]=U,--N===0&&h(d)}catch(V){m(V)}}if(d.length===0)return h([]);for(var N=d.length,O=0;O<d.length;O++)g(O,d[O])})},r.resolve=function(d){return d&&typeof d=="object"&&d.constructor===r?d:new r(function(h){h(d)})},r.reject=function(d){return new r(function(h,m){m(d)})},r.race=function(d){return new r(function(h,m){for(var g=0,N=d.length;N>g;g++)d[g].then(h,m)})},r._setImmediateFn=function(d){j=d},L.exports?L.exports=r:t.Promise||(t.Promise=r)})(this)}typeof window<"u"&&typeof window.CustomEvent!="function"&&function(){function t(i,r){r=r||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(i,r.bubbles,r.cancelable,r.detail),a}t.prototype=window.Event.prototype,window.CustomEvent=t}(),typeof HTMLCanvasElement<"u"&&!HTMLCanvasElement.prototype.toBlob&&Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,i,r){for(var a=atob(this.toDataURL(i,r).split(",")[1]),l=a.length,o=new Uint8Array(l),u=0;u<l;u++)o[u]=a.charCodeAt(u);t(new Blob([o],{type:i||"image/png"}))}});var z=["Webkit","Moz","ms"],I=typeof document<"u"?document.createElement("div").style:{},v=[1,8,3,6],S=[2,7,4,5],C,k,M;function _(t){if(t in I)return t;for(var i=t[0].toUpperCase()+t.slice(1),r=z.length;r--;)if(t=z[r]+i,t in I)return t}k=_("transform"),C=_("transformOrigin"),M=_("userSelect");function A(t,i){var r=v.indexOf(t)>-1?v:S,a=r.indexOf(t),l=i/90%r.length;return r[(r.length+a+l%r.length)%r.length]}function F(t,i){t=t||{};for(var r in i)i[r]&&i[r].constructor&&i[r].constructor===Object?(t[r]=t[r]||{},F(t[r],i[r])):t[r]=i[r];return t}function X(t){return F({},t)}function q(t,i,r){var a;return function(){var l=this,o=arguments,u=function(){a=null,t.apply(l,o)};clearTimeout(a),a=setTimeout(u,i)}}function ne(t){if("createEvent"in document){var i=document.createEvent("HTMLEvents");i.initEvent("change",!1,!0),t.dispatchEvent(i)}else t.fireEvent("onchange")}function B(t,i,r){if(typeof i=="string"){var a=i;i={},i[a]=r}for(var l in i)t.style[l]=i[l]}function T(t,i){t.classList?t.classList.add(i):t.className+=" "+i}function H(t,i){t.classList?t.classList.remove(i):t.className=t.className.replace(i,"")}function K(t,i){for(var r in i)t.setAttribute(r,i[r])}function G(t){return parseInt(t,10)}function je(t,i){if(!t)throw"Source image missing";var r=new Image;return r.style.opacity="0",new Promise(function(a,l){function o(){r.style.opacity="1",setTimeout(function(){a(r)},1)}r.removeAttribute("crossOrigin"),t.match(/^https?:\/\/|^\/\//)&&r.setAttribute("crossOrigin","anonymous"),r.onload=function(){i?EXIF.getData(r,function(){o()}):o()},r.onerror=function(u){r.style.opacity=1,setTimeout(function(){l(u)},1)},r.src=t})}function Ee(t,i){var r=t.naturalWidth,a=t.naturalHeight,l=i||P(t);if(l&&l>=5){var o=r;r=a,a=o}return{width:r,height:a}}var ze={translate3d:{suffix:", 0px"},translate:{suffix:""}},Z=function(t,i,r){this.x=parseFloat(t),this.y=parseFloat(i),this.scale=parseFloat(r)};Z.parse=function(t){return t.style?Z.parse(t.style[k]):t.indexOf("matrix")>-1||t.indexOf("none")>-1?Z.fromMatrix(t):Z.fromString(t)},Z.fromMatrix=function(t){var i=t.substring(7).split(",");return(!i.length||t==="none")&&(i=[1,0,0,1,0,0]),new Z(G(i[4]),G(i[5]),parseFloat(i[0]))},Z.fromString=function(t){var i=t.split(") "),r=i[0].substring(ae.globals.translate.length+1).split(","),a=i.length>1?i[1].substring(6):1,l=r.length>1?r[0]:0,o=r.length>1?r[1]:0;return new Z(l,o,a)},Z.prototype.toString=function(){var t=ze[ae.globals.translate].suffix||"";return ae.globals.translate+"("+this.x+"px, "+this.y+"px"+t+") scale("+this.scale+")"};var ce=function(t){if(!t||!t.style[C]){this.x=0,this.y=0;return}var i=t.style[C].split(" ");this.x=parseFloat(i[0]),this.y=parseFloat(i[1])};ce.prototype.toString=function(){return this.x+"px "+this.y+"px"};function P(t){return t.exifdata&&t.exifdata.Orientation?G(t.exifdata.Orientation):1}function re(t,i,r){var a=i.width,l=i.height,o=t.getContext("2d");switch(t.width=i.width,t.height=i.height,o.save(),r){case 2:o.translate(a,0),o.scale(-1,1);break;case 3:o.translate(a,l),o.rotate(180*Math.PI/180);break;case 4:o.translate(0,l),o.scale(1,-1);break;case 5:t.width=l,t.height=a,o.rotate(90*Math.PI/180),o.scale(1,-1);break;case 6:t.width=l,t.height=a,o.rotate(90*Math.PI/180),o.translate(0,-l);break;case 7:t.width=l,t.height=a,o.rotate(-90*Math.PI/180),o.translate(-a,l),o.scale(1,-1);break;case 8:t.width=l,t.height=a,o.translate(0,a),o.rotate(-90*Math.PI/180);break}o.drawImage(i,0,0,a,l),o.restore()}function qe(){var t=this,i="croppie-container",r=t.options.viewport.type?"cr-vp-"+t.options.viewport.type:null,a,l,o,u,f,w;t.options.useCanvas=t.options.enableOrientation||Pe.call(t),t.data={},t.elements={},a=t.elements.boundary=document.createElement("div"),o=t.elements.viewport=document.createElement("div"),l=t.elements.img=document.createElement("img"),u=t.elements.overlay=document.createElement("div"),t.options.useCanvas?(t.elements.canvas=document.createElement("canvas"),t.elements.preview=t.elements.canvas):t.elements.preview=l,T(a,"cr-boundary"),a.setAttribute("aria-dropeffect","none"),f=t.options.boundary.width,w=t.options.boundary.height,B(a,{width:f+(isNaN(f)?"":"px"),height:w+(isNaN(w)?"":"px")}),T(o,"cr-viewport"),r&&T(o,r),B(o,{width:t.options.viewport.width+"px",height:t.options.viewport.height+"px"}),o.setAttribute("tabindex",0),T(t.elements.preview,"cr-image"),K(t.elements.preview,{alt:"preview","aria-grabbed":"false"}),T(u,"cr-overlay"),t.element.appendChild(a),a.appendChild(t.elements.preview),a.appendChild(o),a.appendChild(u),T(t.element,i),t.options.customClass&&T(t.element,t.options.customClass),le.call(this),t.options.enableZoom&&Ge.call(t),t.options.enableResize&&Ve.call(t)}function Pe(){return this.options.enableExif&&window.EXIF}function Ve(){var t=this,i=document.createElement("div"),r=!1,a,l,o,u=50,f,w,b,j;T(i,"cr-resizer"),B(i,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(b=document.createElement("div"),T(b,"cr-resizer-vertical"),i.appendChild(b)),this.options.resizeControls.width&&(j=document.createElement("div"),T(j,"cr-resizer-horisontal"),i.appendChild(j));function D(m){if(!(m.button!==void 0&&m.button!==0)&&(m.preventDefault(),!r)){var g=t.elements.overlay.getBoundingClientRect();if(r=!0,l=m.pageX,o=m.pageY,a=m.currentTarget.className.indexOf("vertical")!==-1?"v":"h",f=g.width,w=g.height,m.touches){var N=m.touches[0];l=N.pageX,o=N.pageY}window.addEventListener("mousemove",d),window.addEventListener("touchmove",d),window.addEventListener("mouseup",h),window.addEventListener("touchend",h),document.body.style[M]="none"}}function d(m){var g=m.pageX,N=m.pageY;if(m.preventDefault(),m.touches){var O=m.touches[0];g=O.pageX,N=O.pageY}var $=g-l,U=N-o,J=t.options.viewport.height+U,V=t.options.viewport.width+$;a==="v"&&J>=u&&J<=w?(B(i,{height:J+"px"}),t.options.boundary.height+=U,B(t.elements.boundary,{height:t.options.boundary.height+"px"}),t.options.viewport.height+=U,B(t.elements.viewport,{height:t.options.viewport.height+"px"})):a==="h"&&V>=u&&V<=f&&(B(i,{width:V+"px"}),t.options.boundary.width+=$,B(t.elements.boundary,{width:t.options.boundary.width+"px"}),t.options.viewport.width+=$,B(t.elements.viewport,{width:t.options.viewport.width+"px"})),Ne.call(t),se.call(t),be.call(t),de.call(t),o=N,l=g}function h(){r=!1,window.removeEventListener("mousemove",d),window.removeEventListener("touchmove",d),window.removeEventListener("mouseup",h),window.removeEventListener("touchend",h),document.body.style[M]=""}b&&(b.addEventListener("mousedown",D),b.addEventListener("touchstart",D)),j&&(j.addEventListener("mousedown",D),j.addEventListener("touchstart",D)),this.elements.boundary.appendChild(i)}function pe(t){if(this.options.enableZoom){var i=this.elements.zoomer,r=p(t,4);i.value=Math.max(parseFloat(i.min),Math.min(parseFloat(i.max),r)).toString()}}function Ge(){var t=this,i=t.elements.zoomerWrap=document.createElement("div"),r=t.elements.zoomer=document.createElement("input");T(i,"cr-slider-wrap"),T(r,"cr-slider"),r.type="range",r.step="0.0001",r.value="1",r.style.display=t.options.showZoomer?"":"none",r.setAttribute("aria-label","zoom"),t.element.appendChild(i),i.appendChild(r),t._currentZoom=1;function a(){at.call(t,{value:parseFloat(r.value),origin:new ce(t.elements.preview),viewportRect:t.elements.viewport.getBoundingClientRect(),transform:Z.parse(t.elements.preview)})}function l(o){var u,f;if(t.options.mouseWheelZoom==="ctrl"&&o.ctrlKey!==!0)return 0;o.wheelDelta?u=o.wheelDelta/1200:o.deltaY?u=o.deltaY/1060:o.detail?u=o.detail/-60:u=0,f=t._currentZoom+u*t._currentZoom,o.preventDefault(),pe.call(t,f),a.call(t)}t.elements.zoomer.addEventListener("input",a),t.elements.zoomer.addEventListener("change",a),t.options.mouseWheelZoom&&(t.elements.boundary.addEventListener("mousewheel",l),t.elements.boundary.addEventListener("DOMMouseScroll",l))}function at(t){var i=this,r=t?t.transform:Z.parse(i.elements.preview),a=t?t.viewportRect:i.elements.viewport.getBoundingClientRect(),l=t?t.origin:new ce(i.elements.preview);function o(){var b={};b[k]=r.toString(),b[C]=l.toString(),B(i.elements.preview,b)}if(i._currentZoom=t?t.value:i._currentZoom,r.scale=i._currentZoom,i.elements.zoomer.setAttribute("aria-valuenow",i._currentZoom),o(),i.options.enforceBoundary){var u=Ke.call(i,a),f=u.translate,w=u.origin;r.x>=f.maxX&&(l.x=w.minX,r.x=f.maxX),r.x<=f.minX&&(l.x=w.maxX,r.x=f.minX),r.y>=f.maxY&&(l.y=w.minY,r.y=f.maxY),r.y<=f.minY&&(l.y=w.maxY,r.y=f.minY)}o(),Qe.call(i),de.call(i)}function Ke(t){var i=this,r=i._currentZoom,a=t.width,l=t.height,o=i.elements.boundary.clientWidth/2,u=i.elements.boundary.clientHeight/2,f=i.elements.preview.getBoundingClientRect(),w=f.width,b=f.height,j=a/2,D=l/2,d=(j/r-o)*-1,h=d-(w*(1/r)-a*(1/r)),m=(D/r-u)*-1,g=m-(b*(1/r)-l*(1/r)),N=1/r*j,O=w*(1/r)-N,$=1/r*D,U=b*(1/r)-$;return{translate:{maxX:d,minX:h,maxY:m,minY:g},origin:{maxX:O,minX:N,maxY:U,minY:$}}}function be(t){var i=this,r=i._currentZoom,a=i.elements.preview.getBoundingClientRect(),l=i.elements.viewport.getBoundingClientRect(),o=Z.parse(i.elements.preview.style[k]),u=new ce(i.elements.preview),f=l.top-a.top+l.height/2,w=l.left-a.left+l.width/2,b={},j={};if(t){var D=u.x,d=u.y,h=o.x,m=o.y;b.y=D,b.x=d,o.y=h,o.x=m}else b.y=f/r,b.x=w/r,j.y=(b.y-u.y)*(1-r),j.x=(b.x-u.x)*(1-r),o.x-=j.x,o.y-=j.y;var g={};g[C]=b.x+"px "+b.y+"px",g[k]=o.toString(),B(i.elements.preview,g)}function le(){var t=this,i=!1,r,a,l,o,u;function f(m,g){var N=t.elements.preview.getBoundingClientRect(),O=u.y+g,$=u.x+m;t.options.enforceBoundary?(o.top>N.top+g&&o.bottom<N.bottom+g&&(u.y=O),o.left>N.left+m&&o.right<N.right+m&&(u.x=$)):(u.y=O,u.x=$)}function w(m){t.elements.preview.setAttribute("aria-grabbed",m),t.elements.boundary.setAttribute("aria-dropeffect",m?"move":"none")}function b(m){var g=37,N=38,O=39,$=40;if(m.shiftKey&&(m.keyCode===N||m.keyCode===$)){var U;m.keyCode===N?U=parseFloat(t.elements.zoomer.value)+parseFloat(t.elements.zoomer.step):U=parseFloat(t.elements.zoomer.value)-parseFloat(t.elements.zoomer.step),t.setZoom(U)}else if(t.options.enableKeyMovement&&m.keyCode>=37&&m.keyCode<=40){m.preventDefault();var J=V(m.keyCode);u=Z.parse(t.elements.preview),document.body.style[M]="none",o=t.elements.viewport.getBoundingClientRect(),j(J)}function V(ge){switch(ge){case g:return[1,0];case N:return[0,1];case O:return[-1,0];case $:return[0,-1]}}}function j(m){var g=m[0],N=m[1],O={};f(g,N),O[k]=u.toString(),B(t.elements.preview,O),Ne.call(t),document.body.style[M]="",be.call(t),de.call(t),l=0}function D(m){if(!(m.button!==void 0&&m.button!==0)&&(m.preventDefault(),!i)){if(i=!0,r=m.pageX,a=m.pageY,m.touches){var g=m.touches[0];r=g.pageX,a=g.pageY}w(i),u=Z.parse(t.elements.preview),window.addEventListener("mousemove",d),window.addEventListener("touchmove",d),window.addEventListener("mouseup",h),window.addEventListener("touchend",h),document.body.style[M]="none",o=t.elements.viewport.getBoundingClientRect()}}function d(m){m.preventDefault();var g=m.pageX,N=m.pageY;if(m.touches){var O=m.touches[0];g=O.pageX,N=O.pageY}var $=g-r,U=N-a,J={};if(m.type==="touchmove"&&m.touches.length>1){var V=m.touches[0],ge=m.touches[1],ie=Math.sqrt((V.pageX-ge.pageX)*(V.pageX-ge.pageX)+(V.pageY-ge.pageY)*(V.pageY-ge.pageY));l||(l=ie/t._currentZoom);var tt=ie/l;pe.call(t,tt),ne(t.elements.zoomer);return}f($,U),J[k]=u.toString(),B(t.elements.preview,J),Ne.call(t),a=N,r=g}function h(){i=!1,w(i),window.removeEventListener("mousemove",d),window.removeEventListener("touchmove",d),window.removeEventListener("mouseup",h),window.removeEventListener("touchend",h),document.body.style[M]="",be.call(t),de.call(t),l=0}t.elements.overlay.addEventListener("mousedown",D),t.elements.viewport.addEventListener("keydown",b),t.elements.overlay.addEventListener("touchstart",D)}function Ne(){if(this.elements){var t=this,i=t.elements.boundary.getBoundingClientRect(),r=t.elements.preview.getBoundingClientRect();B(t.elements.overlay,{width:r.width+"px",height:r.height+"px",top:r.top-i.top+"px",left:r.left-i.left+"px"})}}var Qe=q(Ne,500);function de(){var t=this,i=t.get();if(ve.call(t))if(t.options.update.call(t,i),t.$&&typeof Prototype>"u")t.$(t.element).trigger("update.croppie",i);else{var r;window.CustomEvent?r=new CustomEvent("update",{detail:i}):(r=document.createEvent("CustomEvent"),r.initCustomEvent("update",!0,!0,i)),t.element.dispatchEvent(r)}}function ve(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function fe(){var t=this,i=1,r={},a=t.elements.preview,l,o=new Z(0,0,i),u=new ce,f=ve.call(t);!f||t.data.bound||(t.data.bound=!0,r[k]=o.toString(),r[C]=u.toString(),r.opacity=1,B(a,r),l=t.elements.preview.getBoundingClientRect(),t._originalImageWidth=l.width,t._originalImageHeight=l.height,t.data.orientation=Pe.call(t)?P(t.elements.img):t.data.orientation,t.options.enableZoom?se.call(t,!0):t._currentZoom=i,o.scale=t._currentZoom,r[k]=o.toString(),B(a,r),t.data.points.length?me.call(t,t.data.points):ue.call(t),be.call(t),Ne.call(t))}function se(t){var i=this,r=Math.max(i.options.minZoom,0)||0,a=i.options.maxZoom||1.5,l,o,u=i.elements.zoomer,f=parseFloat(u.value),w=i.elements.boundary.getBoundingClientRect(),b=Ee(i.elements.img,i.data.orientation),j=i.elements.viewport.getBoundingClientRect(),D,d;i.options.enforceBoundary&&(D=j.width/b.width,d=j.height/b.height,r=Math.max(D,d)),r>=a&&(a=r+1),u.min=p(r,4),u.max=p(a,4),!t&&(f<u.min||f>u.max)?pe.call(i,f<u.min?u.min:u.max):t&&(o=Math.max(w.width/b.width,w.height/b.height),l=i.data.boundZoom!==null?i.data.boundZoom:o,pe.call(i,l)),ne(u)}function me(t){if(t.length!==4)throw"Croppie - Invalid number of points supplied: "+t;var i=this,r=t[2]-t[0],a=i.elements.viewport.getBoundingClientRect(),l=i.elements.boundary.getBoundingClientRect(),o={left:a.left-l.left,top:a.top-l.top},u=a.width/r,f=t[1],w=t[0],b=-1*t[1]+o.top,j=-1*t[0]+o.left,D={};D[C]=w+"px "+f+"px",D[k]=new Z(j,b,u).toString(),B(i.elements.preview,D),pe.call(i,u),i._currentZoom=u}function ue(){var t=this,i=t.elements.preview.getBoundingClientRect(),r=t.elements.viewport.getBoundingClientRect(),a=t.elements.boundary.getBoundingClientRect(),l=r.left-a.left,o=r.top-a.top,u=l-(i.width-r.width)/2,f=o-(i.height-r.height)/2,w=new Z(u,f,t._currentZoom);B(t.elements.preview,k,w.toString())}function Ce(t){var i=this,r=i.elements.canvas,a=i.elements.img,l=r.getContext("2d");l.clearRect(0,0,r.width,r.height),r.width=a.width,r.height=a.height;var o=i.options.enableOrientation&&t||P(a);re(r,a,o)}function he(t){var i=this,r=t.points,a=G(r[0]),l=G(r[1]),o=G(r[2]),u=G(r[3]),f=o-a,w=u-l,b=t.circle,j=document.createElement("canvas"),D=j.getContext("2d"),d=t.outputWidth||f,h=t.outputHeight||w;j.width=d,j.height=h,t.backgroundColor&&(D.fillStyle=t.backgroundColor,D.fillRect(0,0,d,h));var m=a,g=l,N=f,O=w,$=0,U=0,J=d,V=h;return a<0&&(m=0,$=Math.abs(a)/f*d),N+m>i._originalImageWidth&&(N=i._originalImageWidth-m,J=N/f*d),l<0&&(g=0,U=Math.abs(l)/w*h),O+g>i._originalImageHeight&&(O=i._originalImageHeight-g,V=O/w*h),D.drawImage(this.elements.preview,m,g,N,O,$,U,J,V),b&&(D.fillStyle="#fff",D.globalCompositeOperation="destination-in",D.beginPath(),D.arc(j.width/2,j.height/2,j.width/2,0,Math.PI*2,!0),D.closePath(),D.fill()),j}function Ae(t){var i=t.points,r=document.createElement("div"),a=document.createElement("img"),l=i[2]-i[0],o=i[3]-i[1];return T(r,"croppie-result"),r.appendChild(a),B(a,{left:-1*i[0]+"px",top:-1*i[1]+"px"}),a.src=t.url,B(r,{width:l+"px",height:o+"px"}),r}function ot(t){return he.call(this,t).toDataURL(t.format,t.quality)}function Me(t){var i=this;return new Promise(function(r){he.call(i,t).toBlob(function(a){r(a)},t.format,t.quality)})}function He(t){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(i){t.classList.add(i)}),this.elements.img.parentNode.replaceChild(t,this.elements.img),this.elements.preview=t),this.elements.img=t}function Se(t,i){var r=this,a,l=[],o=null,u=Pe.call(r);if(typeof t=="string")a=t,t={};else if(Array.isArray(t))l=t.slice();else{if(typeof t>"u"&&r.data.url)return fe.call(r),de.call(r),null;a=t.url,l=t.points||[],o=typeof t.zoom>"u"?null:t.zoom}return r.data.bound=!1,r.data.url=a||r.data.url,r.data.boundZoom=o,je(a,u).then(function(f){if(He.call(r,f),l.length)r.options.relative&&(l=[l[0]*f.naturalWidth/100,l[1]*f.naturalHeight/100,l[2]*f.naturalWidth/100,l[3]*f.naturalHeight/100]);else{var w=Ee(f),b=r.elements.viewport.getBoundingClientRect(),j=b.width/b.height,D=w.width/w.height,d,h;D>j?(h=w.height,d=h*j):(d=w.width,h=w.height/j);var m=(w.width-d)/2,g=(w.height-h)/2,N=m+d,O=g+h;r.data.points=[m,g,N,O]}r.data.orientation=t.orientation||1,r.data.points=l.map(function($){return parseFloat($)}),r.options.useCanvas&&Ce.call(r,r.data.orientation),fe.call(r),de.call(r),i&&i()})}function p(t,i){return parseFloat(t).toFixed(i||0)}function W(){var t=this,i=t.elements.preview.getBoundingClientRect(),r=t.elements.viewport.getBoundingClientRect(),a=r.left-i.left,l=r.top-i.top,o=(r.width-t.elements.viewport.offsetWidth)/2,u=(r.height-t.elements.viewport.offsetHeight)/2,f=a+t.elements.viewport.offsetWidth+o,w=l+t.elements.viewport.offsetHeight+u,b=t._currentZoom;(b===1/0||isNaN(b))&&(b=1);var j=t.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return a=Math.max(j,a/b),l=Math.max(j,l/b),f=Math.max(j,f/b),w=Math.max(j,w/b),{points:[p(a),p(l),p(f),p(w)],zoom:b,orientation:t.data.orientation}}var y={type:"canvas",format:"png",quality:1},Q=["jpeg","webp","png"];function Je(t){var i=this,r=W.call(i),a=F(X(y),X(t)),l=typeof t=="string"?t:a.type||"base64",o=a.size||"viewport",u=a.format,f=a.quality,w=a.backgroundColor,b=typeof a.circle=="boolean"?a.circle:i.options.viewport.type==="circle",j=i.elements.viewport.getBoundingClientRect(),D=j.width/j.height,d;return o==="viewport"?(r.outputWidth=j.width,r.outputHeight=j.height):typeof o=="object"&&(o.width&&o.height?(r.outputWidth=o.width,r.outputHeight=o.height):o.width?(r.outputWidth=o.width,r.outputHeight=o.width/D):o.height&&(r.outputWidth=o.height*D,r.outputHeight=o.height)),Q.indexOf(u)>-1&&(r.format="image/"+u,r.quality=f),r.circle=b,r.url=i.data.url,r.backgroundColor=w,d=new Promise(function(h){switch(l.toLowerCase()){case"rawcanvas":h(he.call(i,r));break;case"canvas":case"base64":h(ot.call(i,r));break;case"blob":Me.call(i,r).then(h);break;default:h(Ae.call(i,r));break}}),d}function Te(){fe.call(this)}function et(t){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var i=this,r=i.elements.canvas;if(i.data.orientation=A(i.data.orientation,t),re(r,i.elements.img,i.data.orientation),be.call(i,!0),se.call(i),Math.abs(t)/90%2===1){var a=i._originalImageHeight,l=i._originalImageWidth;i._originalImageWidth=a,i._originalImageHeight=l}}function De(){var t=this;t.element.removeChild(t.elements.boundary),H(t.element,"croppie-container"),t.options.enableZoom&&t.element.removeChild(t.elements.zoomerWrap),delete t.elements}if(typeof window<"u"&&window.jQuery){var xe=window.jQuery;xe.fn.croppie=function(t){var i=typeof t;if(i==="string"){var r=Array.prototype.slice.call(arguments,1),a=xe(this).data("croppie");return t==="get"?a.get():t==="result"?a.result.apply(a,r):t==="bind"?a.bind.apply(a,r):this.each(function(){var l=xe(this).data("croppie");if(l){var o=l[t];if(xe.isFunction(o))o.apply(l,r),t==="destroy"&&xe(this).removeData("croppie");else throw"Croppie "+t+" method not found"}})}else return this.each(function(){var l=new ae(this,t);l.$=xe,xe(this).data("croppie",l)})}}function ae(t,i){if(t.className.indexOf("croppie-container")>-1)throw new Error("Croppie: Can't initialize croppie more than once");if(this.element=t,this.options=F(X(ae.defaults),i),this.element.tagName.toLowerCase()==="img"){var r=this.element;T(r,"cr-original-image"),K(r,{"aria-hidden":"true",alt:""});var a=document.createElement("div");this.element.parentNode.appendChild(a),a.appendChild(r),this.element=a,this.options.url=this.options.url||r.src}if(qe.call(this),this.options.url){var l={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,Se.call(this,l)}}return ae.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}},ae.globals={translate:"translate3d"},F(ae.prototype,{bind:function(t,i){return Se.call(this,t,i)},get:function(){var t=W.call(this),i=t.points;return this.options.relative&&(i[0]/=this.elements.img.naturalWidth/100,i[1]/=this.elements.img.naturalHeight/100,i[2]/=this.elements.img.naturalWidth/100,i[3]/=this.elements.img.naturalHeight/100),t},result:function(t){return Je.call(this,t)},refresh:function(){return Te.call(this)},setZoom:function(t){pe.call(this,t),ne(this.elements.zoomer)},rotate:function(t){et.call(this,t)},destroy:function(){return De.call(this)}}),ae})})(st,st.exports);var Ot=st.exports;const Ht=Rt(Ot),wt=_e("CroppieImageCrop"),jt=({imageUrl:L,cropType:E="cover",onCropChange:z,className:I=""})=>{const v=x.useRef(null),S=x.useRef(null),[C,k]=x.useState(!1),M=()=>E==="cover"?{viewport:{width:400,height:150},boundary:{width:450,height:200}}:{viewport:{width:200,height:200,type:"circle"},boundary:{width:250,height:250}},_=x.useCallback(()=>{if(S.current&&C){const A=E==="cover"?{type:"base64",format:"jpeg",quality:.95,size:{width:1e3,height:375},circle:!1}:{type:"base64",format:"jpeg",quality:.95,size:{width:320,height:320},circle:!0};return S.current.result(A)}return Promise.resolve(null)},[C,E]);if(x.useEffect(()=>{if(!L||!v.current)return;S.current&&(S.current.destroy(),S.current=null,k(!1));const A=M(),F=new Ht(v.current,A);return S.current=F,F.bind({url:L}).then(()=>{k(!0),wt.info("Croppie initialized successfully")}).catch(X=>{wt.error("Error initializing Croppie:",X)}),()=>{S.current&&(S.current.destroy(),S.current=null,k(!1))}},[L,E]),x.useEffect(()=>{z&&z({getCroppedResult:_,cropType:E})},[_,z,E]),!L){const A=M();return e.jsx("div",{className:`bg-gray-100 border-2 border-dashed border-gray-300 flex items-center justify-center ${I}`,style:{width:A.boundary.width,height:A.boundary.height},children:e.jsx("span",{className:"text-gray-500 text-sm",children:"No image selected"})})}return e.jsxs("div",{className:`croppie-container ${I}`,children:[e.jsx("div",{ref:v}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600 text-center",children:[e.jsx("p",{children:E==="cover"?"Cover Photo Cropping":"Profile Photo Cropping"}),e.jsx("p",{className:"text-gray-500",children:"Use the slider to zoom and drag to position"})]})]})},te=_e("BartenderService");class nt{static async updateBartenderName(E,z){const I=Date.now();te.info("Updating bartender name",{bartenderId:E,fullName:z});try{const{data:v,error:S}=await we.from("bartenders").update({full_name:z,updated_at:new Date().toISOString()}).eq("id",E).select().single();if(S)throw S;return te.info("Bartender name updated successfully",{bartenderId:E}),te.trace("updateBartenderName",I),v}catch(v){throw te.error("Error updating bartender name",v),v}}static async updateBartenderVenue(E,z){const I=Date.now();te.info("Updating bartender venue",{bartenderId:E,venueId:z});try{const{data:v,error:S}=await we.from("bartenders").update({venue_id:z,updated_at:new Date().toISOString()}).eq("id",E).select(`
          *,
          venues:venue_id (
            id,
            name,
            city,
            country
          )
        `).single();if(S)throw S;return te.info("Bartender venue updated successfully",{bartenderId:E,venueId:z}),te.trace("updateBartenderVenue",I),v}catch(v){throw te.error("Error updating bartender venue",v),v}}static async getBartenderDetails(E){const z=Date.now();te.info("Fetching bartender details",{bartenderId:E});try{const{data:I,error:v}=await we.from("bartenders").select(`
          *,
          venues:venue_id (
            id,
            name,
            city,
            country
          )
        `).eq("id",E).single();if(v)throw v;return te.info("Bartender details fetched successfully",{bartenderId:E}),te.trace("getBartenderDetails",z),I}catch(I){throw te.error("Error fetching bartender details",I),I}}static async updateBartender(E,z){const I=Date.now();te.info("Updating bartender",{bartenderId:E,updates:z});try{const v={...z,updated_at:new Date().toISOString()},{data:S,error:C}=await we.from("bartenders").update(v).eq("id",E).select(`
          *,
          venues:venue_id (
            id,
            name,
            city,
            country
          )
        `).single();if(C)throw C;return te.info("Bartender updated successfully",{bartenderId:E}),te.trace("updateBartender",I),S}catch(v){throw te.error("Error updating bartender",v),v}}}const Re=_e("useBartender"),Tt=L=>{const[E,z]=x.useState(!1),[I,v]=x.useState(null),S=x.useCallback(async M=>{if(!L)return v("No bartender ID provided"),null;z(!0),v(null);try{const _=await nt.updateBartenderName(L,M);return Re.info("Bartender name updated successfully"),_}catch(_){throw Re.error("Error updating bartender name:",_),v(_.message||"Failed to update name"),_}finally{z(!1)}},[L]),C=x.useCallback(async M=>{if(!L)return v("No bartender ID provided"),null;z(!0),v(null);try{const _=await nt.updateBartenderVenue(L,M);return Re.info("Bartender venue updated successfully"),_}catch(_){throw Re.error("Error updating bartender venue:",_),v(_.message||"Failed to update venue"),_}finally{z(!1)}},[L]),k=x.useCallback(async M=>{if(!L)return v("No bartender ID provided"),null;z(!0),v(null);try{const _=await nt.updateBartender(L,M);return Re.info("Bartender updated successfully"),_}catch(_){throw Re.error("Error updating bartender:",_),v(_.message||"Failed to update bartender"),_}finally{z(!1)}},[L]);return{loading:E,error:I,updateName:S,updateVenue:C,updateBartender:k}},ye=_e("ProfilePage"),$t=({bartenderId:L,bartenderName:E})=>{const[z,I]=x.useState([]),[v,S]=x.useState(!0),[C,k]=x.useState(null);x.useEffect(()=>{(async()=>{if(!L){S(!1),k("Bartender ID is missing.");return}S(!0),k(null),ye.debug(`Fetching history for bartender ID: ${L}`);try{const{data:A,error:F}=await we.from("legacy_results").select(`placement,
             post_competition_rating,
             pre_competition_rating,
             legacy_competition_id,
             legacy_competitions!fk_lr_competition (
               id,
               name,
               date
             )`).eq("bartender_id",L).order("date",{ascending:!1,foreignTable:"legacy_competitions"}).limit(10);if(F)throw F;ye.debug("Fetched competition history",{bartenderId:L,resultCount:A==null?void 0:A.length}),I(A||[])}catch(A){ye.error("Error fetching competition history:",{bartenderId:L,error:A}),k(`Failed to load competition history: ${A.message}`)}finally{S(!1)}})()},[L]);const M=(_,A)=>_==null||A==null?"?":Math.round(A-_);return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-8",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Recent Competition History"}),v?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx("div",{className:"animate-spin h-6 w-6 border-4 border-blue-600 rounded-full border-t-transparent"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading history..."})]}):C?e.jsx("div",{className:"text-red-600 p-4 text-center bg-red-50 rounded border border-red-200 text-sm",children:C}):z.length===0?e.jsx("div",{className:"text-gray-500 p-6 text-center italic text-sm",children:"No competition history found."}):e.jsx("div",{className:"space-y-3",children:z.map((_,A)=>{var B,T,H;const F=M(_.pre_competition_rating,_.post_competition_rating),X=(B=_.legacy_competitions)!=null&&B.date?new Date(_.legacy_competitions.date).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"}):"Unknown Date",q=F==="?"?"text-gray-500":F>0?"text-green-600":"text-red-600",ne=(T=_.legacy_competitions)!=null&&T.id?`${_.legacy_competitions.id}-${A}`:A;return e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm leading-tight",children:((H=_.legacy_competitions)==null?void 0:H.name)||"Unknown Competition"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:X}),e.jsx("div",{className:`text-xs font-medium ${q}`,children:F==="?"?"?":F>=0?`+${F}`:F})]})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("span",{className:"text-xs text-gray-600",children:["Position: #",_.placement||"N/A"]})})]},ne)})})]})},Vt=()=>{var lt,ct,dt,mt,ut;const{user:L,profile:E,isAuthenticated:z,loading:I,refreshProfile:v}=zt(),S=E==null?void 0:E.id,{profile:C,loading:k,error:M,updateProfile:_,createProfile:A,uploadImage:F,refresh:X}=Pt(S),{employment:q,loading:ne,addEmployment:B,updateEmployment:T,deleteEmployment:H,setEmployment:K}=At(S),{awards:G,loading:je,addAward:Ee,updateAward:ze,deleteAward:Z,setAwards:ce}=Mt(S),{cityChanges:P,loading:re,addCityChange:qe,updateCityChange:Pe,deleteCityChange:Ve,setCityChanges:pe}=Wt(S),{updateName:Ge,updateVenue:at}=Tt(S);x.useEffect(()=>{C&&(K(C.employment||[]),ce(C.awards||[]),pe(C.cityChanges||[]))},[C,K,ce,pe]);const[Ke,be]=x.useState(!1),[le,Ne]=x.useState(null),[Qe,de]=x.useState(!1),[ve,fe]=x.useState(null),[se,me]=x.useState(null),[ue,Ce]=x.useState(null),[he,Ae]=x.useState({cover:null,profile:null}),[ot,Me]=x.useState({cover:null,profile:null}),[He,Se]=x.useState({cover:null,profile:null}),[p,W]=x.useState({stillWorking:!0,stillLiveHere:!0}),[y,Q]=x.useState({}),[Je,Te]=x.useState(!1),[et,De]=x.useState(""),[xe,ae]=x.useState(!1),[t,i]=x.useState(!1),[r,a]=x.useState(null),[l,o]=x.useState(!1),[u,f]=x.useState(!1),w=x.useRef(null),b=x.useRef(null);x.useEffect(()=>{if(r&&t){const n=r.rawData;r.type==="job_start"||r.type==="job_end"?W(s=>({...s,title:n.position_title||"",startDate:n.start_date||"",endDate:n.end_date||"",stillWorking:n.is_current||!1,description:n.description||"",company:n.venues||null})):r.type==="award"?W(s=>{var c;return{...s,title:n.award_title||"",date:n.award_date||"",organizerId:n.organizer_id||null,organizerName:((c=n.organisers)==null?void 0:c.organisation_name)||""}}):r.type==="city_move"&&W(s=>({...s,moveDate:n.move_date||"",newCity:n.to_cities||null,previousCity:n.from_cities||null}))}},[r,t]);const j=x.useCallback(()=>{const n=[],s=d();return q.forEach(c=>{var Y,ee;const R=c.is_current&&s?s:c.venues?`${c.venues.city||"Unknown City"}, ${c.venues.country||"Unknown Country"}`:"Location unknown";n.push({type:"job_start",title:`Started as ${c.position_title}`,company:((Y=c.venues)==null?void 0:Y.name)||"Unknown Venue",date:c.start_date,location:R,id:`job_start_${c.id}`,rawData:c}),c.end_date&&!c.is_current&&n.push({type:"job_end",title:`Left ${c.position_title} position`,company:((ee=c.venues)==null?void 0:ee.name)||"Unknown Venue",date:c.end_date,location:R,id:`job_end_${c.id}`,rawData:c})}),G.forEach(c=>{var R,Y;n.push({type:"award",title:c.award_title,event:((R=c.organisers)==null?void 0:R.organisation_name)||"Competition",date:c.award_date,location:((Y=c.organisers)==null?void 0:Y.organisation_name)||"Competition Location",id:`award_${c.id}`,rawData:c})}),P.forEach(c=>{var R;n.push({type:"city_move",title:`Moved to ${((R=c.to_cities)==null?void 0:R.city)||"Unknown City"}`,location:c.to_cities?`${c.to_cities.city}${c.to_cities.state?", "+c.to_cities.state:""}, ${c.to_cities.country}`:"Unknown Location",date:c.move_date,previousCity:c.from_cities?`${c.from_cities.city}${c.from_cities.state?", "+c.from_cities.state:""}, ${c.from_cities.country}`:"Unknown Location",id:`city_move_${c.id}`,rawData:c})}),n.sort((c,R)=>new Date(R.date)-new Date(c.date))},[q,G,P,C]),D=()=>{var s,c;const n=q.find(R=>R.is_current);if(n){const R=d();return{name:((s=n.venues)==null?void 0:s.name)||"Current Workplace",position:n.position_title,location:R||"Location unknown"}}if(q.length>0){const R=q.reduce((Y,ee)=>new Date(ee.start_date)>new Date(Y.start_date)?ee:Y);return{name:((c=R.venues)==null?void 0:c.name)||"Recent Workplace",position:R.position_title,location:R.venues?`${R.venues.city||"Unknown City"}, ${R.venues.country||"Unknown Country"}`:"Unknown Location"}}return{name:"Your Current Workplace",position:"Your Position",location:"Your Location"}},d=()=>{var n;if(P.length>0){const c=[...P].sort((R,Y)=>new Date(Y.move_date)-new Date(R.move_date))[0];if(c.to_cities){const R=c.to_cities;return`${R.city}${R.state?", "+R.state:""}, ${R.country}`}}if((n=C==null?void 0:C.profile)!=null&&n.cities){const s=C.profile.cities;return`${s.city}${s.state?", "+s.state:""}, ${s.country}`}return null},h={coverPhoto:((lt=C==null?void 0:C.profile)==null?void 0:lt.cover_image_url)||Ye.cover,profilePhoto:((ct=C==null?void 0:C.profile)==null?void 0:ct.profile_image_url)||Ye.profile,fullName:((dt=C==null?void 0:C.bartender)==null?void 0:dt.full_name)||(E==null?void 0:E.full_name)||"Your Name",currentEmployer:D().name,currentPosition:D().position,currentLocation:D().location,city:d()||"Location unknown",publicProfileUrl:(mt=C==null?void 0:C.profile)!=null&&mt.public_profile_slug?Bt.generatePublicProfileUrl(C.profile.public_profile_slug):`${window.location.origin}${window.location.pathname.includes("masterbartendingchampionship")?"/masterbartendingchampionship":""}/#/profile/your-profile`,experience:j(),cocktails:[{id:1,name:"Smoky Manhattan",description:"A classic Manhattan with a smoky twist using mezcal",style:"Classic",category:"Whiskey",image:Ye.cocktail,details:{iceType:"Large cube",glassType:"Coupe",method:["Add ingredients to mixing glass with ice","Stir for 30 seconds until well chilled","Double strain into chilled coupe glass","Express orange peel over drink and garnish"],ingredients:["2 oz Rye Whiskey","0.5 oz Mezcal","1 oz Sweet Vermouth","2 dashes Angostura Bitters"],garnish:"Orange peel"}},{id:2,name:"Garden Gimlet",description:"A fresh take on the classic gimlet with cucumber and herbs",style:"Modern",category:"Gin",image:Ye.cocktail,details:{iceType:"Cubed ice",glassType:"Nick & Nora",method:["Muddle cucumber and basil in shaker","Add remaining ingredients and ice","Shake vigorously for 15 seconds","Double strain into chilled glass"],ingredients:["2 oz London Dry Gin","0.75 oz Fresh lime juice","0.75 oz Simple syrup","3 cucumber slices","4 fresh basil leaves"],garnish:"Cucumber wheel and basil sprig"}}]},m=n=>{Ne(n),be(!0)},g=()=>`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(h.publicProfileUrl)}`,N=async()=>{if(navigator.share)try{await navigator.share({title:`${h.fullName} - MBC Profile`,text:`Check out ${h.fullName}'s bartending profile`,url:h.publicProfileUrl})}catch(n){ye.warn("Error sharing:",n)}else try{await navigator.clipboard.writeText(h.publicProfileUrl),alert("Profile URL copied to clipboard!")}catch(n){ye.warn("Could not copy to clipboard:",n)}},O=n=>{fe(ve===n?null:n)},$=n=>{switch(n){case"job_start":case"job_end":return"💼";case"award":return"🏅";case"competition":return"🏆";case"city_move":return"✈️";default:return"📝"}},U=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),J=(n,s)=>{const c=n.target.files[0];if(c){const R=new FileReader;R.onload=Y=>{Ae(ee=>({...ee,[s]:Y.target.result}))},R.readAsDataURL(c),W(Y=>({...Y,[`${s}File`]:c}))}},V=(n,s)=>{var R,Y,ee;const c={};switch(n){case"employment":(R=s.title)!=null&&R.trim()||(c.title="Position title is required"),!s.company&&!p.company&&(c.company="Company/Bar is required"),s.startDate||(c.startDate="Start date is required"),!s.stillWorking&&!s.endDate&&(c.endDate="End date is required when not currently working");break;case"cityChange":!s.newCity&&!p.newCity&&(c.newCity="New city is required"),!s.previousCity&&!p.previousCity&&(c.previousCity="Previous city is required"),!s.stillLiveHere&&!s.moveDate&&(c.moveDate="Move date is required when not currently living here");break;case"award":(Y=s.title)!=null&&Y.trim()||(c.title="Award title is required"),s.organizerId||(c.organizerId="Event/Organization is required"),s.date||(c.date="Award date is required");break;case"name":(ee=s.fullName)!=null&&ee.trim()||(c.fullName="Full name is required");break;case"city":!s.newCity&&!p.newCity&&(c.newCity="City is required");break}return c},ge=async(n,s)=>{var R,Y,ee,We,Be,Fe,Ie,oe,ht,pt,ft,xt;console.log("handleFormSubmit called with:",{modalType:n,data:s,formData:p});const c=V(n,s);if(Q(c),Object.keys(c).length===0)try{Q({});let Ue={...s};switch(n){case"employment":const _t=((R=s.company)==null?void 0:R.id)||((Y=p.company)==null?void 0:Y.id),gt={position_title:s.title,venue_id:_t,start_date:s.startDate,end_date:s.stillWorking?null:s.endDate,is_current:s.stillWorking,description:s.description};console.log("Employment submission - full data:",{data:s,formData:p,employmentData:gt}),await B(gt),await ie(`Employment record for ${s.title} has been added successfully!`);break;case"award":await Ee({award_title:s.title,organizer_id:s.organizerId||p.organizerId,award_date:s.date}),await ie(`Award "${s.title}" has been added successfully!`);break;case"cityChange":const yt={from_city_id:((ee=s.previousCity)==null?void 0:ee.id)||((We=p.previousCity)==null?void 0:We.id),to_city_id:((Be=s.newCity)==null?void 0:Be.id)||((Fe=p.newCity)==null?void 0:Fe.id),move_date:s.stillLiveHere?new Date().toISOString().split("T")[0]:s.moveDate};console.log("City change submission - full data:",{data:s,formData:p,cityChangeData:yt}),await qe(yt);const Et=((Ie=s.newCity||p.newCity)==null?void 0:Ie.city)||"new city";await ie(`City change to ${Et} has been added successfully!`);break;case"city":if((oe=s.newCity)!=null&&oe.id||(ht=p.newCity)!=null&&ht.id){await _({cityId:((pt=s.newCity)==null?void 0:pt.id)||((ft=p.newCity)==null?void 0:ft.id)});const Oe=((xt=s.newCity||p.newCity)==null?void 0:xt.city)||"new city";await ie(`Your current city has been updated to ${Oe}!`)}break;case"cover":case"profile":if(He[n])try{const Oe=await He[n](),St=await(await fetch(Oe)).blob();await F(St,n),await ie(`Your ${n==="cover"?"cover photo":"profile image"} has been updated successfully!`)}catch(Oe){ye.error("Error processing cropped image:",Oe),Q({submit:"Error processing image. Please try again."});return}break;case"name":await Ge(s.fullName),await ie(`Your name has been updated to "${s.fullName}" successfully!`);break;default:console.log("Unhandled form type:",n,Ue)}me(null),Ce(null),W({stillWorking:!0}),Ae({cover:null,profile:null}),Me({cover:null,profile:null}),Se({cover:null,profile:null}),Q({})}catch(Ue){ye.error("Error submitting form:",Ue),Q({submit:Ue.message||"An error occurred while saving. Please try again."})}},ie=x.useCallback(async n=>{try{await Promise.all([X(),v()]),De(n),ae(!0),setTimeout(()=>{ae(!1),De("")},3e3),ye.info("Profile data and auth context refreshed, success shown")}catch(s){ye.error("Error refreshing profile data:",s),De(n),ae(!0),setTimeout(()=>{ae(!1),De("")},3e3)}},[X,v]),tt=async(n,s)=>{var Y,ee,We,Be,Fe,Ie;console.log("handleEditExperience called with:",{experience:n,data:s,formData:p});let c;n.type==="job_start"||n.type==="job_end"?c="employment":n.type==="award"?c="award":n.type==="city_move"&&(c="cityChange");const R=V(c,s);if(Q(R),!(Object.keys(R).length>0))try{if(n.type==="job_start"||n.type==="job_end"){const oe={position_title:s.title,venue_id:((Y=s.company)==null?void 0:Y.id)||((ee=p.company)==null?void 0:ee.id),start_date:s.startDate,end_date:s.stillWorking?null:s.endDate,is_current:s.stillWorking,description:s.description};console.log("Updating employment with:",oe),await T(n.rawData.id,oe),await ie("Employment record has been updated successfully!")}else if(n.type==="award"){const oe={award_title:s.title,organizer_id:s.organizerId||p.organizerId,award_date:s.date};console.log("Updating award with:",oe),await ze(n.rawData.id,oe),await ie("Award has been updated successfully!")}else if(n.type==="city_move"){const oe={from_city_id:((We=s.previousCity)==null?void 0:We.id)||((Be=p.previousCity)==null?void 0:Be.id),to_city_id:((Fe=s.newCity)==null?void 0:Fe.id)||((Ie=p.newCity)==null?void 0:Ie.id),move_date:s.moveDate};console.log("Updating city change with:",oe),await Pe(n.rawData.id,oe),await ie("City change has been updated successfully!")}i(!1),a(null),W({stillWorking:!0}),Q({})}catch(oe){console.error("Error updating experience:",oe),Q({submit:oe.message||"An error occurred while updating the experience."})}},Nt=async n=>{if(!(!n||!window.confirm(`Are you sure you want to delete this ${n.type==="job_start"||n.type==="job_end"?"employment record":n.type==="award"?"award":n.type==="city_move"?"city change":"experience"}? This action cannot be undone.`)))try{Q({}),n.type==="job_start"||n.type==="job_end"?(await H(n.rawData.id),await ie("Employment record has been deleted successfully!")):n.type==="award"?(await Z(n.rawData.id),await ie("Award has been deleted successfully!")):n.type==="city_move"&&(await Ve(n.rawData.id),await ie("City change has been deleted successfully!")),i(!1),a(null),W({stillWorking:!0,stillLiveHere:!0}),Q({})}catch(c){console.error("Error deleting experience:",c),Q({submit:c.message||"An error occurred while deleting the experience."})}},Le=()=>{me(null),Ce(null),Te(!1),W({stillWorking:!0,stillLiveHere:!0}),Ae({cover:null,profile:null}),Me({cover:null,profile:null}),Se({cover:null,profile:null}),Q({})},$e=x.useCallback((n,s)=>{s.getCroppedResult&&Se(c=>({...c,[n]:s.getCroppedResult})),Me(c=>({...c,[n]:s}))},[]),Ct=x.useCallback(n=>{$e("cover",n)},[$e]),kt=x.useCallback(n=>{$e("profile",n)},[$e]);return x.useEffect(()=>{const n=s=>{w.current&&!w.current.contains(s.target)&&ve==="edit"&&fe(null),b.current&&!b.current.contains(s.target)&&u&&f(!1)};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[ve,u]),I||k?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Loading your profile..."})]})}):!z||!S?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"You need to be signed in to view your profile."})]})}):M?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error Loading Profile"}),e.jsx("p",{className:"text-gray-600 mb-4",children:M.message||"Failed to load profile data"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Retry"})]})}):I||k||!S?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading Your Profile"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch your information..."})]})}):M?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 19c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Profile"}),e.jsx("p",{className:"text-gray-600 mb-4",children:M.message||"Unable to load your profile data"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Retry"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsxs("div",{className:"group h-48 bg-gradient-to-r from-blue-500 to-purple-600 relative",children:[e.jsx(Ze,{src:h.coverPhoto,alt:"Cover",className:"w-full h-full object-cover"}),e.jsx("button",{onClick:()=>me("cover"),className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity p-2 bg-black bg-opacity-50 text-white hover:bg-opacity-70 rounded-full",title:"Edit cover photo",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("div",{className:"absolute -bottom-16 left-6",children:e.jsxs("div",{className:"group relative w-32 h-32 bg-white rounded-full p-1 shadow-lg",children:[e.jsx(Ze,{src:h.profilePhoto,alt:"Profile",className:"w-full h-full rounded-full object-cover"}),e.jsx("button",{onClick:()=>me("profile"),className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity p-1.5 bg-black bg-opacity-50 text-white hover:bg-opacity-70 rounded-full",title:"Edit profile photo",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})})]}),e.jsxs("div",{className:"relative px-6 pt-20 pb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"group relative inline-block",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:h.fullName}),e.jsx("button",{onClick:()=>me("name"),className:"absolute -top-1 -right-8 opacity-0 group-hover:opacity-100 transition-opacity p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full",title:"Edit name",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]}),e.jsx("p",{className:"text-xl text-gray-600 mb-1",children:h.currentEmployer}),e.jsx("p",{className:"text-lg text-gray-500",children:h.city})]}),e.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-2",children:[e.jsxs("div",{className:"relative",ref:w,children:[e.jsxs("button",{onClick:()=>O("edit"),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium",title:"Edit Profile",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit",e.jsx("span",{className:`transform transition-transform ${ve==="edit"?"rotate-180":""}`,children:"▼"})]}),ve==="edit"&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 bg-white border border-gray-200 rounded-md shadow-lg z-10 w-56",children:[e.jsx("button",{onClick:()=>{me("name"),fe(null)},className:"block w-full text-left px-4 py-2 hover:bg-gray-50 text-sm text-gray-700",children:"Change Name"}),e.jsx("button",{onClick:()=>{me("cover"),fe(null)},className:"block w-full text-left px-4 py-2 hover:bg-gray-50 text-sm text-gray-700",children:"Change Cover Photo"}),e.jsx("button",{onClick:()=>{me("profile"),fe(null)},className:"block w-full text-left px-4 py-2 hover:bg-gray-50 text-sm text-gray-700",children:"Change Profile Image"})]})]}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",title:"Share Profile",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Experience"}),e.jsxs("div",{className:"relative",ref:b,children:[e.jsx("button",{onClick:()=>f(!u),className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors",title:"Add new experience",children:"+"}),u&&e.jsxs("div",{className:"absolute top-full right-0 bg-white border border-gray-200 rounded-md shadow-lg z-10 mt-1 w-48",children:[e.jsx("button",{onClick:()=>{Ce("employment"),f(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-50 text-sm",children:"Add Employment"}),e.jsx("button",{onClick:()=>{Ce("cityChange"),f(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-50 text-sm",children:"Add City Change"}),e.jsx("button",{onClick:()=>{Ce("award"),f(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-50 text-sm",children:"Add Award"}),e.jsx("button",{onClick:()=>{Te(!0),f(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-50 text-sm",children:"Submit Competition Result"})]})]})]}),e.jsx("div",{className:"space-y-6",children:h.experience.map((n,s)=>e.jsxs("div",{className:"group relative flex items-start space-x-4 p-3 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-lg",children:$(n.type)})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n.title}),e.jsxs("p",{className:"text-gray-600",children:[n.company||n.event,n.type==="city_move"&&n.previousCity&&e.jsxs("span",{children:[" (from ",n.previousCity,")"]})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[U(n.date)," • ",n.location]})]}),e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onClick:()=>{a(n),i(!0)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors",title:"Edit this experience",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})})]},n.id||s))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"My Cocktails"}),e.jsx("button",{onClick:()=>de(!0),className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors",title:"Add new cocktail",children:"+"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.cocktails.map(n=>e.jsxs("div",{onClick:()=>m(n),className:"border rounded-lg p-4 cursor-pointer hover:shadow-md transition-shadow",children:[e.jsx(Ze,{src:n.image,alt:n.name,className:"w-full h-32 object-cover rounded-md mb-3"}),e.jsx("h3",{className:"font-semibold text-lg text-gray-900",children:n.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:n.description}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:n.style}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:n.category})]})]},n.id))})]})]}),e.jsx("div",{className:"lg:col-span-1 space-y-6",children:e.jsx($t,{bartenderId:S,bartenderName:h.fullName})})]})}),Ke&&le&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:le.name}),e.jsx("button",{onClick:()=>be(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),e.jsx(Ze,{src:le.image,alt:le.name,className:"w-full h-48 object-cover rounded-lg mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:le.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Ice Type:"})," ",le.details.iceType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Glass Type:"})," ",le.details.glassType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Garnish:"})," ",le.details.garnish]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Ingredients"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:le.details.ingredients.map((n,s)=>e.jsx("li",{className:"text-sm",children:n},s))})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Method"}),e.jsx("ol",{className:"list-decimal list-inside space-y-2",children:le.details.method.map((n,s)=>e.jsx("li",{className:"text-sm",children:n},s))})]})]})})}),Qe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Add New Cocktail"}),e.jsx("button",{onClick:()=>de(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name*"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description*"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:"3"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Style*"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Select style"}),e.jsx("option",{value:"Classic",children:"Classic"}),e.jsx("option",{value:"Modern",children:"Modern"}),e.jsx("option",{value:"Tiki",children:"Tiki"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category*"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Select category"}),e.jsx("option",{value:"Whiskey",children:"Whiskey"}),e.jsx("option",{value:"Gin",children:"Gin"}),e.jsx("option",{value:"Vodka",children:"Vodka"}),e.jsx("option",{value:"Rum",children:"Rum"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ice Type*"}),e.jsx("input",{type:"text",placeholder:"e.g., Large cube",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Glass Type*"}),e.jsx("input",{type:"text",placeholder:"e.g., Coupe",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image"}),e.jsx("input",{type:"file",accept:"image/*",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ingredients*"}),e.jsx("textarea",{placeholder:"List ingredients with measurements...",className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:"4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Method Steps*"}),e.jsx("textarea",{placeholder:`1. Step one
2. Step two
3. Step three...`,className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:"4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Garnish"}),e.jsx("input",{type:"text",placeholder:"e.g., Orange peel",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>de(!1),className:"flex-1 px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Add Cocktail"})]})]})]})})}),se&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[se==="name"&&"Change Name",se==="cover"&&"Change Cover Photo",se==="city"&&"Change City",se==="profile"&&"Change Profile Image"]}),e.jsx("button",{onClick:Le,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),e.jsxs("form",{onSubmit:n=>{n.preventDefault();const s=new FormData(n.target),c=Object.fromEntries(s.entries());ge(se,c)},className:"space-y-4",children:[se==="name"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name*"}),e.jsx("input",{type:"text",name:"fullName",defaultValue:h.fullName,className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.fullName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.fullName}),e.jsx("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"💡 Tip:"})," To update your employer or location in your bio, use the Experience card below to add or edit your employment and city change records."]})})]}),se==="cover"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cover Photo*"}),e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Upload an image and use the cropping tools to position it perfectly"}),e.jsx("input",{type:"file",name:"coverFile",accept:"image/*",onChange:n=>J(n,"cover"),className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),he.cover&&e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(jt,{imageUrl:he.cover,cropType:"cover",onCropChange:Ct,className:"rounded-lg"},`cover-${he.cover}`)})})]}),se==="city"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City*"}),e.jsx(ke,{value:h.city,onSelect:n=>W(s=>({...s,newCity:n}))}),y.newCity&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.newCity})]}),se==="profile"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Profile Image*"}),e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Upload an image and use the cropping tools to position it perfectly"}),e.jsx("input",{type:"file",name:"profileFile",accept:"image/*",onChange:n=>J(n,"profile"),className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),he.profile&&e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(jt,{imageUrl:he.profile,cropType:"profile",onCropChange:kt,className:"rounded-lg"},`profile-${he.profile}`)})})]}),y.submit&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("p",{className:"text-red-700 text-sm",children:y.submit})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Le,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Save Changes"})]})]})]})})}),ue&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[ue==="employment"&&"Add Employment",ue==="cityChange"&&"Add City Change",ue==="award"&&"Add Award"]}),e.jsx("button",{onClick:Le,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),e.jsxs("form",{onSubmit:n=>{n.preventDefault();const s=new FormData(n.target),c=Object.fromEntries(s.entries());c.stillWorking=p.stillWorking,c.organizerId=p.organizerId,c.newCity=p.newCity,c.previousCity=p.previousCity,c.location=p.location,c.company=p.company,ge(ue,c)},className:"space-y-4",children:[ue==="employment"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Position Title*"}),e.jsx("input",{type:"text",name:"title",placeholder:"e.g., Head Bartender",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company/Bar*"}),e.jsx(vt,{onSelect:n=>{console.log("BarSelect onSelect called with:",n),W(s=>({...s,company:n}))},placeholder:"Select or enter bar name"}),y.company&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.company})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date*"}),e.jsx("input",{type:"date",name:"startDate",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.startDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.startDate})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("input",{type:"checkbox",id:"stillWorking",checked:p.stillWorking!==!1,onChange:n=>W(s=>({...s,stillWorking:n.target.checked})),className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"stillWorking",className:"ml-2 text-sm font-medium text-gray-700",children:"I still work here"})]}),p.stillWorking===!1&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date*"}),e.jsx("input",{type:"date",name:"endDate",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.endDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.endDate})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location*"}),e.jsx(ke,{onSelect:n=>W(s=>({...s,location:n})),placeholder:"Select or enter city"}),y.location&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.location})]})]}),ue==="cityChange"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New City*"}),e.jsx(ke,{onSelect:n=>W(s=>({...s,newCity:n})),placeholder:"Select or enter new city"}),y.newCity&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.newCity})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700",children:[e.jsx("input",{type:"checkbox",name:"stillLiveHere",checked:p.stillLiveHere!==void 0?p.stillLiveHere:!0,onChange:n=>W(s=>({...s,stillLiveHere:n.target.checked})),className:"mr-2"}),"I still live here"]})}),!p.stillLiveHere&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Previous City*"}),e.jsx(ke,{onSelect:n=>W(s=>({...s,previousCity:n})),placeholder:"Select or enter previous city"}),y.previousCity&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.previousCity})]}),!p.stillLiveHere&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Move Date*"}),e.jsx("input",{type:"date",name:"moveDate",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.moveDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.moveDate})]})]}),ue==="award"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Award Title*"}),e.jsx("input",{type:"text",name:"title",placeholder:"e.g., Best Bartender 2024",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Event/Organization*"}),e.jsx(bt,{onSelect:n=>W(s=>({...s,organizerId:n.id,organizerName:n.organisation_name})),placeholder:"Select or add organization"}),y.organizerId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.organizerId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Award Date*"}),e.jsx("input",{type:"date",name:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.date&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location*"}),e.jsx(ke,{onSelect:n=>W(s=>({...s,location:n})),placeholder:"Select or enter city"}),y.location&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.location})]})]}),y.submit&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("p",{className:"text-red-700 text-sm",children:y.submit})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Le,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Add Experience"})]})]})]})})}),t&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Edit ",r.type==="job_start"||r.type==="job_end"?"Employment":r.type==="award"?"Award":r.type==="city_move"?"City Change":"Experience"]}),e.jsx("button",{onClick:()=>{i(!1),a(null),W({stillWorking:!0}),Q({})},className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),e.jsxs("form",{onSubmit:n=>{n.preventDefault();const s=new FormData(n.target),c=Object.fromEntries(s.entries());c.company=p.company,c.organizerId=p.organizerId,c.newCity=p.newCity,c.previousCity=p.previousCity,tt(r,c)},className:"space-y-4",children:[(r.type==="job_start"||r.type==="job_end")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Position Title*"}),e.jsx("input",{type:"text",name:"title",value:p.title||"",onChange:n=>W(s=>({...s,title:n.target.value})),placeholder:"e.g., Head Bartender",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company/Bar*"}),e.jsx(vt,{value:((ut=p.company)==null?void 0:ut.name)||"",onSelect:n=>W(s=>({...s,company:n})),placeholder:"Select or add company"}),y.company&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.company})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date*"}),e.jsx("input",{type:"date",name:"startDate",value:p.startDate||"",onChange:n=>W(s=>({...s,startDate:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.startDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.startDate})]}),e.jsx("div",{children:e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx("input",{type:"checkbox",name:"stillWorking",checked:p.stillWorking||!1,onChange:n=>W(s=>({...s,stillWorking:n.target.checked})),className:"mr-2"}),"I still work here"]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:p.endDate||"",onChange:n=>W(s=>({...s,endDate:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.endDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.endDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:p.description||"",onChange:n=>W(s=>({...s,description:n.target.value})),placeholder:"Describe your role and achievements",className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:"3"})]})]}),r.type==="award"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Award Title*"}),e.jsx("input",{type:"text",name:"title",value:p.title||"",onChange:n=>W(s=>({...s,title:n.target.value})),placeholder:"e.g., Best Bartender 2024",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Event/Organization*"}),e.jsx(bt,{value:p.organizerName||"",onSelect:n=>W(s=>({...s,organizerId:n.id,organizerName:n.organisation_name})),placeholder:"Select or add event/organization"}),y.organizerId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.organizerId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Award Date*"}),e.jsx("input",{type:"date",name:"date",value:p.date||"",onChange:n=>W(s=>({...s,date:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.date&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.date})]})]}),r.type==="city_move"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New City*"}),e.jsx(ke,{value:p.newCity?`${p.newCity.city}${p.newCity.state?", "+p.newCity.state:""}, ${p.newCity.country}`:"",onSelect:n=>W(s=>({...s,newCity:n})),placeholder:"Select or enter new city"}),y.newCity&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.newCity})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Previous City*"}),e.jsx(ke,{value:p.previousCity?`${p.previousCity.city}${p.previousCity.state?", "+p.previousCity.state:""}, ${p.previousCity.country}`:"",onSelect:n=>W(s=>({...s,previousCity:n})),placeholder:"Select or enter previous city"}),y.previousCity&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.previousCity})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Move Date*"}),e.jsx("input",{type:"date",name:"moveDate",value:p.moveDate||"",onChange:n=>W(s=>({...s,moveDate:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),y.moveDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.moveDate})]})]}),y.submit&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("p",{className:"text-red-700 text-sm",children:y.submit})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{i(!1),a(null),W({stillWorking:!0}),Q({})},className:"flex-1 px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>Nt(r),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Delete"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Save Changes"})]})]})]})})}),Je&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Submit Competition Result"}),e.jsx("button",{onClick:Le,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),e.jsx(Ft,{onSuccess:async()=>{Le(),await showSuccessAndRefresh("Competition result has been submitted successfully!")},onError:n=>{console.error("Competition submission error:",n),Q({submit:n.message||"Error submitting competition result. Please try again."})}})]})})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Share Public Profile"}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("img",{src:g(),alt:"Profile QR Code",className:"mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Scan to view profile"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Profile URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:h.publicProfileUrl,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-sm"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(h.publicProfileUrl)},className:"px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-md text-sm font-medium transition-colors",title:"Copy URL",children:"Copy"})]})]}),e.jsx("button",{onClick:N,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors",children:"Share Profile"})]})})}),xe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg p-8 max-w-md w-full mx-4 transform animate-pulse",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Success!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:et}),e.jsx("p",{className:"text-sm text-gray-500",children:"Your changes have been saved and your profile has been updated."})]})})})]})};export{Vt as default};
