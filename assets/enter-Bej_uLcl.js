import{s as d,g as m,l as y,c as g,i as E,b as w}from"./countdown-DbY42gfx.js";async function q(){await g.ensureInitialized();const t=document.querySelectorAll(".auth-tab"),e=document.querySelectorAll(".auth-form"),i=await g.getCurrentUser();if(i&&h(i),t.length>0&&e.length>0){t.forEach(n=>{n.addEventListener("click",()=>{var a;const s=n.dataset.form;t.forEach(o=>o.classList.remove("active")),e.forEach(o=>o.classList.remove("active")),n.classList.add("active"),(a=document.getElementById(`${s}-form`))==null||a.classList.add("active")})});const l=document.getElementById("signin-form"),r=document.getElementById("signup-form");if(l&&l.addEventListener("submit",L),r){r.addEventListener("submit",k);const n=r.querySelector('select[name="role"]'),s=r.querySelector(".bartender-fields"),a=r.querySelector(".organiser-fields");n&&s&&a&&n.addEventListener("change",o=>{o.target.value==="bartender"?(s.style.display="block",a.style.display="none"):(s.style.display="none",a.style.display="block")})}}}async function L(t){t.preventDefault();const e=t.target,i=e.querySelector('input[type="email"]').value,l=e.querySelector('input[type="password"]').value,r=v(e),n=p(e);r.style.display="none",n.style.display="none";try{const{data:s,error:a}=await d.auth.signInWithPassword({email:i,password:l});if(a)throw a;if(s.user){n.textContent="Login successful! Redirecting...",n.style.display="block",h(s.user);const o=m();setTimeout(()=>{window.location.href=o},1500)}}catch(s){y(s),r.textContent=s.message||"Error signing in",r.style.display="block"}}async function k(t){t.preventDefault();const e=t.target,i=e.querySelector('input[name="fullName"]').value,l=e.querySelector('input[name="email"]').value,r=e.querySelector('input[name="password"]').value,n=e.querySelector('select[name="role"]').value,s=n==="bartender"?e.querySelector('input[name="bar"]').value:null,a=n==="organiser"?e.querySelector('input[name="brand"]').value:null,o=v(e),c=p(e);o.style.display="none",c.style.display="none";try{const{data:u,error:f}=await d.auth.signUp({email:l,password:r,options:{data:{full_name:i,role:n,bar:s,brand:a}}});if(f)throw f;u.user&&(c.textContent="Account created successfully! Please check your email for verification.",c.style.display="block",setTimeout(()=>{const S=m();window.location.href=S},3e3))}catch(u){y(u),o.textContent=u.message||"Error creating account",o.style.display="block"}}function h(t){const e=document.querySelector(".auth-container");e&&(e.innerHTML=`
      <div class="profile-summary">
        <h2>Welcome, ${t.user_metadata.full_name||"User"}</h2>
        <button onclick="handleSignOut()" class="submit-button">Sign Out</button>
      </div>
    `)}function v(t){let e=t.querySelector(".error-message");return e||(e=document.createElement("div"),e.className="error-message",t.insertBefore(e,t.firstChild)),e}function p(t){let e=t.querySelector(".success-message");return e||(e=document.createElement("div"),e.className="success-message",t.insertBefore(e,t.firstChild)),e}window.handleSignOut=async function(){try{const{error:t}=await d.auth.signOut();if(t)throw t;const e=m();window.location.href=e+"enter"}catch(t){y(t),alert("Error signing out. Please try again.")}};document.addEventListener("DOMContentLoaded",()=>{E(),w(),q()});function b(){const t=document.querySelectorAll(".auth-tab"),e=document.querySelectorAll(".auth-form"),i=document.querySelector('select[name="role"]'),l=document.querySelector(".bartender-fields"),r=document.querySelector(".organiser-fields");t.forEach(n=>{n.addEventListener("click",function(s){s.preventDefault();const a=this.dataset.form;console.log("Tab clicked:",a),t.forEach(c=>c.classList.remove("active")),e.forEach(c=>c.classList.remove("active")),this.classList.add("active");const o=document.getElementById(`${a}-form`);o&&o.classList.add("active")})}),i&&i.addEventListener("change",n=>{console.log("Role changed:",n.target.value),n.target.value==="bartender"?(l.style.display="block",r.style.display="none"):(l.style.display="none",r.style.display="block")})}b();document.addEventListener("DOMContentLoaded",b);
