import{j as e,R as ae,r as m,P as re,s as te,f as oe,c as se,u as ce,a as ne,b as de,d as me}from"./main-Do236Ahx.js";import{s as I,l as ue,c as he}from"./OrganizerSelect-BXb4Y9_J.js";import{B as ge,R as xe}from"./ResultForm-CDLcb2dm.js";import{s as W}from"./toast-CesTQUbM.js";import{E as fe}from"./EventCarousel-CnkcU_5g.js";class pe{async retryQuery(h,t,v=2){for(let f=1;f<=v;f++)try{console.log(`[LeaderboardService] ${t} attempt ${f}/${v}`);const g=await h();return console.log(`[LeaderboardService] ${t} succeeded on attempt ${f}`),g}catch(g){if(console.warn(`[LeaderboardService] ${t} failed on attempt ${f}:`,g.message),f===v)throw g;const n=f===1?500:1e3;console.log(`[LeaderboardService] Retrying ${t} in ${n}ms...`),await new Promise(L=>setTimeout(L,n))}}async fetchLeaderboardData(){const h=Date.now();console.log(`[LeaderboardService] Starting fetchLeaderboardData at ${new Date().toISOString()}`);const t=Date.now()-performance.timeOrigin;document.readyState==="complete"&&t<1e3&&(console.log(`[LeaderboardService] Detected recent page load (${t}ms ago), adding minimal delay`),await new Promise(v=>setTimeout(v,50)));try{console.log(`[LeaderboardService] Starting database queries at ${Date.now()-h}ms`);try{const{data:s}=await I.auth.getSession();console.log(`[LeaderboardService] Session status: ${s.session?"authenticated":"anonymous"}`)}catch{console.warn("[LeaderboardService] Session check failed, proceeding with anonymous access")}const v=new Promise((s,o)=>setTimeout(()=>o(new Error(`Database query timeout after 8s - elapsed: ${Date.now()-h}ms`)),8e3));console.log(`[LeaderboardService] Starting parallel database queries at ${Date.now()-h}ms`);const[f,g]=await Promise.all([this.retryQuery(async()=>{const s=I.from("legacy_results").select(`
              id,
              legacy_competition_id,
              bartender_id,
              placement,
              points,
              status,
              competition_category,
              legacy_competitions!fk_lr_competition (
                id,
                name,
                date,
                category
              )
            `).eq("status","approved");return await Promise.race([s,v])},"legacy_results query"),this.retryQuery(async()=>{const s=I.from("bartenders").select(`
              id, 
              full_name,
              rating,
              rating_rd,
              rating_volatility,
              ranking,
              speed_rating,
              speed_rd,
              speed_volatility,
              speed_ranking,
              traditional_rating,
              traditional_rd,
              traditional_volatility,
              traditional_ranking,
              flair_rating,
              flair_rd,
              flair_volatility,
              flair_ranking,
              is_profile_claimed,
              bartender_profiles!fk_bp_bartender (
                profile_image_url,
                profile_visibility,
                public_profile_slug,
                instagram_handle,
                facebook_handle,
                linkedin_handle,
                x_handle,
                tiktok_handle,
                snapchat_handle,
                youtube_handle,
                reddit_handle,
                discord_handle
              )
            `).eq("is_approved",!0).not("is_archived","eq",!0);return await Promise.race([s,v])},"bartenders query")]),{data:n,error:L}=f,{data:S,error:P}=g;if(console.log(`[LeaderboardService] Parallel queries completed at ${Date.now()-h}ms - results: ${(n==null?void 0:n.length)||0}, bartenders: ${(S==null?void 0:S.length)||0}`),L)throw L;if(P)throw P;const R={legacy:new Set,speed:new Set,traditional:new Set,flair:new Set};n.forEach(s=>{var k;if(!s.bartender_id)return;let o=((k=s.legacy_competitions)==null?void 0:k.category)||s.competition_category||"legacy";R[o]?R[o].add(s.bartender_id):R.legacy.add(s.bartender_id)});const r=s=>{if(!s)return{};const o={instagram:s.instagram_handle,facebook:s.facebook_handle,linkedin:s.linkedin_handle,x:s.x_handle,tiktok:s.tiktok_handle,snapchat:s.snapchat_handle,youtube:s.youtube_handle,reddit:s.reddit_handle,discord:s.discord_handle};return Object.fromEntries(Object.entries(o).filter(([,k])=>!!k))},c=(s,o="rating")=>{const k=s.bartender_profiles||null,A=s[o]??s.rating??null;return{id:s.id,name:s.full_name,rating:A,rating_rd:s[`${o}_rd`]??s.rating_rd??null,points:Math.round(A||0),ranking:null,legacyRating:s.rating,speedRating:s.speed_rating,flairRating:s.flair_rating,traditionalRating:s.traditional_rating,hasLegacyResults:R.legacy.has(s.id),hasSpeedResults:R.speed.has(s.id),hasFlairResults:R.flair.has(s.id),hasTraditionalResults:R.traditional.has(s.id),profileImageUrl:(k==null?void 0:k.profile_image_url)||null,publicProfileSlug:(k==null?void 0:k.public_profile_slug)||null,profileVisibility:(k==null?void 0:k.profile_visibility)||null,isProfileClaimed:s.is_profile_claimed||!1,socialHandles:r(k)}},N=s=>{let o=1,k=null;return s.map((A,q)=>{k!==null&&A.rating!==k&&(o=q+1);const V=o;return k=A.rating,{...A,ranking:V}})},M=s=>{const o=new Map;return s.forEach(k=>{o.set(k.id,k.ranking)}),o},u=N(S.filter(s=>R.legacy.has(s.id)&&s.rating!=null).sort((s,o)=>(o.rating||0)-(s.rating||0)).map(s=>c(s,"rating"))),x=N(S.filter(s=>R.speed.has(s.id)&&s.speed_rating!=null).sort((s,o)=>(o.speed_rating||0)-(s.speed_rating||0)).map(s=>c(s,"speed_rating"))),w=N(S.filter(s=>R.traditional.has(s.id)&&s.traditional_rating!=null).sort((s,o)=>(o.traditional_rating||0)-(s.traditional_rating||0)).map(s=>c(s,"traditional_rating"))),a=N(S.filter(s=>R.flair.has(s.id)&&s.flair_rating!=null).sort((s,o)=>(o.flair_rating||0)-(s.flair_rating||0)).map(s=>c(s,"flair_rating"))),p=M(u),T=M(x),i=M(w),b=M(a),j=s=>s.map(o=>({...o,legacyRanking:p.get(o.id)||null,speedRanking:T.get(o.id)||null,traditionalRanking:i.get(o.id)||null,flairRanking:b.get(o.id)||null})),_=j(u),$=j(x),y=j(w),z=j(a);return{legacy:_,speed:$,traditional:y,flair:z}}catch(v){return ue(v),{legacy:[],traditional:[],flair:[],speed:[]}}}}const be=new pe,je=({subdued:l=!1,className:h="h-8 w-8"}={})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${h} ${l?"text-gray-700":"text-gray-400"}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"7",r:"4"}),e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"})]}),E=10,ve={instagram:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M7 2C4.24 2 2 4.24 2 7v10c0 2.76 2.24 5 5 5h10c2.76 0 5-2.24 5-5V7c0-2.76-2.24-5-5-5H7zm0 2h10c1.66 0 3 1.34 3 3v10c0 1.66-1.34 3-3 3H7c-1.66 0-3-1.34-3-3V7c0-1.66 1.34-3 3-3zm5 2.5A4.5 4.5 0 0 0 7.5 11 4.5 4.5 0 0 0 12 15.5 4.5 4.5 0 0 0 16.5 11 4.5 4.5 0 0 0 12 6.5zm0 2A2.5 2.5 0 0 1 14.5 11 2.5 2.5 0 0 1 12 13.5 2.5 2.5 0 0 1 9.5 11 2.5 2.5 0 0 1 12 8.5zm5.25-3a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5z"})}),facebook:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M22 12.07C22 6.55 17.52 2 12 2S2 6.55 2 12.07c0 5 3.66 9.14 8.44 9.93v-7.03H7.9V12.1h2.54V9.86c0-2.5 1.5-3.89 3.8-3.89 1.1 0 2.24.2 2.24.2v2.46H15.7c-1.24 0-1.62.77-1.62 1.56v1.9h2.76l-.44 2.87h-2.32V22c4.78-.79 8.44-4.93 8.44-9.93"})}),linkedin:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M4.98 3.5a2.25 2.25 0 1 1 0 4.5 2.25 2.25 0 0 1 0-4.5zM3.5 9h2.95v12H3.5zM9 9h2.83v1.64h.04c.39-.74 1.35-1.52 2.78-1.52 2.98 0 3.53 1.96 3.53 4.51V21H15v-5.38c0-1.28-.02-2.93-1.79-2.93-1.79 0-2.07 1.4-2.07 2.84V21H9z"})}),x:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M17.74 3H20l-5.26 6 6.4 9H16.3L12.7 13.9 8.6 18H6.26l5.44-6.2L5.6 3h5.54l3.26 4.83L17.74 3Zm-1.29 14.2h1.7L7.7 4.62H5.88l10.57 12.58Z"})}),tiktok:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M20 5.13c-.78.02-1.52-.2-2.17-.62-.64-.41-1.13-1-1.4-1.7l-2.3-.03v11.16a2.22 2.22 0 1 1-2-2.2V9.54a5.22 5.22 0 1 0 4.57 7.73 5.19 5.19 0 0 0 .75-2.72V9.2c.74.53 1.63.83 2.55.83V5.13Z"})}),snapchat:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M12 2c2.74 0 5.12 1.83 5.6 4.58.06.31.09.63.09.95 0 1.44-.22 2.92-.64 4.27-.23.74.2 1.52.97 1.73a5 5 0 0 0 1.23.13c.37 0 .67.3.67.66 0 .37-.3.67-.67.67-.43 0-.85-.04-1.27-.13-.52-.11-1.02.26-1.09.78-.07.44-.22.87-.45 1.26a3.66 3.66 0 0 1-3.16 1.78c-.59 0-1.17-.13-1.7-.37-.36-.16-.76-.16-1.12 0-.53.24-1.11.37-1.7.37-1.34 0-2.52-.68-3.16-1.78a3.6 3.6 0 0 1-.45-1.26c-.07-.52-.57-.89-1.09-.78-.42.09-.84.13-1.27.13-.37 0-.67-.3-.67-.67 0-.36.3-.66.67-.66.42 0 .84-.04 1.23-.13.77-.21 1.2-.99.97-1.73a16.76 16.76 0 0 1-.64-4.27c0-.32.03-.64.09-.95C6.88 3.83 9.26 2 12 2Z"})}),youtube:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M21.6 7.2c-.2-.92-.96-1.64-1.88-1.74C18.25 5.2 12 5.2 12 5.2s-6.25 0-7.72.26c-.92.1-1.68.82-1.88 1.74-.27 1.52-.27 4.68-.27 4.68s0 3.16.27 4.68c.2.92.96 1.64 1.88 1.74 1.47.26 7.72.26 7.72.26s6.25 0 7.72-.26c.92-.1 1.68-.82 1.88-1.74.27-1.52.27-4.68.27-4.68s0-3.16-.27-4.68ZM10 15.5V8.5l6 3.5-6 3.5Z"})}),reddit:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M12 2a1 1 0 0 1 .98.8l.38 1.9c1.82.08 3.5.47 4.78 1.08l.76-.78a1 1 0 1 1 1.44 1.38l-.7.72c1.31.94 2.08 2.14 2.08 3.47 0 1.43-.88 2.7-2.32 3.64.15.45.24.93.24 1.41 0 3.08-3.33 5.58-7.64 5.58-4.32 0-7.64-2.5-7.64-5.58 0-.48.08-.96.24-1.41C3.88 13 3 11.73 3 10.3c0-3.2 3.62-5.26 8.4-5.26.2 0 .39 0 .58.01l-.3-1.56A1 1 0 0 1 12 2Zm-4 8a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Zm8 0a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Zm-7.28 4.88a.75.75 0 1 0-.94 1.16C9.5 17.22 10.7 17.7 12 17.7s2.5-.48 3.22-.66a.75.75 0 1 0-.38-1.46c-.58.15-1.6.46-2.84.46s-2.26-.31-2.84-.46Z"})}),discord:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M20.32 4.37A18 18 0 0 0 15.52 3l-.23.25c1.7.43 3.17 1.06 4.44 1.9-1.94-.9-3.83-1.34-5.68-1.34A17.2 17.2 0 0 0 8.48 5c-.3.15-.58.3-.86.46-.1.06-.2.12-.3.18-.06.04-.12.08-.18.12h-.02c-.1.07-.2.14-.3.2-.07.05-.14.1-.2.15a.37.37 0 0 0-.03.03C4.87 7.65 4 10.04 4 12.68c0 0 1.16 2.06 4.2 2.16a3 3 0 0 1-.75-1.4c.41.32 1.03.7 1.98.82-.87-.37-1.4-.91-1.72-1.46.4.28.93.55 1.58.74.65.2 1.3.34 1.85.43.55.1 1.02.14 1.3.14h.3c.18 0 .5-.05.88-.12.38-.07.82-.17 1.27-.28.46-.12.94-.27 1.42-.45.49-.18.94-.4 1.39-.64-.26.5-.77 1.06-1.63 1.46.94-.12 1.56-.5 1.98-.82-.16.57-.4 1-.75 1.4 3.04-.1 4.2-2.16 4.2-2.16 0-2.64-.87-5.03-2.78-7.02Z"})})};function we({data:l=[],type:h="legacy",filter:t="rating",currentPage:v=0,onPageChange:f,searchActive:g=!1,onHistoryClick:n=()=>{}}){const L=a=>Math.round(a.rating||0),S="Rating",P=g?0:v*E,R=g?l.slice(0,Math.min(50,l.length)):l.slice(P,P+E),r=g?1:Math.ceil(l.length/E),c=v<r-1,N=v>0,M=a=>a%2===0?"bg-zinc-850":"bg-zinc-800",u=a=>a===1?e.jsx("div",{className:"medal-icon medal-gold",children:"1"}):a===2?e.jsx("div",{className:"medal-icon medal-silver",children:"2"}):a===3?e.jsx("div",{className:"medal-icon medal-bronze",children:"3"}):a,x=a=>a===1?"rank-1":a===2?"rank-2":a===3?"rank-3":"",w=["Rank","Profile","Name",S,""];return e.jsxs("div",{className:"overflow-x-auto rounded-lg shadow",children:[e.jsxs("table",{className:"leaderboard-table min-w-full divide-y divide-gray-700",children:[e.jsx("thead",{className:"bg-zinc-700",children:e.jsx("tr",{children:w.map((a,p)=>e.jsx("th",{className:`px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider ${p===w.length-1?"w-12 text-center":""}`,children:a},a))})}),e.jsxs("tbody",{className:"divide-y divide-gray-700",children:[R.map((a,p)=>{const T=a.socialHandles?Object.entries(a.socialHandles).filter(([,_])=>!!_):[],i=T.slice(0,2),b=T.length>2,j=a.ranking||(g?p+1:P+p+1);return e.jsxs("tr",{className:`${M(p)} ${x(j)} hover:bg-zinc-700 cursor-pointer group`,onClick:()=>n(a),children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:u(j)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"profile-pic h-10 w-10 bg-zinc-600 rounded-full flex items-center justify-center border border-gray-500 transition-colors",onClick:_=>{_.stopPropagation(),n(a)},title:`View ${a.name}'s competition history`,children:a.profileImageUrl?e.jsx("img",{src:a.profileImageUrl,alt:`${a.name} profile`,className:"h-full w-full rounded-full object-cover"}):je({subdued:!a.isProfileClaimed})})}),e.jsx("td",{className:"px-4 py-3 text-sm text-white",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"bg-transparent border-none p-0 text-left text-white",onClick:_=>{_.stopPropagation(),n(a)},children:a.name}),i.length>0&&e.jsxs("div",{className:"flex items-center gap-1 ml-1",children:[i.map(([_])=>e.jsx("span",{className:"inline-flex items-center justify-center opacity-60",style:{width:"12px",height:"12px"},children:ae.cloneElement(ve[_],{className:"w-3 h-3"})},_)),b&&e.jsx("span",{className:"text-xs text-gray-300 opacity-60",children:"â€¦"})]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-white font-medium",children:L(a)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("span",{className:"inline-flex items-center justify-center text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:"w-4 h-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})})})]},a.id||p)}),!g&&(c||N)&&e.jsx("tr",{className:"pagination-row bg-zinc-800",children:e.jsx("td",{colSpan:w.length,className:"text-center py-3 px-4 border-t border-gray-700",children:e.jsxs("div",{className:"pagination-controls flex justify-center gap-3",children:[N&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"pagination-button",onClick:()=>f(0),children:"TopÂ 10"}),e.jsx("button",{className:"pagination-button",onClick:()=>f(v-1),children:"PreviousÂ 10"})]}),c&&e.jsx("button",{className:"pagination-button",onClick:()=>f(v+1),children:"NextÂ 10"})]})})}),g&&l.length>50&&e.jsx("tr",{className:"bg-zinc-800",children:e.jsx("td",{colSpan:w.length,className:"text-center py-3 px-4 text-gray-400 border-t border-gray-700",children:"Showing top 50 results. Please refine your search."})})]})]}),l.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400 italic",children:g?"No bartenders match your search.":"No competitors found yet."}),!g&&l.length>0&&R.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400 italic",children:"No more results on this page."})]})}const Q=({isOpen:l,onClose:h,title:t,children:v,maxWidth:f="max-w-xl"})=>{if(m.useEffect(()=>{const n=L=>{L.key==="Escape"&&h()};return l?(document.addEventListener("keydown",n),document.body.style.overflow="hidden"):document.body.style.overflow="",()=>{document.removeEventListener("keydown",n),document.body.style.overflow=""}},[l,h]),!l)return null;const g=n=>{if(n.target===n.currentTarget){const L=window.getSelection();if(L&&L.toString().length>0)return;h()}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[9999] p-4 transition-opacity duration-300 ease-in-out",onClick:g,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:e.jsxs("div",{className:`bg-zinc-800 rounded-lg shadow-xl w-full ${f} max-h-[90vh] overflow-hidden flex flex-col`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-700 flex-shrink-0",children:[e.jsx("h2",{id:"modal-title",className:"text-xl font-semibold text-white",children:t||"Modal"}),e.jsx("button",{type:"button",onClick:h,className:"text-gray-400 hover:text-white text-2xl leading-none font-bold focus:outline-none p-1","aria-label":"Close modal",children:"Ã—"})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-grow",children:v})]})})},ee=se("CompetitionHistoryModalContent"),Ne=e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-full w-full text-gray-400",children:[e.jsx("circle",{cx:"12",cy:"7",r:"4"}),e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"})]}),ye={instagram:{label:"Instagram",prefix:"https://instagram.com/",bg:"linear-gradient(135deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888)",textColor:"#ffffff",icon:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M7 2C4.24 2 2 4.24 2 7v10c0 2.76 2.24 5 5 5h10c2.76 0 5-2.24 5-5V7c0-2.76-2.24-5-5-5H7zm0 2h10c1.66 0 3 1.34 3 3v10c0 1.66-1.34 3-3 3H7c-1.66 0-3-1.34-3-3V7c0-1.66 1.34-3 3-3zm5 2.5A4.5 4.5 0 0 0 7.5 11 4.5 4.5 0 0 0 12 15.5 4.5 4.5 0 0 0 16.5 11 4.5 4.5 0 0 0 12 6.5zm0 2A2.5 2.5 0 0 1 14.5 11 2.5 2.5 0 0 1 12 13.5 2.5 2.5 0 0 1 9.5 11 2.5 2.5 0 0 1 12 8.5zm5.25-3a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5z"})})},facebook:{label:"Facebook",prefix:"https://facebook.com/",bg:"#1877F2",textColor:"#ffffff",icon:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M22 12.07C22 6.55 17.52 2 12 2S2 6.55 2 12.07c0 5 3.66 9.14 8.44 9.93v-7.03H7.9V12.1h2.54V9.86c0-2.5 1.5-3.89 3.8-3.89 1.1 0 2.24.2 2.24.2v2.46H15.7c-1.24 0-1.62.77-1.62 1.56v1.9h2.76l-.44 2.87h-2.32V22c4.78-.79 8.44-4.93 8.44-9.93"})})},linkedin:{label:"LinkedIn",prefix:"https://linkedin.com/in/",bg:"#0A66C2",textColor:"#ffffff",icon:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M4.98 3.5a2.25 2.25 0 1 1 0 4.5 2.25 2.25 0 0 1 0-4.5zM3.5 9h2.95v12H3.5zM9 9h2.83v1.64h.04c.39-.74 1.35-1.52 2.78-1.52 2.98 0 3.53 1.96 3.53 4.51V21H15v-5.38c0-1.28-.02-2.93-1.79-2.93-1.79 0-2.07 1.4-2.07 2.84V21H9z"})})},x:{label:"X",prefix:"https://x.com/",bg:"#000000",textColor:"#ffffff",icon:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M17.74 3H20l-5.26 6 6.4 9H16.3L12.7 13.9 8.6 18H6.26l5.44-6.2L5.6 3h5.54l3.26 4.83L17.74 3Zm-1.29 14.2h1.7L7.7 4.62H5.88l10.57 12.58Z"})})},tiktok:{label:"TikTok",prefix:"https://www.tiktok.com/@",bg:"#000000",textColor:"#ffffff",icon:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M20 5.13c-.78.02-1.52-.2-2.17-.62-.64-.41-1.13-1-1.4-1.7l-2.3-.03v11.16a2.22 2.22 0 1 1-2-2.2V9.54a5.22 5.22 0 1 0 4.57 7.73 5.19 5.19 0 0 0 .75-2.72V9.2c.74.53 1.63.83 2.55.83V5.13Z"})})},snapchat:{label:"Snapchat",prefix:"https://www.snapchat.com/add/",bg:"#FFFC00",textColor:"#000000",icon:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M12 2c2.74 0 5.12 1.83 5.6 4.58.06.31.09.63.09.95 0 1.44-.22 2.92-.64 4.27-.23.74.2 1.52.97 1.73a5 5 0 0 0 1.23.13c.37 0 .67.3.67.66 0 .37-.3.67-.67.67-.43 0-.85-.04-1.27-.13-.52-.11-1.02.26-1.09.78-.07.44-.22.87-.45 1.26a3.66 3.66 0 0 1-3.16 1.78c-.59 0-1.17-.13-1.7-.37-.36-.16-.76-.16-1.12 0-.53.24-1.11.37-1.7.37-1.34 0-2.52-.68-3.16-1.78a3.6 3.6 0 0 1-.45-1.26c-.07-.52-.57-.89-1.09-.78-.42.09-.84.13-1.27.13-.37 0-.67-.3-.67-.67 0-.36.3-.66.67-.66.42 0 .84-.04 1.23-.13.77-.21 1.2-.99.97-1.73a16.76 16.76 0 0 1-.64-4.27c0-.32.03-.64.09-.95C6.88 3.83 9.26 2 12 2Z"})})},youtube:{label:"YouTube",prefix:"https://youtube.com/",bg:"#FF0000",textColor:"#ffffff",icon:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M21.6 7.2c-.2-.92-.96-1.64-1.88-1.74C18.25 5.2 12 5.2 12 5.2s-6.25 0-7.72.26c-.92.1-1.68.82-1.88 1.74-.27 1.52-.27 4.68-.27 4.68s0 3.16.27 4.68c.2.92.96 1.64 1.88 1.74 1.47.26 7.72.26 7.72.26s6.25 0 7.72-.26c.92-.1 1.68-.82 1.88-1.74.27-1.52.27-4.68.27-4.68s0-3.16-.27-4.68ZM10 15.5V8.5l6 3.5-6 3.5Z"})})},reddit:{label:"Reddit",prefix:"https://reddit.com/u/",bg:"#FF4500",textColor:"#ffffff",icon:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M12 2a1 1 0 0 1 .98.8l.38 1.9c1.82.08 3.5.47 4.78 1.08l.76-.78a1 1 0 1 1 1.44 1.38l-.7.72c1.31.94 2.08 2.14 2.08 3.47 0 1.43-.88 2.7-2.32 3.64.15.45.24.93.24 1.41 0 3.08-3.33 5.58-7.64 5.58-4.32 0-7.64-2.5-7.64-5.58 0-.48.08-.96.24-1.41C3.88 13 3 11.73 3 10.3c0-3.2 3.62-5.26 8.4-5.26.2 0 .39 0 .58.01l-.3-1.56A1 1 0 0 1 12 2Zm-4 8a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Zm8 0a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Zm-7.28 4.88a.75.75 0 1 0-.94 1.16C9.5 17.22 10.7 17.7 12 17.7s2.5-.48 3.22-.66a.75.75 0 1 0-.38-1.46c-.58.15-1.6.46-2.84.46s-2.26-.31-2.84-.46Z"})})},discord:{label:"Discord",prefix:"",bg:"#5865F2",textColor:"#ffffff",icon:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M20.32 4.37A18 18 0 0 0 15.52 3l-.23.25c1.7.43 3.17 1.06 4.44 1.9-1.94-.9-3.83-1.34-5.68-1.34A17.2 17.2 0 0 0 8.48 5c-.3.15-.58.3-.86.46-.1.06-.2.12-.3.18-.06.04-.12.08-.18.12h-.02c-.1.07-.2.14-.3.2-.07.05-.14.1-.2.15a.37.37 0 0 0-.03.03C4.87 7.65 4 10.04 4 12.68c0 0 1.16 2.06 4.2 2.16a3 3 0 0 1-.75-1.4c.41.32 1.03.7 1.98.82-.87-.37-1.4-.91-1.72-1.46.4.28.93.55 1.58.74.65.2 1.3.34 1.85.43.55.1 1.02.14 1.3.14h.3c.18 0 .5-.05.88-.12.38-.07.82-.17 1.27-.28.46-.12.94-.27 1.42-.45.49-.18.94-.4 1.39-.64-.26.5-.77 1.06-1.63 1.46.94-.12 1.56-.5 1.98-.82-.16.57-.4 1-.75 1.4 3.04-.1 4.2-2.16 4.2-2.16 0-2.64-.87-5.03-2.78-7.02Z"})})}},ke=()=>{if(typeof window>"u")return"#/enter";const{origin:l,pathname:h}=window.location,t=h.includes("masterbartendingchampionship")?"/masterbartendingchampionship":"";return`${l}${t}/#/enter`},Ce=({bartenderId:l,bartenderName:h,leaderboardEntry:t={}})=>{const[v,f]=m.useState([]),[g,n]=m.useState(!0),[L,S]=m.useState(null),[P,R]=m.useState((t==null?void 0:t.publicProfileSlug)||null),r=i=>i===1?e.jsx("div",{className:"medal-icon medal-gold",children:"1"}):i===2?e.jsx("div",{className:"medal-icon medal-silver",children:"2"}):i===3?e.jsx("div",{className:"medal-icon medal-bronze",children:"3"}):`#${i}`,c=i=>{const b="modal-profile-card";return i===1?`${b} rank-1 bg-gradient-to-r from-yellow-900/20 to-yellow-800/10`:i===2?`${b} rank-2 bg-gradient-to-r from-gray-700/20 to-gray-600/10`:i===3?`${b} rank-3 bg-gradient-to-r from-orange-900/20 to-orange-800/10`:`${b} bg-zinc-800/80 border border-zinc-700`},N=i=>i===1?e.jsx("div",{className:"milestone-sticker gold",children:e.jsxs("div",{children:[e.jsx("div",{children:"ðŸ†"}),e.jsx("div",{children:"TOP"})]})}):i===2?e.jsx("div",{className:"milestone-sticker silver",children:e.jsxs("div",{children:[e.jsx("div",{children:"ðŸ¥ˆ"}),e.jsx("div",{children:"2ND"})]})}):i===3?e.jsx("div",{className:"milestone-sticker bronze",children:e.jsxs("div",{children:[e.jsx("div",{children:"ðŸ¥‰"}),e.jsx("div",{children:"3RD"})]})}):null;m.useEffect(()=>{(async()=>{if(!l){n(!1),S("Bartender ID is missing.");return}n(!0),S(null),ee.debug(`Fetching history for bartender ID: ${l}`);try{const{data:b,error:j}=await te.from("legacy_results").select(`placement,
             post_competition_rating,
             pre_competition_rating,
             legacy_competition_id,
             legacy_competitions!fk_lr_competition (
               id,
               name,
               date
             )`).eq("bartender_id",l).order("date",{ascending:!1,foreignTable:"legacy_competitions"});if(j)throw j;oe.enableProfilePages,ee.debug("Fetched competition history",{bartenderId:l,resultCount:b==null?void 0:b.length}),f(b||[])}catch(b){ee.error("Error fetching competition history:",{bartenderId:l,error:b}),S(`Failed to load competition history: ${b.message}. Please try again.`)}finally{n(!1)}})()},[l]),m.useEffect(()=>{R((t==null?void 0:t.publicProfileSlug)||null)},[t==null?void 0:t.publicProfileSlug]);const M=(i,b)=>i==null||b==null?"?":Math.round(b-i),u=(t==null?void 0:t.socialHandles)||{},x=Object.entries(u).some(([,i])=>!!i),w=t==null?void 0:t.profileImageUrl,a=!!(t!=null&&t.isProfileClaimed),T=(()=>{const i=[];return t!=null&&t.hasLegacyResults&&(t!=null&&t.legacyRanking)&&i.push(t.legacyRanking),t!=null&&t.hasSpeedResults&&(t!=null&&t.speedRanking)&&i.push(t.speedRanking),t!=null&&t.hasFlairResults&&(t!=null&&t.flairRanking)&&i.push(t.flairRanking),t!=null&&t.hasTraditionalResults&&(t!=null&&t.traditionalRanking)&&i.push(t.traditionalRanking),i.length>0?Math.min(...i):null})();return P&&re.generatePublicProfileUrl(P),e.jsxs("div",{className:"competition-history-content max-h-[70vh] overflow-y-auto pr-2",children:[e.jsxs("div",{className:`mb-4 p-4 rounded-lg ${c(T)}`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"h-16 w-16 rounded-full overflow-hidden border border-gray-600 flex items-center justify-center bg-zinc-700",children:w?e.jsx("img",{src:w,alt:`${h} profile`,className:"h-full w-full object-cover"}):Ne}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-semibold",children:h}),(t==null?void 0:t.hasLegacyResults)&&typeof(t==null?void 0:t.legacyRating)=="number"&&e.jsxs("p",{className:"text-sm text-gray-300",children:["Legacy Rating: ",Math.round(t.legacyRating)]}),(t==null?void 0:t.hasLegacyResults)&&(t==null?void 0:t.legacyRanking)&&e.jsxs("p",{className:"text-sm text-gray-400 flex items-center gap-2",children:["Legacy Ranking: ",r(t.legacyRanking)]}),(t==null?void 0:t.hasSpeedResults)&&typeof(t==null?void 0:t.speedRating)=="number"&&e.jsxs("p",{className:"text-sm text-gray-300",children:["Speed Rating: ",Math.round(t.speedRating)]}),(t==null?void 0:t.hasSpeedResults)&&(t==null?void 0:t.speedRanking)&&e.jsxs("p",{className:"text-sm text-gray-400 flex items-center gap-2",children:["Speed Ranking: ",r(t.speedRanking)]}),(t==null?void 0:t.hasFlairResults)&&typeof(t==null?void 0:t.flairRating)=="number"&&e.jsxs("p",{className:"text-sm text-gray-300",children:["Flair Rating: ",Math.round(t.flairRating)]}),(t==null?void 0:t.hasFlairResults)&&(t==null?void 0:t.flairRanking)&&e.jsxs("p",{className:"text-sm text-gray-400 flex items-center gap-2",children:["Flair Ranking: ",r(t.flairRanking)]}),(t==null?void 0:t.hasTraditionalResults)&&typeof(t==null?void 0:t.traditionalRating)=="number"&&e.jsxs("p",{className:"text-sm text-gray-300",children:["Traditional Rating: ",Math.round(t.traditionalRating)]}),(t==null?void 0:t.hasTraditionalResults)&&(t==null?void 0:t.traditionalRanking)&&e.jsxs("p",{className:"text-sm text-gray-400 flex items-center gap-2",children:["Traditional Ranking: ",r(t.traditionalRanking)]})]})]}),T&&T<=3&&e.jsx("div",{className:"flex-shrink-0",children:N(T)})]}),e.jsx("div",{className:"mt-4 grid gap-3 sm:grid-cols-2",children:x?Object.entries(u).map(([i,b])=>{if(!b)return null;const j=ye[i];if(!j)return null;const _=j.prefix?`${j.prefix}${b}`:null,$=_?{as:"a",href:_,target:"_blank",rel:"noopener noreferrer"}:{};return e.jsxs("a",{...$,className:"group relative block overflow-hidden rounded-lg border border-transparent transition-all duration-200 ease-out transform hover:-translate-y-1 hover:shadow-2xl focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white active:scale-95",style:{background:j.bg,color:j.textColor},children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-3 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium drop-shadow-sm",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-black/20 text-white",children:j.icon}),e.jsx("span",{children:j.label})]}),e.jsx("span",{className:"text-sm font-semibold truncate max-w-[50%] text-right drop-shadow-sm",children:b})]}),e.jsx("span",{className:"pointer-events-none absolute inset-0 opacity-0 group-hover:opacity-20 bg-white transition-opacity duration-200"})]},i)}):null}),!a&&e.jsxs("div",{className:"mt-4 space-y-3 rounded-lg border border-amber-500/60 bg-amber-500/10 p-4 text-amber-100",children:[e.jsx("p",{className:"text-sm",children:"This profile hasnâ€™t been claimed yet. Claim it to add socials, a profile image, and keep your details up to date."}),e.jsx("a",{href:ke(),className:"inline-flex items-center justify-center rounded-md bg-amber-500 px-4 py-2 text-sm font-semibold text-black transition-colors duration-150 hover:bg-amber-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-amber-200",children:"Claim Your Profile"})]})]}),!1,g?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx("div",{className:"animate-spin h-6 w-6 border-4 border-white rounded-full border-t-transparent"}),e.jsx("span",{className:"ml-3 text-gray-300",children:"Loading history..."})]}):L?e.jsx("div",{className:"text-red-400 p-4 text-center bg-black/50 rounded border border-red-500",children:L}):v.length===0?e.jsxs("div",{className:"text-gray-400 p-6 text-center italic",children:["No competition history found for ",h,"."]}):e.jsxs("table",{className:"competition-history-table min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Competition"}),e.jsx("th",{className:"text-center",children:"Placement"}),e.jsx("th",{className:"text-center",children:"Rating Change"})]})}),e.jsx("tbody",{children:v.map((i,b)=>{var z,s,o;const j=M(i.pre_competition_rating,i.post_competition_rating),_=(z=i.legacy_competitions)!=null&&z.date?new Date(i.legacy_competitions.date).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"}):"Unknown Date",$=j==="?"?"text-gray-400":j>0?"text-white":"text-gray-400",y=(s=i.legacy_competitions)!=null&&s.id?`${i.legacy_competitions.id}-${b}`:b;return e.jsxs("tr",{className:"even:bg-zinc-800 odd:bg-gradient-to-b from-zinc-800 to-zinc-900",children:[e.jsx("td",{className:"text-sm text-gray-300 whitespace-nowrap",children:_}),e.jsx("td",{className:"text-sm text-white",children:((o=i.legacy_competitions)==null?void 0:o.name)||"Unknown Competition"}),e.jsx("td",{className:"text-sm text-center text-gray-300",children:i.placement||"N/A"}),e.jsx("td",{className:`text-sm text-center font-medium ${$}`,children:j>=0?`+${j}`:j})]},y)})})]})]})},_e={instagram:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-3.5 h-3.5",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M7 2C4.24 2 2 4.24 2 7v10c0 2.76 2.24 5 5 5h10c2.76 0 5-2.24 5-5V7c0-2.76-2.24-5-5-5H7zm0 2h10c1.66 0 3 1.34 3 3v10c0 1.66-1.34 3-3 3H7c-1.66 0-3-1.34-3-3V7c0-1.66 1.34-3 3-3zm5 2.5A4.5 4.5 0 0 0 7.5 11 4.5 4.5 0 0 0 12 15.5 4.5 4.5 0 0 0 16.5 11 4.5 4.5 0 0 0 12 6.5zm0 2A2.5 2.5 0 0 1 14.5 11 2.5 2.5 0 0 1 12 13.5 2.5 2.5 0 0 1 9.5 11 2.5 2.5 0 0 1 12 8.5zm5.25-3a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5z"})}),facebook:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-3.5 h-3.5",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M22 12.07C22 6.55 17.52 2 12 2S2 6.55 2 12.07c0 5 3.66 9.14 8.44 9.93v-7.03H7.9V12.1h2.54V9.86c0-2.5 1.5-3.89 3.8-3.89 1.1 0 2.24.2 2.24.2v2.46H15.7c-1.24 0-1.62.77-1.62 1.56v1.9h2.76l-.44 2.87h-2.32V22c4.78-.79 8.44-4.93 8.44-9.93"})}),linkedin:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-3.5 h-3.5",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M4.98 3.5a2.25 2.25 0 1 1 0 4.5 2.25 2.25 0 0 1 0-4.5zM3.5 9h2.95v12H3.5zM9 9h2.83v1.64h.04c.39-.74 1.35-1.52 2.78-1.52 2.98 0 3.53 1.96 3.53 4.51V21H15v-5.38c0-1.28-.02-2.93-1.79-2.93-1.79 0-2.07 1.4-2.07 2.84V21H9z"})}),x:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-3.5 h-3.5",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M17.74 3H20l-5.26 6 6.4 9H16.3L12.7 13.9 8.6 18H6.26l5.44-6.2L5.6 3h5.54l3.26 4.83L17.74 3Zm-1.29 14.2h1.7L7.7 4.62H5.88l10.57 12.58Z"})}),tiktok:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-3.5 h-3.5",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M20 5.13c-.78.02-1.52-.2-2.17-.62-.64-.41-1.13-1-1.4-1.7l-2.3-.03v11.16a2.22 2.22 0 1 1-2-2.2V9.54a5.22 5.22 0 1 0 4.57 7.73 5.19 5.19 0 0 0 .75-2.72V9.2c.74.53 1.63.83 2.55.83V5.13Z"})}),snapchat:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-3.5 h-3.5",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M12 2c2.74 0 5.12 1.83 5.6 4.58.06.31.09.63.09.95 0 1.44-.22 2.92-.64 4.27-.23.74.2 1.52.97 1.73a5 5 0 0 0 1.23.13c.37 0 .67.3.67.66 0 .37-.3.67-.67.67-.43 0-.85-.04-1.27-.13-.52-.11-1.02.26-1.09.78-.07.44-.22.87-.45 1.26a3.66 3.66 0 0 1-3.16 1.78c-.59 0-1.17-.13-1.7-.37-.36-.16-.76-.16-1.12 0-.53.24-1.11.37-1.7.37-1.34 0-2.52-.68-3.16-1.78a3.6 3.6 0 0 1-.45-1.26c-.07-.52-.57-.89-1.09-.78-.42.09-.84.13-1.27.13-.37 0-.67-.3-.67-.67 0-.36.3-.66.67-.66.42 0 .84-.04 1.23-.13.77-.21 1.2-.99.97-1.73a16.76 16.76 0 0 1-.64-4.27c0-.32.03-.64.09-.95C6.88 3.83 9.26 2 12 2Z"})}),youtube:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-3.5 h-3.5",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M21.6 7.2c-.2-.92-.96-1.64-1.88-1.74C18.25 5.2 12 5.2 12 5.2s-6.25 0-7.72.26c-.92.1-1.68.82-1.88 1.74-.27 1.52-.27 4.68-.27 4.68s0 3.16.27 4.68c.2.92.96 1.64 1.88 1.74 1.47.26 7.72.26 7.72.26s6.25 0 7.72-.26c.92-.1 1.68-.82 1.88-1.74.27-1.52.27-4.68.27-4.68s0-3.16-.27-4.68ZM10 15.5V8.5l6 3.5-6 3.5Z"})}),reddit:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-3.5 h-3.5",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M12 2a1 1 0 0 1 .98.8l.38 1.9c1.82.08 3.5.47 4.78 1.08l.76-.78a1 1 0 1 1 1.44 1.38l-.7.72c1.31.94 2.08 2.14 2.08 3.47 0 1.43-.88 2.7-2.32 3.64.15.45.24.93.24 1.41 0 3.08-3.33 5.58-7.64 5.58-4.32 0-7.64-2.5-7.64-5.58 0-.48.08-.96.24-1.41C3.88 13 3 11.73 3 10.3c0-3.2 3.62-5.26 8.4-5.26.2 0 .39 0 .58.01l-.3-1.56A1 1 0 0 1 12 2Zm-4 8a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Zm8 0a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Zm-7.28 4.88a.75.75 0 1 0-.94 1.16C9.5 17.22 10.7 17.7 12 17.7s2.5-.48 3.22-.66a.75.75 0 1 0-.38-1.46c-.58.15-1.6.46-2.84.46s-2.26-.31-2.84-.46Z"})}),discord:e.jsx("svg",{viewBox:"0 0 24 24",className:"w-3.5 h-3.5",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M20.32 4.37A18 18 0 0 0 15.52 3l-.23.25c1.7.43 3.17 1.06 4.44 1.9-1.94-.9-3.83-1.34-5.68-1.34A17.2 17.2 0 0 0 8.48 5c-.3.15-.58.3-.86.46-.1.06-.2.12-.3.18-.06.04-.12.08-.18.12h-.02c-.1.07-.2.14-.3.2-.07.05-.14.1-.2.15a.37.37 0 0 0-.03.03C4.87 7.65 4 10.04 4 12.68c0 0 1.16 2.06 4.2 2.16a3 3 0 0 1-.75-1.4c.41.32 1.03.7 1.98.82-.87-.37-1.4-.91-1.72-1.46.4.28.93.55 1.58.74.65.2 1.3.34 1.85.43.55.1 1.02.14 1.3.14h.3c.18 0 .5-.05.88-.12.38-.07.82-.17 1.27-.28.46-.12.94-.27 1.42-.45.49-.18.94-.4 1.39-.64-.26.5-.77 1.06-1.63 1.46.94-.12 1.56-.5 1.98-.82-.16.57-.4 1-.75 1.4 3.04-.1 4.2-2.16 4.2-2.16 0-2.64-.87-5.03-2.78-7.02Z"})})},Se=({subdued:l=!1,className:h="h-full w-full"}={})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,className:`${h} ${l?"text-gray-700":"text-gray-400"}`,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.121 17.804A9.969 9.969 0 0112 15c2.387 0 4.58.834 6.364 2.197M15 7a3 3 0 11-6 0 3 3 0 016 0z"})});function G({id:l,title:h,type:t,data:v=[],page:f,filter:g,onPageChange:n,onFilterChange:L,showFilters:S=!1,showClaimButton:P=!1,hasPendingClaim:R=!1,comingSoon:r=!1,onClaimProfileClick:c,onSubmitResultClick:N,onOpenSocialDrop:M}){const[u,x]=m.useState(""),[w,a]=m.useState(!1),[p,T]=m.useState(null),i=u.trim()?v.filter(C=>C.name.toLowerCase().includes(u.toLowerCase())):v,b=10,j=f*b,_=i.slice(j,j+b),$=C=>{T(C),a(!0)},y=()=>{T(null),a(!1)},z=C=>{x(C.target.value),f!==0&&n(t,0)},s=()=>x(""),o="px-4 py-2 rounded border transition-colors duration-200",k=`${o} bg-white text-black border-white hover:bg-zinc-200 hover:border-gray-200`,A=`${o} bg-transparent text-white border-gray-500 hover:bg-zinc-700`,q=`${o} bg-white text-black border-white`,V=C=>C===1?e.jsx("div",{className:"medal-icon medal-gold",children:"1"}):C===2?e.jsx("div",{className:"medal-icon medal-silver",children:"2"}):C===3?e.jsx("div",{className:"medal-icon medal-bronze",children:"3"}):C,J=C=>C===1?"rank-1":C===2?"rank-2":C===3?"rank-3":"";return e.jsxs("div",{id:l,className:`leaderboard-container ${r?"coming-soon":""} mb-12`,children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:h}),!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"search-container mb-4",children:[e.jsxs("div",{className:"relative w-full sm:w-1/4",children:[e.jsx("input",{type:"text",placeholder:"// search...",value:u,onChange:z,className:"w-full p-2 pl-10 bg-zinc-700 text-white rounded border border-gray-600 focus:border-gray-500 focus:outline-none"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:`M8 4a4 4 0 100 8 4 4 0 000-8zM2 
                       8a6 6 0 1110.89 3.476l4.817
                       4.817a1 1 0 01-1.414 
                       1.414l-4.816-4.816A6 6 0 012 8z`,clipRule:"evenodd"})})}),u&&e.jsx("button",{className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-white",onClick:s,children:e.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:`M10 18a8 8 0 100-16 8 8 0 000 
                         16zM8.707 7.293a1 1 0 00-1.414 
                         1.414L8.586 10l-1.293 1.293a1 1 
                         0 101.414 1.414L10 11.414l1.293 
                         1.293a1 1 0 001.414-1.414L11.414 
                         10l1.293-1.293a1 1 0 00-1.414-1.414L10 
                         8.586 8.707 7.293z`,clipRule:"evenodd"})})})]}),u&&i.length===0?e.jsxs("p",{className:"text-gray-400 text-sm mt-2",children:["No results for â€œ",u,"â€"]}):u?e.jsxs("p",{className:"text-gray-400 text-sm mt-2",children:["Found ",i.length," ",i.length===1?"result":"results"]}):null]}),e.jsxs("div",{className:"button-container flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[S&&e.jsx("div",{className:"filter-buttons flex gap-2",children:e.jsx("button",{className:g==="rating"?q:A,onClick:()=>L(t,"rating"),children:"Rating"})}),t==="legacy"&&e.jsxs("div",{className:"action-buttons flex gap-2",children:[P&&c&&(R?e.jsx("button",{className:`${k} bg-zinc-600 text-gray-400 border-gray-600 cursor-not-allowed opacity-70`,disabled:!0,children:"Claim Pending"}):e.jsx("button",{className:k,onClick:c,children:"Claim Profile"})),M&&e.jsx("button",{className:k,onClick:M,children:"Socials"}),N&&e.jsx("button",{className:k,onClick:N,children:"Submit Result"})]})]})]}),e.jsxs("div",{className:"leaderboard-content",children:[e.jsx(we,{data:i,type:t,filter:g,currentPage:f,onPageChange:C=>n(t,C),searchActive:!!u.trim(),onHistoryClick:$}),e.jsxs("div",{className:"record-cards",children:[_.map((C,U)=>{const d=C.socialHandles?Object.entries(C.socialHandles).filter(([,D])=>!!D):[],B=d.slice(0,2),F=d.length>2,O=C.ranking||(u.trim()?U+1:j+U+1);return e.jsxs("div",{className:`record-card group ${J(O)}`,onClick:()=>$(C),role:"button",tabIndex:0,onKeyPress:D=>D.key==="Enter"&&$(C),children:[e.jsx("div",{className:"rank",children:V(O)}),e.jsx("div",{className:"pic",children:e.jsx("div",{className:"profile-pic",children:C.profileImageUrl?e.jsx("img",{src:C.profileImageUrl,alt:`${C.name} profile`,className:"h-full w-full rounded-full object-cover"}):Se({subdued:!C.isProfileClaimed})})}),e.jsxs("div",{className:"info",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"name",children:C.name}),B.length>0&&e.jsxs("div",{className:"flex items-center gap-1 ml-1",children:[B.map(([D])=>e.jsx("span",{className:"inline-flex items-center justify-center opacity-60",style:{width:"12px",height:"12px"},children:ae.cloneElement(_e[D],{className:"w-3 h-3"})},D)),F&&e.jsx("span",{className:"text-xs text-gray-300 opacity-60",children:"â€¦"})]})]}),e.jsx("div",{className:"rating",children:Math.round(C.rating||0)})]}),e.jsx("span",{className:"ml-auto inline-flex items-center text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity duration-150",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:"w-4 h-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})})]},C.id||U)}),e.jsxs("div",{className:"pagination-row",children:[j>0&&e.jsx("button",{className:"pagination-button",onClick:()=>n(t,f-1),children:"PreviousÂ 10"}),j+b<i.length&&e.jsx("button",{className:"pagination-button",onClick:()=>n(t,f+1),children:"NextÂ 10"})]})]})]}),e.jsx(Q,{isOpen:w,onClose:y,title:`${(p==null?void 0:p.name)||"Bartender"}'s Competition History`,maxWidth:"max-w-4xl",children:p&&e.jsx(Ce,{bartenderId:p.id,bartenderName:p.name,leaderboardEntry:p})})]})}const Z=he("ClaimForm"),Re=({onSuccess:l,onError:h})=>{const[t,v]=m.useState(null),[f,g]=m.useState(!1),[n,L]=m.useState(null),[S,P]=m.useState(!1),[R,r]=m.useState(null);m.useEffect(()=>{c()},[]);const c=async()=>{try{g(!0);const{data:{user:u}}=await I.auth.getUser();if(!u)return;const{data:x,error:w}=await I.from("submissions").select("id, status, content").eq("user_id",u.id).eq("status","pending").like("content",'%"type":"profile_claim"%').maybeSingle();if(w&&w.code!=="PGRST116")throw w;if(x){Z.info("Found existing pending claim",{submissionId:x.id}),L(x);return}const{data:a,error:p}=await I.from("bartenders").select("id, is_profile_claimed").eq("user_id",u.id).single();if(p&&p.code!=="PGRST116")throw p;a!=null&&a.is_profile_claimed&&(Z.info("User already has a claimed profile",{bartenderId:a.id}),l==null||l({alreadyClaimed:!0}))}catch(u){Z.error("Error checking existing claim:",u),r(u.message),h==null||h(u.message)}finally{g(!1)}},N=async u=>{u.preventDefault(),g(!0),r(null),P(!1);try{const{data:{user:x}}=await I.auth.getUser();if(!x)throw new Error("Authentication required");if(!t)throw new Error("Please select a bartender profile");const{data:w,error:a}=await I.from("bartenders").select("is_profile_claimed, users_attempting_to_claim").eq("id",t.id).single();if(a)throw a;if(w!=null&&w.is_profile_claimed)throw new Error("This profile has already been claimed");const p=w.users_attempting_to_claim||[];if(!p.includes(x.id)){const{error:i}=await I.from("bartenders").update({users_attempting_to_claim:[...p,x.id]}).eq("id",t.id);if(i)throw i}const{error:T}=await I.from("submissions").insert({user_id:x.id,content:JSON.stringify({type:"profile_claim",bartender_id:t.id,bartender_name:t.full_name,submitted_at:new Date().toISOString()}),status:"pending"});if(T)throw T;P(!0),Z.info("Profile claim submitted successfully",{userId:x.id,bartenderId:t.id}),setTimeout(()=>{l==null||l()},2e3)}catch(x){r(x.message),h==null||h(x.message),Z.error("Error submitting profile claim:",x)}finally{g(!1)}},M=async()=>{if(n){g(!0);try{const{data:{user:u}}=await I.auth.getUser();if(!u)throw new Error("Authentication required");let x=null;try{x=JSON.parse(n.content).bartender_id}catch(a){Z.error("Error parsing claim content:",a)}if(x){const{data:a}=await I.from("bartenders").select("users_attempting_to_claim").eq("id",x).single();if(a){const p=(a.users_attempting_to_claim||[]).filter(T=>T!==u.id);await I.from("bartenders").update({users_attempting_to_claim:p}).eq("id",x)}}const{error:w}=await I.from("submissions").update({status:"cancelled"}).eq("id",n.id);if(w)throw w;L(null),l==null||l({cancelled:!0}),Z.info("Claim cancelled successfully",{submissionId:n.id})}catch(u){r(u.message),h==null||h(u.message),Z.error("Error cancelling claim:",u)}finally{g(!1)}}};return n?e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl text-white mb-4",children:"Pending Profile Claim"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Your profile claim is currently under review by an administrator."}),e.jsx("button",{onClick:M,disabled:f,className:"w-full py-2 bg-white text-black font-bold rounded hover:bg-zinc-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Processing...":"Cancel Claim"})]}):e.jsxs("form",{onSubmit:N,className:"p-6",method:"POST",children:[e.jsx("h3",{className:"text-xl text-white mb-6",children:"Claim Your Profile"}),R&&e.jsx("div",{className:"error-message mb-4 p-3 bg-red-500/20 border border-red-500 rounded text-red-200",children:R}),S&&e.jsx("div",{className:"success-message mb-4 p-3 bg-green-500/20 border border-green-500 rounded text-green-200",children:"Profile claim submitted successfully! Your claim will be reviewed by an administrator."}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-white mb-2",children:"Select Your Profile"}),e.jsx(ge,{onSelect:v,placeholder:"Search for your profile",unclaimedOnly:!0})]}),e.jsx("button",{type:"submit",disabled:f||!t||S,className:"w-full py-3 bg-white text-black font-bold rounded hover:bg-zinc-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Submitting...":"Submit Claim"})]})},Y=[{key:"instagram",label:"Instagram",helper:"instagram.com/",supabaseKey:"instagramHandle"},{key:"facebook",label:"Facebook",helper:"facebook.com/",supabaseKey:"facebookHandle"},{key:"linkedin",label:"LinkedIn",helper:"linkedin.com/in/",supabaseKey:"linkedinHandle"},{key:"x",label:"X (Twitter)",helper:"x.com/",supabaseKey:"xHandle"},{key:"tiktok",label:"TikTok",helper:"tiktok.com/@",supabaseKey:"tiktokHandle"},{key:"snapchat",label:"Snapchat",helper:"snapchat.com/add/",supabaseKey:"snapchatHandle"},{key:"youtube",label:"YouTube",helper:"youtube.com/",supabaseKey:"youtubeHandle"},{key:"reddit",label:"Reddit",helper:"reddit.com/u/",supabaseKey:"redditHandle"},{key:"discord",label:"Discord",helper:"username#1234",supabaseKey:"discordHandle"}],Le=l=>l.replace(/^@/,"").trim(),Me=({isOpen:l,onClose:h,bartenderId:t,bartenderName:v="Your Profile",isProfileClaimed:f=!1,onSaved:g})=>{const{profile:n,loading:L,updating:S,updateProfile:P,uploadImage:R,refresh:r}=ce(l?t:null),[c,N]=m.useState(()=>Object.fromEntries(Y.map(({key:y})=>[y,""]))),[M,u]=m.useState(null),[x,w]=m.useState(null),[a,p]=m.useState(""),[T,i]=m.useState(""),b=m.useMemo(()=>{var y;return((y=n==null?void 0:n.profile)==null?void 0:y.profile_image_url)||null},[n]);if(m.useEffect(()=>{if(!(n!=null&&n.profile))return;const y={};Y.forEach(({key:z,supabaseKey:s})=>{const o=s.replace("Handle","_handle");y[z]=n.profile[o]||""}),N(y)},[n==null?void 0:n.profile]),m.useEffect(()=>{if(!M)return()=>{};const y=URL.createObjectURL(M);return w(y),()=>URL.revokeObjectURL(y)},[M]),!l)return null;const j=(y,z)=>{const{value:s}=y.target;N(o=>({...o,[z]:s}))},_=y=>{var s;const z=(s=y.target.files)==null?void 0:s[0];if(!z){u(null),w(null);return}u(z)},$=async y=>{if(y.preventDefault(),p(""),i(""),!t||!f){i("Only claimed profiles can use the Social Drop feature.");return}const z={};Y.forEach(({key:s,supabaseKey:o})=>{const k=Le(c[s]||"");z[o]=k||null});try{M&&await R(M,"profile"),await P(z),await r(),p("Profile updated successfully."),g&&g()}catch(s){i((s==null?void 0:s.message)||"Unable to save changes.");return}u(null),w(null),h()};return e.jsx(Q,{isOpen:l,onClose:()=>{u(null),w(null),i(""),p(""),h()},title:`${v} â€“ Social Drop`,maxWidth:"max-w-3xl",children:e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[!f&&e.jsx("div",{className:"p-3 border border-amber-500 bg-amber-500/10 text-amber-200 rounded",children:"Claim your profile to unlock the Social Drop features."}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-[1fr_1fr]",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-2",children:"Profile Image"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-20 w-20 rounded-full overflow-hidden border border-gray-600 flex items-center justify-center bg-zinc-700",children:x?e.jsx("img",{src:x,alt:"Profile preview",className:"h-full w-full object-cover"}):b?e.jsx("img",{src:b,alt:"Current profile",className:"h-full w-full object-cover"}):e.jsx("span",{className:"text-gray-400 text-xs text-center px-2",children:"No image"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:_,className:"text-sm text-gray-300"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Upload a square image for best results. Existing image will be kept if you skip this step."})]})}),e.jsx("div",{className:"space-y-3",children:Y.map(({key:y,label:z,helper:s})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:z}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:s}),e.jsx("input",{type:"text",value:c[y]||"",onChange:o=>j(o,y),className:"flex-1 px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500",placeholder:"handle",disabled:!f})]})]},y))})]}),a&&e.jsx("div",{className:"p-3 border border-green-600 bg-green-600/10 text-green-200 rounded",children:a}),T&&e.jsx("div",{className:"p-3 border border-red-600 bg-red-600/10 text-red-200 rounded",children:T}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{u(null),w(null),i(""),p(""),h()},className:"px-4 py-2 rounded border border-gray-600 text-gray-300 hover:bg-zinc-700 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-white text-black hover:bg-zinc-200 disabled:opacity-60 disabled:cursor-not-allowed",disabled:S||L||!f,children:S?"Savingâ€¦":"Save Social Drop"})]})]})})},K=se("UpcomingCompetitions"),ie=()=>{const[l,h]=m.useState([]),[t,v]=m.useState(!0),[f,g]=m.useState(null),{isAuthenticated:n}=ne(),[L,S]=m.useState(!1);m.useEffect(()=>{const r=()=>{S(window.innerWidth<=768)};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),m.useEffect(()=>{(async()=>{v(!0),g(null),K.info("Fetching upcoming competitions data...");try{const c=new Date().toISOString().split("T")[0],{data:N,error:M}=await te.from("legacy_competitions").select("id, name, date, venue, country, category, status, more_info_link").gte("date",c).order("date",{ascending:!0}).limit(3);if(M)throw K.error("Error fetching upcoming competitions:",M),new Error(`Failed to fetch upcoming competitions: ${M.message}`);h(N||[]),K.debug(`Fetched ${(N==null?void 0:N.length)||0} upcoming competitions.`)}catch(c){K.error("Error in fetchCompetitions:",c),g(c.message)}finally{v(!1)}})()},[]);const P=r=>{let c="category-badge",N=r||"Legacy";switch(r==null?void 0:r.toLowerCase()){case"speed":c+=" bg-red-500 text-white",N="Speed";break;case"flair":c+=" bg-green-500 text-black",N="Flair";break;case"traditional":c+=" bg-blue-500 text-white",N="Traditional";break;default:c+=" bg-zinc-500 text-white";break}return e.jsx("span",{className:`${c} inline-block px-2 py-1 rounded text-xs font-medium`,children:N})},R=r=>e.jsxs("div",{className:"bg-zinc-800 p-4 rounded-lg shadow-md h-full flex flex-col",children:[e.jsx("div",{className:"event-date text-sm text-gray-400 mb-1",children:new Date(r.date).toLocaleDateString()}),e.jsx("h3",{className:"event-name text-white font-medium text-lg mb-2",children:r.name}),e.jsx("div",{className:"event-category mb-2",children:P(r.category)}),e.jsx("div",{className:"event-venue text-gray-300 mb-4",children:r.venue}),e.jsx("div",{className:"mt-auto pt-4 border-t border-zinc-700",children:e.jsx("a",{href:"https://airtable.com/appMQggH3bB7G8pRV/pagGsPtPvflViR9PC/form",target:"_blank",rel:"noopener noreferrer",className:`block w-full py-2 text-center rounded ${n?"bg-white text-black hover:bg-zinc-200":"bg-zinc-600 text-gray-300 cursor-not-allowed"}`,onClick:c=>!n&&c.preventDefault(),title:n?"Register for event":"Sign in to register",children:n?"Register":"Sign in to Register"})})]});return l.length===0&&!t?null:t?e.jsxs("div",{className:"upcoming-competitions mt-8 mb-4",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-white",children:"Upcoming Events"}),e.jsx("div",{className:"animate-pulse flex space-x-4",children:e.jsxs("div",{className:"flex-1 space-y-4 py-1",children:[e.jsx("div",{className:"h-12 bg-zinc-700 rounded"}),e.jsx("div",{className:"h-12 bg-zinc-700 rounded"})]})})]}):f?e.jsxs("div",{className:"upcoming-competitions mt-8 mb-4",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-white",children:"Upcoming Events"}),e.jsx("div",{className:"bg-red-900/20 border border-red-500 text-red-200 p-4 rounded-lg",children:"Error loading upcoming events."})]}):e.jsxs("div",{className:"upcoming-competitions mt-8 mb-4",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-white",children:"Upcoming Events"}),L&&e.jsx("div",{className:"md:hidden",children:e.jsx(fe,{events:l,renderEventCard:R,emptyMessage:"No upcoming events scheduled yet."})}),!L&&e.jsx("div",{className:"hidden md:block bg-zinc-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[e.jsx("thead",{className:"bg-zinc-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Event"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Location"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Register"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:l.map(r=>e.jsxs("tr",{className:"hover:bg-zinc-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-white",children:new Date(r.date).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm text-white",children:r.name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:P(r.category)}),e.jsx("td",{className:"px-4 py-3 text-sm text-white",children:r.venue}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("a",{href:"https://airtable.com/appMQggH3bB7G8pRV/pagGsPtPvflViR9PC/form",target:"_blank",rel:"noopener noreferrer",className:`px-3 py-1 rounded ${n?"bg-white text-black hover:bg-zinc-200":"bg-zinc-600 text-gray-300 cursor-not-allowed"}`,onClick:c=>!n&&c.preventDefault(),title:n?"Register for event":"Sign in to register",children:n?"Register":"Sign in to Register"})})]},r.id))})]})})]})},H=se("HomePage"),Be=()=>{var U;const[l,h]=m.useState({legacy:[],traditional:[],flair:[],speed:[]}),[t,v]=m.useState(!0),[f,g]=m.useState(null),[n,L]=m.useState("Loading Leaderboards..."),[S,P]=m.useState(null),{user:R,isAuthenticated:r,profile:c,loading:N}=ne(),[M,u]=m.useState(!1),[x,w]=m.useState({legacy:{page:0,filter:"rating"},speed:{page:0,filter:"rating"},traditional:{page:0,filter:"rating"},flair:{page:0,filter:"rating"}}),[a,p]=m.useState(!1),[T,i]=m.useState(!1),[b,j]=m.useState(!1),_=de(),$=me(),y=(U=_.state)==null?void 0:U.scrollTo;m.useEffect(()=>{(async()=>{if(!r||!R){u(!1);return}try{const{data:B,error:F}=await te.from("submissions").select("id, status").eq("user_id",R.id).eq("status","pending").contains("content",{type:"profile_claim"}).maybeSingle();if(F)throw F;u(!!B),H.debug("Pending claim check result:",{hasPendingClaim:!!B})}catch(B){H.error("Error checking pending claims:",B)}})()},[r,R]);const z=m.useCallback(async()=>{v(!0),g(null),H.info("Fetching leaderboard data...");try{const d=await be.fetchLeaderboardData();h({legacy:(d==null?void 0:d.legacy)||[],traditional:(d==null?void 0:d.traditional)||[],flair:(d==null?void 0:d.flair)||[],speed:(d==null?void 0:d.speed)||[]}),H.info("Leaderboard data fetched successfully")}catch(d){H.error("Error fetching leaderboard data:",d),d.message.includes("timeout")?g("Loading took longer than expected. The system is experiencing delays. Please try refreshing the page or contact support if this persists."):d.message.includes("session")?g("Authentication issue detected. Please try signing out and back in."):d.message.includes("network")||d.message.includes("fetch")?g("Network connectivity issue. Please check your internet connection and try again."):g("Failed to load leaderboard data. Please try refreshing the page or contact support if this issue persists."),h({legacy:[],traditional:[],flair:[],speed:[]}),H.error("Fetch error context:",{errorType:d.name,errorMessage:d.message,stack:d.stack,timestamp:new Date().toISOString()})}finally{v(!1)}},[]);m.useEffect(()=>{if(N){H.debug("Waiting for auth state to be ready before fetching data");return}H.debug("Auth state ready, proceeding with data fetch",{isAuthenticated:r,authLoading:N}),z()},[z,N,r]),m.useEffect(()=>{if(!t)return;L("Loading Leaderboards..."),P(null);const d=setTimeout(()=>{t&&(L("Loading Leaderboards... this is taking a while, give it"),P(15))},1e4);return()=>clearTimeout(d)},[t]),m.useEffect(()=>{if(S===null||!t)return;if(S===0){$("/error",{state:{message:"Loading took too long (25+ seconds). This may indicate a connectivity issue.",contact:"cocktails+mbc@trapadl.com"}});return}const d=setTimeout(()=>{P(B=>B-1)},1e3);return()=>clearTimeout(d)},[S,$,t]),m.useEffect(()=>{if(y){H.debug(`Scrolling to section: ${y}`);const d=document.getElementById(`${y}-section`),B=document.querySelector(".column-right");if(d&&B){const F=d.offsetTop,O=parseFloat(getComputedStyle(B).paddingTop||"0"),D=F-O;H.debug(`Target offsetTop: ${F}, Container padding: ${O}, Effective scroll: ${D}`);const X=setTimeout(()=>{B.scrollTo({top:D,behavior:"smooth"}),$(_.pathname,{replace:!0,state:{..._.state,scrollTo:null}})},150);return()=>clearTimeout(X)}else H.warn(`Scroll target #${y}-section or .column-right not found`),$(_.pathname,{replace:!0,state:{..._.state,scrollTo:null}})}},[y,_.pathname,_.state,$]);const s=(d,B)=>{w(D=>({...D,[d]:{...D[d],page:B}}));const F=document.getElementById(`${d}-section`),O=document.querySelector(".column-right");if(F&&O){const D=F.offsetTop,X=parseFloat(getComputedStyle(O).paddingTop||"0"),le=D-X;O.scrollTo({top:le,behavior:"smooth"})}},o=(d,B)=>{w(F=>({...F,[d]:{...F[d],filter:B,page:0}}))},k=()=>{if(!r){W("Please sign in or create an account to claim a profile."),$("/enter",{state:{from:_}});return}p(!0),H.info("Claim Profile modal opened")},A=()=>{if(!r){W("Please sign in or create an account to submit results."),$("/enter",{state:{from:_}});return}i(!0),H.info("Submit Result modal opened")},q=()=>{if(!r){W("Please sign in or create an account to update socials."),$("/enter",{state:{from:_}});return}if(!V){W("Claim your profile to unlock the Social Drop feature.");return}j(!0),H.info("Social Drop modal opened")},V=r&&(c==null?void 0:c.is_profile_claimed)===!0,J=r&&V,C=!V&&!M;return t||N?e.jsxs("div",{className:"flex flex-col justify-center items-center h-screen col-span-2",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-white rounded-full border-t-transparent"}),e.jsx("span",{className:"ml-4 text-gray-300",children:n})]}),S!==null&&e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:"text-yellow-400 font-bold text-lg",children:["[",S,"]"]}),e.jsx("span",{className:"text-gray-300 ml-2",children:"more seconds before calling it an issue"})]})]}):f?e.jsx("div",{className:"text-center p-10 text-red-400 col-span-2",children:f}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"column-left hidden md:flex",children:[" ",e.jsxs("div",{className:"column-left-content text-white p-8",children:[" ",e.jsx("div",{style:{height:"calc(100vh * 4 / 13)",minHeight:"200px",flexShrink:0}}),r&&c?e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Welcome, ",c.full_name||"Competitor","!"]}):e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"PROFESSIONAL BARTENDING. A NEW GLOBAL COMMUNITY."}),e.jsx("p",{className:"mb-4 text-gray-300",children:"Our goal is to transform one of the worlds oldest professions into a globally connected community by uniting bartenders, bars, and brands under one platform called Master Bartending."}),e.jsx("p",{className:"mb-4 text-gray-300",children:"This platform connects bartender profiles with each other and is structured by accomplishment, activity and ranking."}),e.jsx("p",{className:"mb-4 text-gray-300",children:"To add yourself to the leaderboard, click 'submit result'."}),e.jsx("p",{className:"mb-4 text-gray-300",children:"To find out more about our pillars and goals, click the about section of our site menu."}),e.jsx(ie,{}),e.jsxs("p",{className:"text-gray-400 text-sm mt-8",children:["This service is created and maintained by passionate bartenders out of ",e.jsx("a",{href:"http://www.trapadl.com",className:"text-white hover:text-gray-300",target:"_blank",rel:"noopener noreferrer",children:"trap. cocktail bar"})," in Adelaide, Australia. It's constantly undergoing improvements. Feedback, bug reports, or contribution inquiries are welcome via ",e.jsx("a",{href:"mailto:cocktails+mbc@trapadl.com",className:"text-white hover:text-gray-300",children:"cocktails+mbc@trapadl.com"}),"."]})]})]}),e.jsxs("div",{className:"block md:hidden p-4 text-white",children:[e.jsx("div",{style:{minHeight:"200px",flexShrink:0}}),r&&c?e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Welcome, ",c.full_name||"Competitor","!"]}):e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"PROFESSIONAL BARTENDING. A NEW GLOBAL COMMUNITY."}),e.jsx("p",{className:"mb-4 text-gray-300",children:"Our goal is to transform one of the worlds oldest professions into a globally connected community by uniting bartenders, bars, and brands under one platform called Master Bartending."}),e.jsx("p",{className:"mb-4 text-gray-300",children:"This platform connects bartender profiles with each other and is structured by accomplishment, activity and ranking."}),e.jsx("p",{className:"mb-4 text-gray-300",children:"To add yourself to the leaderboard, click 'submit result'."}),e.jsx("p",{className:"mb-4 text-gray-300",children:"To find out more about our pillars and goals, click the about section of our site menu."}),e.jsx(ie,{}),e.jsxs("p",{className:"text-gray-400 text-sm mt-8",children:["This service is created and maintained by passionate bartenders out of ",e.jsx("a",{href:"http://www.trapadl.com",className:"text-white hover:text-gray-300",target:"_blank",rel:"noopener noreferrer",children:"trap. cocktail bar"})," in Adelaide, Australia. It's constantly undergoing improvements. Feedback, bug reports, or contribution inquiries are welcome via ",e.jsx("a",{href:"mailto:cocktails+mbc@trapadl.com",className:"text-white hover:text-gray-300",children:"cocktails+mbc@trapadl.com"}),"."]})]}),e.jsxs("div",{className:"column-right w-full md:w-1/2",children:[" ",e.jsxs("div",{className:"column-right-content space-y-12 p-4 md:p-8 ",children:[" ",e.jsx(G,{id:"legacy-section",title:"Legacy Leaderboard",type:"legacy",data:l.legacy,page:x.legacy.page,filter:x.legacy.filter,onPageChange:s,onFilterChange:o,showFilters:!1,showClaimButton:C,hasPendingClaim:M,onClaimProfileClick:k,onSubmitResultClick:A,onOpenSocialDrop:J?q:void 0}),e.jsx(G,{id:"speed-section",title:"MBC Speed Leaderboard",type:"speed",data:l.speed,page:x.speed.page,filter:x.speed.filter,onPageChange:s,onFilterChange:o}),e.jsx(G,{id:"traditional-section",title:"MBC Traditional Leaderboard",type:"traditional",data:l.traditional,page:x.traditional.page,filter:x.traditional.filter,onPageChange:s,onFilterChange:o,comingSoon:!0}),e.jsx(G,{id:"flair-section",title:"MBC Flair Leaderboard",type:"flair",data:l.flair,page:x.flair.page,filter:x.flair.filter,onPageChange:s,onFilterChange:o,comingSoon:!0})]})]}),e.jsx(Q,{isOpen:a,onClose:()=>p(!1),title:"Claim Your Profile",children:e.jsx(Re,{onSuccess:()=>{H.info("Claim success callback triggered."),p(!1),u(!0),z()},onError:d=>H.error("Claim form error:",d)})}),e.jsx(Q,{isOpen:T,onClose:()=>i(!1),title:"Submit Competition Result",maxWidth:"max-w-2xl",children:e.jsx(xe,{onSuccess:()=>{H.info("Result success callback triggered."),i(!1),W("Result submitted for admin review!")},onError:d=>H.error("Result form error:",d)})}),e.jsx(Me,{isOpen:b,onClose:()=>j(!1),bartenderId:c==null?void 0:c.id,bartenderName:(c==null?void 0:c.full_name)||"Your Profile",isProfileClaimed:V,onSaved:z}),e.jsx("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 md:hidden z-50",children:e.jsx("button",{onClick:()=>{const d=document.querySelector(".column-right");d&&d.scrollIntoView({behavior:"smooth"})},className:"bg-black text-white px-6 py-3 rounded-full shadow-lg hover:bg-zinc-800 transition",children:"â†“ Leaderboards â†“"})})]})};export{Be as default};
