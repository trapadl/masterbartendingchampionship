import{r as x,e as Dt,C as rt,j as e,c as _e,s as we,g as Lt,h as Rt,a as zt,u as Pt,i as At,k as Mt,l as Wt,p as Ye,P as Bt,M as Ze}from"./main-Do236Ahx.js";import{O as yt}from"./OrganizerSelect-BXb4Y9_J.js";import{R as Ft}from"./ResultForm-CDLcb2dm.js";const Xe=_e("CitySelect"),ke=({value:L,onSelect:E,placeholder:z="Select or enter city",initialLabel:I="",className:v="",required:S=!1,disabled:C=!1})=>{const[k,M]=x.useState(I),[_,A]=x.useState(!1),[F,X]=x.useState(!1),[q,ie]=x.useState(null),{cities:B,searchCities:T,findOrCreateCity:H}=Dt(),K=x.useRef(null),G=x.useRef(null);x.useEffect(()=>{if(!k.trim())return;const P=setTimeout(async()=>{try{X(!0),ie(null),await T(k.trim())}catch(re){Xe.error("Search error:",re),ie("Failed to search cities")}finally{X(!1)}},300);return()=>clearTimeout(P)},[k,T]),x.useEffect(()=>{const P=re=>{K.current&&!K.current.contains(re.target)&&A(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]);const je=P=>{const re=P.target.value;M(re),A(!0),ie(null)},Ee=()=>{A(!0),k.trim()&&T(k.trim())},ze=P=>{const re=rt.formatCityName(P);M(re),A(!1),E(P),Xe.info("City selected",{cityId:P.id,cityName:re})},Z=async()=>{if(k.trim())try{X(!0),ie(null);const P=await H(k.trim()),re=rt.formatCityName(P);M(re),A(!1),E(P),Xe.info("New city created and selected",{cityId:P.id,cityName:re})}catch(P){Xe.error("Error creating new city:",P),ie("Failed to create city. Please try again.")}finally{X(!1)}},ce=P=>{P.key==="Escape"?A(!1):P.key==="Enter"&&!B.length&&k.trim()&&(P.preventDefault(),Z())};return x.useEffect(()=>{L&&typeof L=="object"?M(rt.formatCityName(L)):L&&typeof L=="string"&&M(L)},[L]),e.jsxs("div",{className:`relative ${v}`,ref:K,children:[e.jsx("input",{ref:G,type:"text",value:k,onChange:je,onFocus:Ee,onKeyDown:ce,placeholder:z,required:S,disabled:C,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"}),_&&(k.trim()||F||q)&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-md border border-gray-300 shadow-lg max-h-60 overflow-y-auto",children:[F&&e.jsxs("div",{className:"p-3 text-gray-500 text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2",children:"Searching cities..."})]}),q&&e.jsx("div",{className:"p-3 text-red-500 text-center text-sm",children:q}),!F&&!q&&B.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 px-3 py-2 border-b border-gray-200",children:"Select a city:"}),B.map(P=>e.jsxs("div",{onClick:()=>ze(P),className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[P.city,P.state&&e.jsxs("span",{className:"text-gray-600",children:[", ",P.state]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:P.country})]},P.id))]}),!F&&!q&&k.trim()&&e.jsxs("div",{children:[B.length>0&&e.jsx("div",{className:"border-t border-gray-200 mt-1"}),e.jsxs("div",{onClick:Z,className:"p-3 hover:bg-blue-50 cursor-pointer text-blue-600 flex justify-between items-center transition-colors",children:[e.jsxs("span",{children:['+ Add "',k.trim(),'" as new city']}),e.jsx("span",{className:"text-gray-400",children:"â†’"})]})]}),!F&&!q&&!k.trim()&&B.length===0&&e.jsx("div",{className:"p-3 text-gray-500 text-center text-sm",children:"Start typing to search cities"})]})]})},It=_e("SupabaseAdapter");It.info("Supabase adapter configured - using real Supabase client");const nt=_e("BarSelect"),vt=({value:L="",onSelect:E,placeholder:z="Select or enter a bar",className:I="w-full px-3 py-2 border border-gray-300 rounded-md"})=>{const[v,S]=x.useState(L),[C,k]=x.useState(!1),[M,_]=x.useState([]),[A,F]=x.useState(!1),[X,q]=x.useState(null);x.useEffect(()=>{S(L)},[L]),x.useEffect(()=>{if(!v.trim()){_([]);return}const K=setTimeout(async()=>{F(!0);try{const{data:G,error:je}=await we.from("venues").select("id, name, city, country").ilike("name",`%${v}%`).is("is_archived",!1).order("name").limit(8);if(je)throw je;_(G||[])}catch(G){nt.error("Failed to load venues:",G),q("Failed to load venues")}finally{F(!1)}},300);return()=>clearTimeout(K)},[v]);const ie=H=>{S(H.name),k(!1),E(H)},B=async()=>{if(v.trim())try{F(!0),q(null);const{data:{user:H}}=await we.auth.getUser();if(!H)throw new Error("Please sign in to add a new venue");const{data:K,error:G}=await we.from("venues").insert({name:v.trim(),created_by:H.id}).select().single();if(G)throw G;nt.info("Created new venue:",{id:K.id,name:K.name}),S(K.name),k(!1),E(K)}catch(H){nt.error("Error adding new venue:",H),q(H.message)}finally{F(!1)}},T=H=>{const K=H.target.value;S(K),k(!0)};return e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:v,onChange:T,onFocus:()=>k(!0),onBlur:()=>setTimeout(()=>k(!1),200),placeholder:z,className:I}),C&&(v.trim()||A||X)&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-md border border-gray-300 shadow-lg max-h-60 overflow-y-auto",children:[A&&e.jsx("div",{className:"p-2 text-gray-500 text-center",children:"Loading..."}),X&&e.jsx("div",{className:"p-2 text-red-500",children:X}),!A&&!X&&M.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 px-3 py-2 border-b border-gray-200",children:"Select a venue:"}),M.map(H=>e.jsxs("div",{className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors",onClick:()=>ie(H),children:[e.jsx("div",{className:"font-medium text-gray-900",children:H.name}),H.city&&H.country&&e.jsxs("div",{className:"text-sm text-gray-500",children:[H.city,", ",H.country]})]},H.id))]}),v.trim()&&e.jsxs("div",{children:[M.length>0&&e.jsx("div",{className:"border-t border-gray-200 mt-1"}),e.jsxs("div",{className:"p-3 hover:bg-blue-50 cursor-pointer text-blue-600 flex justify-between items-center transition-colors",onClick:B,children:[e.jsxs("span",{children:['+ Add "',v.trim(),'" as new venue']}),e.jsx("span",{className:"text-gray-400",children:"â†’"})]})]}),!A&&!X&&v.trim()&&M.length===0&&e.jsx("div",{className:"p-2 text-gray-500 text-center text-sm",children:"No matching venues found"})]})]})};var at={exports:{}};(function(L,E){(function(z,I){typeof E.nodeName!="string"?L.exports=I():z.Croppie=I()})(typeof self<"u"?self:Lt,function(){if(typeof Promise!="function"){/*! promise-polyfill 3.1.0 */(function(t){function n(d,h){return function(){d.apply(h,arguments)}}function r(d){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof d!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],w(d,n(o,this),n(l,this))}function s(d){var h=this;return this._state===null?void this._deferreds.push(d):void j(function(){var u=h._state?d.onFulfilled:d.onRejected;if(u===null)return void(h._state?d.resolve:d.reject)(h._value);var g;try{g=u(h._value)}catch(N){return void d.reject(N)}d.resolve(g)})}function o(d){try{if(d===this)throw new TypeError("A promise cannot be resolved with itself.");if(d&&(typeof d=="object"||typeof d=="function")){var h=d.then;if(typeof h=="function")return void w(n(h,d),n(o,this),n(l,this))}this._state=!0,this._value=d,m.call(this)}catch(u){l.call(this,u)}}function l(d){this._state=!1,this._value=d,m.call(this)}function m(){for(var d=0,h=this._deferreds.length;h>d;d++)s.call(this,this._deferreds[d]);this._deferreds=null}function f(d,h,u,g){this.onFulfilled=typeof d=="function"?d:null,this.onRejected=typeof h=="function"?h:null,this.resolve=u,this.reject=g}function w(d,h,u){var g=!1;try{d(function(N){g||(g=!0,h(N))},function(N){g||(g=!0,u(N))})}catch(N){if(g)return;g=!0,u(N)}}var y=setTimeout,j=typeof setImmediate=="function"&&setImmediate||function(d){y(d,1)},D=Array.isArray||function(d){return Object.prototype.toString.call(d)==="[object Array]"};r.prototype.catch=function(d){return this.then(null,d)},r.prototype.then=function(d,h){var u=this;return new r(function(g,N){s.call(u,new f(d,h,g,N))})},r.all=function(){var d=Array.prototype.slice.call(arguments.length===1&&D(arguments[0])?arguments[0]:arguments);return new r(function(h,u){function g($,U){try{if(U&&(typeof U=="object"||typeof U=="function")){var J=U.then;if(typeof J=="function")return void J.call(U,function(V){g($,V)},u)}d[$]=U,--N===0&&h(d)}catch(V){u(V)}}if(d.length===0)return h([]);for(var N=d.length,O=0;O<d.length;O++)g(O,d[O])})},r.resolve=function(d){return d&&typeof d=="object"&&d.constructor===r?d:new r(function(h){h(d)})},r.reject=function(d){return new r(function(h,u){u(d)})},r.race=function(d){return new r(function(h,u){for(var g=0,N=d.length;N>g;g++)d[g].then(h,u)})},r._setImmediateFn=function(d){j=d},L.exports?L.exports=r:t.Promise||(t.Promise=r)})(this)}typeof window<"u"&&typeof window.CustomEvent!="function"&&function(){function t(n,r){r=r||{bubbles:!1,cancelable:!1,detail:void 0};var s=document.createEvent("CustomEvent");return s.initCustomEvent(n,r.bubbles,r.cancelable,r.detail),s}t.prototype=window.Event.prototype,window.CustomEvent=t}(),typeof HTMLCanvasElement<"u"&&!HTMLCanvasElement.prototype.toBlob&&Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,n,r){for(var s=atob(this.toDataURL(n,r).split(",")[1]),o=s.length,l=new Uint8Array(o),m=0;m<o;m++)l[m]=s.charCodeAt(m);t(new Blob([l],{type:n||"image/png"}))}});var z=["Webkit","Moz","ms"],I=typeof document<"u"?document.createElement("div").style:{},v=[1,8,3,6],S=[2,7,4,5],C,k,M;function _(t){if(t in I)return t;for(var n=t[0].toUpperCase()+t.slice(1),r=z.length;r--;)if(t=z[r]+n,t in I)return t}k=_("transform"),C=_("transformOrigin"),M=_("userSelect");function A(t,n){var r=v.indexOf(t)>-1?v:S,s=r.indexOf(t),o=n/90%r.length;return r[(r.length+s+o%r.length)%r.length]}function F(t,n){t=t||{};for(var r in n)n[r]&&n[r].constructor&&n[r].constructor===Object?(t[r]=t[r]||{},F(t[r],n[r])):t[r]=n[r];return t}function X(t){return F({},t)}function q(t,n,r){var s;return function(){var o=this,l=arguments,m=function(){s=null,t.apply(o,l)};clearTimeout(s),s=setTimeout(m,n)}}function ie(t){if("createEvent"in document){var n=document.createEvent("HTMLEvents");n.initEvent("change",!1,!0),t.dispatchEvent(n)}else t.fireEvent("onchange")}function B(t,n,r){if(typeof n=="string"){var s=n;n={},n[s]=r}for(var o in n)t.style[o]=n[o]}function T(t,n){t.classList?t.classList.add(n):t.className+=" "+n}function H(t,n){t.classList?t.classList.remove(n):t.className=t.className.replace(n,"")}function K(t,n){for(var r in n)t.setAttribute(r,n[r])}function G(t){return parseInt(t,10)}function je(t,n){if(!t)throw"Source image missing";var r=new Image;return r.style.opacity="0",new Promise(function(s,o){function l(){r.style.opacity="1",setTimeout(function(){s(r)},1)}r.removeAttribute("crossOrigin"),t.match(/^https?:\/\/|^\/\//)&&r.setAttribute("crossOrigin","anonymous"),r.onload=function(){n?EXIF.getData(r,function(){l()}):l()},r.onerror=function(m){r.style.opacity=1,setTimeout(function(){o(m)},1)},r.src=t})}function Ee(t,n){var r=t.naturalWidth,s=t.naturalHeight,o=n||P(t);if(o&&o>=5){var l=r;r=s,s=l}return{width:r,height:s}}var ze={translate3d:{suffix:", 0px"},translate:{suffix:""}},Z=function(t,n,r){this.x=parseFloat(t),this.y=parseFloat(n),this.scale=parseFloat(r)};Z.parse=function(t){return t.style?Z.parse(t.style[k]):t.indexOf("matrix")>-1||t.indexOf("none")>-1?Z.fromMatrix(t):Z.fromString(t)},Z.fromMatrix=function(t){var n=t.substring(7).split(",");return(!n.length||t==="none")&&(n=[1,0,0,1,0,0]),new Z(G(n[4]),G(n[5]),parseFloat(n[0]))},Z.fromString=function(t){var n=t.split(") "),r=n[0].substring(se.globals.translate.length+1).split(","),s=n.length>1?n[1].substring(6):1,o=r.length>1?r[0]:0,l=r.length>1?r[1]:0;return new Z(o,l,s)},Z.prototype.toString=function(){var t=ze[se.globals.translate].suffix||"";return se.globals.translate+"("+this.x+"px, "+this.y+"px"+t+") scale("+this.scale+")"};var ce=function(t){if(!t||!t.style[C]){this.x=0,this.y=0;return}var n=t.style[C].split(" ");this.x=parseFloat(n[0]),this.y=parseFloat(n[1])};ce.prototype.toString=function(){return this.x+"px "+this.y+"px"};function P(t){return t.exifdata&&t.exifdata.Orientation?G(t.exifdata.Orientation):1}function re(t,n,r){var s=n.width,o=n.height,l=t.getContext("2d");switch(t.width=n.width,t.height=n.height,l.save(),r){case 2:l.translate(s,0),l.scale(-1,1);break;case 3:l.translate(s,o),l.rotate(180*Math.PI/180);break;case 4:l.translate(0,o),l.scale(1,-1);break;case 5:t.width=o,t.height=s,l.rotate(90*Math.PI/180),l.scale(1,-1);break;case 6:t.width=o,t.height=s,l.rotate(90*Math.PI/180),l.translate(0,-o);break;case 7:t.width=o,t.height=s,l.rotate(-90*Math.PI/180),l.translate(-s,o),l.scale(1,-1);break;case 8:t.width=o,t.height=s,l.translate(0,s),l.rotate(-90*Math.PI/180);break}l.drawImage(n,0,0,s,o),l.restore()}function qe(){var t=this,n="croppie-container",r=t.options.viewport.type?"cr-vp-"+t.options.viewport.type:null,s,o,l,m,f,w;t.options.useCanvas=t.options.enableOrientation||Pe.call(t),t.data={},t.elements={},s=t.elements.boundary=document.createElement("div"),l=t.elements.viewport=document.createElement("div"),o=t.elements.img=document.createElement("img"),m=t.elements.overlay=document.createElement("div"),t.options.useCanvas?(t.elements.canvas=document.createElement("canvas"),t.elements.preview=t.elements.canvas):t.elements.preview=o,T(s,"cr-boundary"),s.setAttribute("aria-dropeffect","none"),f=t.options.boundary.width,w=t.options.boundary.height,B(s,{width:f+(isNaN(f)?"":"px"),height:w+(isNaN(w)?"":"px")}),T(l,"cr-viewport"),r&&T(l,r),B(l,{width:t.options.viewport.width+"px",height:t.options.viewport.height+"px"}),l.setAttribute("tabindex",0),T(t.elements.preview,"cr-image"),K(t.elements.preview,{alt:"preview","aria-grabbed":"false"}),T(m,"cr-overlay"),t.element.appendChild(s),s.appendChild(t.elements.preview),s.appendChild(l),s.appendChild(m),T(t.element,n),t.options.customClass&&T(t.element,t.options.customClass),oe.call(this),t.options.enableZoom&&Ge.call(t),t.options.enableResize&&Ve.call(t)}function Pe(){return this.options.enableExif&&window.EXIF}function Ve(){var t=this,n=document.createElement("div"),r=!1,s,o,l,m=50,f,w,y,j;T(n,"cr-resizer"),B(n,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(y=document.createElement("div"),T(y,"cr-resizer-vertical"),n.appendChild(y)),this.options.resizeControls.width&&(j=document.createElement("div"),T(j,"cr-resizer-horisontal"),n.appendChild(j));function D(u){if(!(u.button!==void 0&&u.button!==0)&&(u.preventDefault(),!r)){var g=t.elements.overlay.getBoundingClientRect();if(r=!0,o=u.pageX,l=u.pageY,s=u.currentTarget.className.indexOf("vertical")!==-1?"v":"h",f=g.width,w=g.height,u.touches){var N=u.touches[0];o=N.pageX,l=N.pageY}window.addEventListener("mousemove",d),window.addEventListener("touchmove",d),window.addEventListener("mouseup",h),window.addEventListener("touchend",h),document.body.style[M]="none"}}function d(u){var g=u.pageX,N=u.pageY;if(u.preventDefault(),u.touches){var O=u.touches[0];g=O.pageX,N=O.pageY}var $=g-o,U=N-l,J=t.options.viewport.height+U,V=t.options.viewport.width+$;s==="v"&&J>=m&&J<=w?(B(n,{height:J+"px"}),t.options.boundary.height+=U,B(t.elements.boundary,{height:t.options.boundary.height+"px"}),t.options.viewport.height+=U,B(t.elements.viewport,{height:t.options.viewport.height+"px"})):s==="h"&&V>=m&&V<=f&&(B(n,{width:V+"px"}),t.options.boundary.width+=$,B(t.elements.boundary,{width:t.options.boundary.width+"px"}),t.options.viewport.width+=$,B(t.elements.viewport,{width:t.options.viewport.width+"px"})),Ne.call(t),ae.call(t),ye.call(t),de.call(t),l=N,o=g}function h(){r=!1,window.removeEventListener("mousemove",d),window.removeEventListener("touchmove",d),window.removeEventListener("mouseup",h),window.removeEventListener("touchend",h),document.body.style[M]=""}y&&(y.addEventListener("mousedown",D),y.addEventListener("touchstart",D)),j&&(j.addEventListener("mousedown",D),j.addEventListener("touchstart",D)),this.elements.boundary.appendChild(n)}function pe(t){if(this.options.enableZoom){var n=this.elements.zoomer,r=p(t,4);n.value=Math.max(parseFloat(n.min),Math.min(parseFloat(n.max),r)).toString()}}function Ge(){var t=this,n=t.elements.zoomerWrap=document.createElement("div"),r=t.elements.zoomer=document.createElement("input");T(n,"cr-slider-wrap"),T(r,"cr-slider"),r.type="range",r.step="0.0001",r.value="1",r.style.display=t.options.showZoomer?"":"none",r.setAttribute("aria-label","zoom"),t.element.appendChild(n),n.appendChild(r),t._currentZoom=1;function s(){st.call(t,{value:parseFloat(r.value),origin:new ce(t.elements.preview),viewportRect:t.elements.viewport.getBoundingClientRect(),transform:Z.parse(t.elements.preview)})}function o(l){var m,f;if(t.options.mouseWheelZoom==="ctrl"&&l.ctrlKey!==!0)return 0;l.wheelDelta?m=l.wheelDelta/1200:l.deltaY?m=l.deltaY/1060:l.detail?m=l.detail/-60:m=0,f=t._currentZoom+m*t._currentZoom,l.preventDefault(),pe.call(t,f),s.call(t)}t.elements.zoomer.addEventListener("input",s),t.elements.zoomer.addEventListener("change",s),t.options.mouseWheelZoom&&(t.elements.boundary.addEventListener("mousewheel",o),t.elements.boundary.addEventListener("DOMMouseScroll",o))}function st(t){var n=this,r=t?t.transform:Z.parse(n.elements.preview),s=t?t.viewportRect:n.elements.viewport.getBoundingClientRect(),o=t?t.origin:new ce(n.elements.preview);function l(){var y={};y[k]=r.toString(),y[C]=o.toString(),B(n.elements.preview,y)}if(n._currentZoom=t?t.value:n._currentZoom,r.scale=n._currentZoom,n.elements.zoomer.setAttribute("aria-valuenow",n._currentZoom),l(),n.options.enforceBoundary){var m=Ke.call(n,s),f=m.translate,w=m.origin;r.x>=f.maxX&&(o.x=w.minX,r.x=f.maxX),r.x<=f.minX&&(o.x=w.maxX,r.x=f.minX),r.y>=f.maxY&&(o.y=w.minY,r.y=f.maxY),r.y<=f.minY&&(o.y=w.maxY,r.y=f.minY)}l(),Qe.call(n),de.call(n)}function Ke(t){var n=this,r=n._currentZoom,s=t.width,o=t.height,l=n.elements.boundary.clientWidth/2,m=n.elements.boundary.clientHeight/2,f=n.elements.preview.getBoundingClientRect(),w=f.width,y=f.height,j=s/2,D=o/2,d=(j/r-l)*-1,h=d-(w*(1/r)-s*(1/r)),u=(D/r-m)*-1,g=u-(y*(1/r)-o*(1/r)),N=1/r*j,O=w*(1/r)-N,$=1/r*D,U=y*(1/r)-$;return{translate:{maxX:d,minX:h,maxY:u,minY:g},origin:{maxX:O,minX:N,maxY:U,minY:$}}}function ye(t){var n=this,r=n._currentZoom,s=n.elements.preview.getBoundingClientRect(),o=n.elements.viewport.getBoundingClientRect(),l=Z.parse(n.elements.preview.style[k]),m=new ce(n.elements.preview),f=o.top-s.top+o.height/2,w=o.left-s.left+o.width/2,y={},j={};if(t){var D=m.x,d=m.y,h=l.x,u=l.y;y.y=D,y.x=d,l.y=h,l.x=u}else y.y=f/r,y.x=w/r,j.y=(y.y-m.y)*(1-r),j.x=(y.x-m.x)*(1-r),l.x-=j.x,l.y-=j.y;var g={};g[C]=y.x+"px "+y.y+"px",g[k]=l.toString(),B(n.elements.preview,g)}function oe(){var t=this,n=!1,r,s,o,l,m;function f(u,g){var N=t.elements.preview.getBoundingClientRect(),O=m.y+g,$=m.x+u;t.options.enforceBoundary?(l.top>N.top+g&&l.bottom<N.bottom+g&&(m.y=O),l.left>N.left+u&&l.right<N.right+u&&(m.x=$)):(m.y=O,m.x=$)}function w(u){t.elements.preview.setAttribute("aria-grabbed",u),t.elements.boundary.setAttribute("aria-dropeffect",u?"move":"none")}function y(u){var g=37,N=38,O=39,$=40;if(u.shiftKey&&(u.keyCode===N||u.keyCode===$)){var U;u.keyCode===N?U=parseFloat(t.elements.zoomer.value)+parseFloat(t.elements.zoomer.step):U=parseFloat(t.elements.zoomer.value)-parseFloat(t.elements.zoomer.step),t.setZoom(U)}else if(t.options.enableKeyMovement&&u.keyCode>=37&&u.keyCode<=40){u.preventDefault();var J=V(u.keyCode);m=Z.parse(t.elements.preview),document.body.style[M]="none",l=t.elements.viewport.getBoundingClientRect(),j(J)}function V(ge){switch(ge){case g:return[1,0];case N:return[0,1];case O:return[-1,0];case $:return[0,-1]}}}function j(u){var g=u[0],N=u[1],O={};f(g,N),O[k]=m.toString(),B(t.elements.preview,O),Ne.call(t),document.body.style[M]="",ye.call(t),de.call(t),o=0}function D(u){if(!(u.button!==void 0&&u.button!==0)&&(u.preventDefault(),!n)){if(n=!0,r=u.pageX,s=u.pageY,u.touches){var g=u.touches[0];r=g.pageX,s=g.pageY}w(n),m=Z.parse(t.elements.preview),window.addEventListener("mousemove",d),window.addEventListener("touchmove",d),window.addEventListener("mouseup",h),window.addEventListener("touchend",h),document.body.style[M]="none",l=t.elements.viewport.getBoundingClientRect()}}function d(u){u.preventDefault();var g=u.pageX,N=u.pageY;if(u.touches){var O=u.touches[0];g=O.pageX,N=O.pageY}var $=g-r,U=N-s,J={};if(u.type==="touchmove"&&u.touches.length>1){var V=u.touches[0],ge=u.touches[1],ne=Math.sqrt((V.pageX-ge.pageX)*(V.pageX-ge.pageX)+(V.pageY-ge.pageY)*(V.pageY-ge.pageY));o||(o=ne/t._currentZoom);var tt=ne/o;pe.call(t,tt),ie(t.elements.zoomer);return}f($,U),J[k]=m.toString(),B(t.elements.preview,J),Ne.call(t),s=N,r=g}function h(){n=!1,w(n),window.removeEventListener("mousemove",d),window.removeEventListener("touchmove",d),window.removeEventListener("mouseup",h),window.removeEventListener("touchend",h),document.body.style[M]="",ye.call(t),de.call(t),o=0}t.elements.overlay.addEventListener("mousedown",D),t.elements.viewport.addEventListener("keydown",y),t.elements.overlay.addEventListener("touchstart",D)}function Ne(){if(this.elements){var t=this,n=t.elements.boundary.getBoundingClientRect(),r=t.elements.preview.getBoundingClientRect();B(t.elements.overlay,{width:r.width+"px",height:r.height+"px",top:r.top-n.top+"px",left:r.left-n.left+"px"})}}var Qe=q(Ne,500);function de(){var t=this,n=t.get();if(ve.call(t))if(t.options.update.call(t,n),t.$&&typeof Prototype>"u")t.$(t.element).trigger("update.croppie",n);else{var r;window.CustomEvent?r=new CustomEvent("update",{detail:n}):(r=document.createEvent("CustomEvent"),r.initCustomEvent("update",!0,!0,n)),t.element.dispatchEvent(r)}}function ve(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function fe(){var t=this,n=1,r={},s=t.elements.preview,o,l=new Z(0,0,n),m=new ce,f=ve.call(t);!f||t.data.bound||(t.data.bound=!0,r[k]=l.toString(),r[C]=m.toString(),r.opacity=1,B(s,r),o=t.elements.preview.getBoundingClientRect(),t._originalImageWidth=o.width,t._originalImageHeight=o.height,t.data.orientation=Pe.call(t)?P(t.elements.img):t.data.orientation,t.options.enableZoom?ae.call(t,!0):t._currentZoom=n,l.scale=t._currentZoom,r[k]=l.toString(),B(s,r),t.data.points.length?ue.call(t,t.data.points):me.call(t),ye.call(t),Ne.call(t))}function ae(t){var n=this,r=Math.max(n.options.minZoom,0)||0,s=n.options.maxZoom||1.5,o,l,m=n.elements.zoomer,f=parseFloat(m.value),w=n.elements.boundary.getBoundingClientRect(),y=Ee(n.elements.img,n.data.orientation),j=n.elements.viewport.getBoundingClientRect(),D,d;n.options.enforceBoundary&&(D=j.width/y.width,d=j.height/y.height,r=Math.max(D,d)),r>=s&&(s=r+1),m.min=p(r,4),m.max=p(s,4),!t&&(f<m.min||f>m.max)?pe.call(n,f<m.min?m.min:m.max):t&&(l=Math.max(w.width/y.width,w.height/y.height),o=n.data.boundZoom!==null?n.data.boundZoom:l,pe.call(n,o)),ie(m)}function ue(t){if(t.length!==4)throw"Croppie - Invalid number of points supplied: "+t;var n=this,r=t[2]-t[0],s=n.elements.viewport.getBoundingClientRect(),o=n.elements.boundary.getBoundingClientRect(),l={left:s.left-o.left,top:s.top-o.top},m=s.width/r,f=t[1],w=t[0],y=-1*t[1]+l.top,j=-1*t[0]+l.left,D={};D[C]=w+"px "+f+"px",D[k]=new Z(j,y,m).toString(),B(n.elements.preview,D),pe.call(n,m),n._currentZoom=m}function me(){var t=this,n=t.elements.preview.getBoundingClientRect(),r=t.elements.viewport.getBoundingClientRect(),s=t.elements.boundary.getBoundingClientRect(),o=r.left-s.left,l=r.top-s.top,m=o-(n.width-r.width)/2,f=l-(n.height-r.height)/2,w=new Z(m,f,t._currentZoom);B(t.elements.preview,k,w.toString())}function Ce(t){var n=this,r=n.elements.canvas,s=n.elements.img,o=r.getContext("2d");o.clearRect(0,0,r.width,r.height),r.width=s.width,r.height=s.height;var l=n.options.enableOrientation&&t||P(s);re(r,s,l)}function he(t){var n=this,r=t.points,s=G(r[0]),o=G(r[1]),l=G(r[2]),m=G(r[3]),f=l-s,w=m-o,y=t.circle,j=document.createElement("canvas"),D=j.getContext("2d"),d=t.outputWidth||f,h=t.outputHeight||w;j.width=d,j.height=h,t.backgroundColor&&(D.fillStyle=t.backgroundColor,D.fillRect(0,0,d,h));var u=s,g=o,N=f,O=w,$=0,U=0,J=d,V=h;return s<0&&(u=0,$=Math.abs(s)/f*d),N+u>n._originalImageWidth&&(N=n._originalImageWidth-u,J=N/f*d),o<0&&(g=0,U=Math.abs(o)/w*h),O+g>n._originalImageHeight&&(O=n._originalImageHeight-g,V=O/w*h),D.drawImage(this.elements.preview,u,g,N,O,$,U,J,V),y&&(D.fillStyle="#fff",D.globalCompositeOperation="destination-in",D.beginPath(),D.arc(j.width/2,j.height/2,j.width/2,0,Math.PI*2,!0),D.closePath(),D.fill()),j}function Ae(t){var n=t.points,r=document.createElement("div"),s=document.createElement("img"),o=n[2]-n[0],l=n[3]-n[1];return T(r,"croppie-result"),r.appendChild(s),B(s,{left:-1*n[0]+"px",top:-1*n[1]+"px"}),s.src=t.url,B(r,{width:o+"px",height:l+"px"}),r}function lt(t){return he.call(this,t).toDataURL(t.format,t.quality)}function Me(t){var n=this;return new Promise(function(r){he.call(n,t).toBlob(function(s){r(s)},t.format,t.quality)})}function He(t){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(n){t.classList.add(n)}),this.elements.img.parentNode.replaceChild(t,this.elements.img),this.elements.preview=t),this.elements.img=t}function Se(t,n){var r=this,s,o=[],l=null,m=Pe.call(r);if(typeof t=="string")s=t,t={};else if(Array.isArray(t))o=t.slice();else{if(typeof t>"u"&&r.data.url)return fe.call(r),de.call(r),null;s=t.url,o=t.points||[],l=typeof t.zoom>"u"?null:t.zoom}return r.data.bound=!1,r.data.url=s||r.data.url,r.data.boundZoom=l,je(s,m).then(function(f){if(He.call(r,f),o.length)r.options.relative&&(o=[o[0]*f.naturalWidth/100,o[1]*f.naturalHeight/100,o[2]*f.naturalWidth/100,o[3]*f.naturalHeight/100]);else{var w=Ee(f),y=r.elements.viewport.getBoundingClientRect(),j=y.width/y.height,D=w.width/w.height,d,h;D>j?(h=w.height,d=h*j):(d=w.width,h=w.height/j);var u=(w.width-d)/2,g=(w.height-h)/2,N=u+d,O=g+h;r.data.points=[u,g,N,O]}r.data.orientation=t.orientation||1,r.data.points=o.map(function($){return parseFloat($)}),r.options.useCanvas&&Ce.call(r,r.data.orientation),fe.call(r),de.call(r),n&&n()})}function p(t,n){return parseFloat(t).toFixed(n||0)}function W(){var t=this,n=t.elements.preview.getBoundingClientRect(),r=t.elements.viewport.getBoundingClientRect(),s=r.left-n.left,o=r.top-n.top,l=(r.width-t.elements.viewport.offsetWidth)/2,m=(r.height-t.elements.viewport.offsetHeight)/2,f=s+t.elements.viewport.offsetWidth+l,w=o+t.elements.viewport.offsetHeight+m,y=t._currentZoom;(y===1/0||isNaN(y))&&(y=1);var j=t.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return s=Math.max(j,s/y),o=Math.max(j,o/y),f=Math.max(j,f/y),w=Math.max(j,w/y),{points:[p(s),p(o),p(f),p(w)],zoom:y,orientation:t.data.orientation}}var b={type:"canvas",format:"png",quality:1},Q=["jpeg","webp","png"];function Je(t){var n=this,r=W.call(n),s=F(X(b),X(t)),o=typeof t=="string"?t:s.type||"base64",l=s.size||"viewport",m=s.format,f=s.quality,w=s.backgroundColor,y=typeof s.circle=="boolean"?s.circle:n.options.viewport.type==="circle",j=n.elements.viewport.getBoundingClientRect(),D=j.width/j.height,d;return l==="viewport"?(r.outputWidth=j.width,r.outputHeight=j.height):typeof l=="object"&&(l.width&&l.height?(r.outputWidth=l.width,r.outputHeight=l.height):l.width?(r.outputWidth=l.width,r.outputHeight=l.width/D):l.height&&(r.outputWidth=l.height*D,r.outputHeight=l.height)),Q.indexOf(m)>-1&&(r.format="image/"+m,r.quality=f),r.circle=y,r.url=n.data.url,r.backgroundColor=w,d=new Promise(function(h){switch(o.toLowerCase()){case"rawcanvas":h(he.call(n,r));break;case"canvas":case"base64":h(lt.call(n,r));break;case"blob":Me.call(n,r).then(h);break;default:h(Ae.call(n,r));break}}),d}function Te(){fe.call(this)}function et(t){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var n=this,r=n.elements.canvas;if(n.data.orientation=A(n.data.orientation,t),re(r,n.elements.img,n.data.orientation),ye.call(n,!0),ae.call(n),Math.abs(t)/90%2===1){var s=n._originalImageHeight,o=n._originalImageWidth;n._originalImageWidth=s,n._originalImageHeight=o}}function De(){var t=this;t.element.removeChild(t.elements.boundary),H(t.element,"croppie-container"),t.options.enableZoom&&t.element.removeChild(t.elements.zoomerWrap),delete t.elements}if(typeof window<"u"&&window.jQuery){var xe=window.jQuery;xe.fn.croppie=function(t){var n=typeof t;if(n==="string"){var r=Array.prototype.slice.call(arguments,1),s=xe(this).data("croppie");return t==="get"?s.get():t==="result"?s.result.apply(s,r):t==="bind"?s.bind.apply(s,r):this.each(function(){var o=xe(this).data("croppie");if(o){var l=o[t];if(xe.isFunction(l))l.apply(o,r),t==="destroy"&&xe(this).removeData("croppie");else throw"Croppie "+t+" method not found"}})}else return this.each(function(){var o=new se(this,t);o.$=xe,xe(this).data("croppie",o)})}}function se(t,n){if(t.className.indexOf("croppie-container")>-1)throw new Error("Croppie: Can't initialize croppie more than once");if(this.element=t,this.options=F(X(se.defaults),n),this.element.tagName.toLowerCase()==="img"){var r=this.element;T(r,"cr-original-image"),K(r,{"aria-hidden":"true",alt:""});var s=document.createElement("div");this.element.parentNode.appendChild(s),s.appendChild(r),this.element=s,this.options.url=this.options.url||r.src}if(qe.call(this),this.options.url){var o={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,Se.call(this,o)}}return se.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}},se.globals={translate:"translate3d"},F(se.prototype,{bind:function(t,n){return Se.call(this,t,n)},get:function(){var t=W.call(this),n=t.points;return this.options.relative&&(n[0]/=this.elements.img.naturalWidth/100,n[1]/=this.elements.img.naturalHeight/100,n[2]/=this.elements.img.naturalWidth/100,n[3]/=this.elements.img.naturalHeight/100),t},result:function(t){return Je.call(this,t)},refresh:function(){return Te.call(this)},setZoom:function(t){pe.call(this,t),ie(this.elements.zoomer)},rotate:function(t){et.call(this,t)},destroy:function(){return De.call(this)}}),se})})(at,at.exports);var Ot=at.exports;const Ht=Rt(Ot),wt=_e("CroppieImageCrop"),jt=({imageUrl:L,cropType:E="cover",onCropChange:z,className:I=""})=>{const v=x.useRef(null),S=x.useRef(null),[C,k]=x.useState(!1),M=()=>E==="cover"?{viewport:{width:400,height:150},boundary:{width:450,height:200}}:{viewport:{width:200,height:200,type:"circle"},boundary:{width:250,height:250}},_=x.useCallback(()=>{if(S.current&&C){const A=E==="cover"?{type:"base64",format:"jpeg",quality:.95,size:{width:1e3,height:375},circle:!1}:{type:"base64",format:"jpeg",quality:.95,size:{width:320,height:320},circle:!0};return S.current.result(A)}return Promise.resolve(null)},[C,E]);if(x.useEffect(()=>{if(!L||!v.current)return;S.current&&(S.current.destroy(),S.current=null,k(!1));const A=M(),F=new Ht(v.current,A);return S.current=F,F.bind({url:L}).then(()=>{k(!0),wt.info("Croppie initialized successfully")}).catch(X=>{wt.error("Error initializing Croppie:",X)}),()=>{S.current&&(S.current.destroy(),S.current=null,k(!1))}},[L,E]),x.useEffect(()=>{z&&z({getCroppedResult:_,cropType:E})},[_,z,E]),!L){const A=M();return e.jsx("div",{className:`bg-gray-100 border-2 border-dashed border-gray-300 flex items-center justify-center ${I}`,style:{width:A.boundary.width,height:A.boundary.height},children:e.jsx("span",{className:"text-gray-500 text-sm",children:"No image selected"})})}return e.jsxs("div",{className:`croppie-container ${I}`,children:[e.jsx("div",{ref:v}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600 text-center",children:[e.jsx("p",{children:E==="cover"?"Cover Photo Cropping":"Profile Photo Cropping"}),e.jsx("p",{className:"text-gray-500",children:"Use the slider to zoom and drag to position"})]})]})},te=_e("BartenderService");class it{static async updateBartenderName(E,z){const I=Date.now();te.info("Updating bartender name",{bartenderId:E,fullName:z});try{const{data:v,error:S}=await we.from("bartenders").update({full_name:z,updated_at:new Date().toISOString()}).eq("id",E).select().single();if(S)throw S;return te.info("Bartender name updated successfully",{bartenderId:E}),te.trace("updateBartenderName",I),v}catch(v){throw te.error("Error updating bartender name",v),v}}static async updateBartenderVenue(E,z){const I=Date.now();te.info("Updating bartender venue",{bartenderId:E,venueId:z});try{const{data:v,error:S}=await we.from("bartenders").update({venue_id:z,updated_at:new Date().toISOString()}).eq("id",E).select(`
          *,
          venues:venue_id (
            id,
            name,
            city,
            country
          )
        `).single();if(S)throw S;return te.info("Bartender venue updated successfully",{bartenderId:E,venueId:z}),te.trace("updateBartenderVenue",I),v}catch(v){throw te.error("Error updating bartender venue",v),v}}static async getBartenderDetails(E){const z=Date.now();te.info("Fetching bartender details",{bartenderId:E});try{const{data:I,error:v}=await we.from("bartenders").select(`
          *,
          venues:venue_id (
            id,
            name,
            city,
            country
          )
        `).eq("id",E).single();if(v)throw v;return te.info("Bartender details fetched successfully",{bartenderId:E}),te.trace("getBartenderDetails",z),I}catch(I){throw te.error("Error fetching bartender details",I),I}}static async updateBartender(E,z){const I=Date.now();te.info("Updating bartender",{bartenderId:E,updates:z});try{const v={...z,updated_at:new Date().toISOString()},{data:S,error:C}=await we.from("bartenders").update(v).eq("id",E).select(`
          *,
          venues:venue_id (
            id,
            name,
            city,
            country
          )
        `).single();if(C)throw C;return te.info("Bartender updated successfully",{bartenderId:E}),te.trace("updateBartender",I),S}catch(v){throw te.error("Error updating bartender",v),v}}}const Re=_e("useBartender"),Tt=L=>{const[E,z]=x.useState(!1),[I,v]=x.useState(null),S=x.useCallback(async M=>{if(!L)return v("No bartender ID provided"),null;z(!0),v(null);try{const _=await it.updateBartenderName(L,M);return Re.info("Bartender name updated successfully"),_}catch(_){throw Re.error("Error updating bartender name:",_),v(_.message||"Failed to update name"),_}finally{z(!1)}},[L]),C=x.useCallback(async M=>{if(!L)return v("No bartender ID provided"),null;z(!0),v(null);try{const _=await it.updateBartenderVenue(L,M);return Re.info("Bartender venue updated successfully"),_}catch(_){throw Re.error("Error updating bartender venue:",_),v(_.message||"Failed to update venue"),_}finally{z(!1)}},[L]),k=x.useCallback(async M=>{if(!L)return v("No bartender ID provided"),null;z(!0),v(null);try{const _=await it.updateBartender(L,M);return Re.info("Bartender updated successfully"),_}catch(_){throw Re.error("Error updating bartender:",_),v(_.message||"Failed to update bartender"),_}finally{z(!1)}},[L]);return{loading:E,error:I,updateName:S,updateVenue:C,updateBartender:k}},be=_e("ProfilePage"),$t=({bartenderId:L,bartenderName:E})=>{const[z,I]=x.useState([]),[v,S]=x.useState(!0),[C,k]=x.useState(null);x.useEffect(()=>{(async()=>{if(!L){S(!1),k("Bartender ID is missing.");return}S(!0),k(null),be.debug(`Fetching history for bartender ID: ${L}`);try{const{data:A,error:F}=await we.from("legacy_results").select(`placement,
             post_competition_rating,
             pre_competition_rating,
             legacy_competition_id,
             legacy_competitions!fk_lr_competition (
               id,
               name,
               date
             )`).eq("bartender_id",L).order("date",{ascending:!1,foreignTable:"legacy_competitions"}).limit(10);if(F)throw F;be.debug("Fetched competition history",{bartenderId:L,resultCount:A==null?void 0:A.length}),I(A||[])}catch(A){be.error("Error fetching competition history:",{bartenderId:L,error:A}),k(`Failed to load competition history: ${A.message}`)}finally{S(!1)}})()},[L]);const M=(_,A)=>_==null||A==null?"?":Math.round(A-_);return e.jsxs("div",{className:"bg-neutral-900 rounded-lg shadow-md p-6 sticky top-8",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Recent Competition History"}),v?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx("div",{className:"animate-spin h-6 w-6 border-4 border-neutral-600 rounded-full border-t-transparent"}),e.jsx("span",{className:"ml-3 text-neutral-300",children:"Loading history..."})]}):C?e.jsx("div",{className:"text-red-400 p-4 text-center bg-red-900/20 rounded border border-red-800 text-sm",children:C}):z.length===0?e.jsx("div",{className:"text-neutral-400 p-6 text-center italic text-sm",children:"No competition history found."}):e.jsx("div",{className:"space-y-3",children:z.map((_,A)=>{var B,T,H;const F=M(_.pre_competition_rating,_.post_competition_rating),X=(B=_.legacy_competitions)!=null&&B.date?new Date(_.legacy_competitions.date).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"}):"Unknown Date",q=F==="?"?"text-neutral-400":F>0?"text-green-400":"text-red-400",ie=(T=_.legacy_competitions)!=null&&T.id?`${_.legacy_competitions.id}-${A}`:A;return e.jsxs("div",{className:"p-3 bg-neutral-800 rounded-lg hover:bg-neutral-700 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h4",{className:"font-medium text-white text-sm leading-tight",children:((H=_.legacy_competitions)==null?void 0:H.name)||"Unknown Competition"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-neutral-400",children:X}),e.jsx("div",{className:`text-xs font-medium ${q}`,children:F==="?"?"?":F>=0?`+${F}`:F})]})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("span",{className:"text-xs text-neutral-300",children:["Position: #",_.placement||"N/A"]})})]},ie)})})]})},Vt=()=>{var ot,ct,dt,ut,mt;const{user:L,profile:E,isAuthenticated:z,loading:I,refreshProfile:v}=zt(),S=E==null?void 0:E.id,{profile:C,loading:k,error:M,updateProfile:_,createProfile:A,uploadImage:F,refresh:X}=Pt(S),{employment:q,loading:ie,addEmployment:B,updateEmployment:T,deleteEmployment:H,setEmployment:K}=At(S),{awards:G,loading:je,addAward:Ee,updateAward:ze,deleteAward:Z,setAwards:ce}=Mt(S),{cityChanges:P,loading:re,addCityChange:qe,updateCityChange:Pe,deleteCityChange:Ve,setCityChanges:pe}=Wt(S),{updateName:Ge,updateVenue:st}=Tt(S);x.useEffect(()=>{C&&(K(C.employment||[]),ce(C.awards||[]),pe(C.cityChanges||[]))},[C,K,ce,pe]);const[Ke,ye]=x.useState(!1),[oe,Ne]=x.useState(null),[Qe,de]=x.useState(!1),[ve,fe]=x.useState(null),[ae,ue]=x.useState(null),[me,Ce]=x.useState(null),[he,Ae]=x.useState({cover:null,profile:null}),[lt,Me]=x.useState({cover:null,profile:null}),[He,Se]=x.useState({cover:null,profile:null}),[p,W]=x.useState({stillWorking:!0,stillLiveHere:!0}),[b,Q]=x.useState({}),[Je,Te]=x.useState(!1),[et,De]=x.useState(""),[xe,se]=x.useState(!1),[t,n]=x.useState(!1),[r,s]=x.useState(null),[o,l]=x.useState(!1),[m,f]=x.useState(!1),w=x.useRef(null),y=x.useRef(null);x.useEffect(()=>{if(r&&t){const i=r.rawData;r.type==="job_start"||r.type==="job_end"?W(a=>({...a,title:i.position_title||"",startDate:i.start_date||"",endDate:i.end_date||"",stillWorking:i.is_current||!1,description:i.description||"",company:i.venues||null})):r.type==="award"?W(a=>{var c;return{...a,title:i.award_title||"",date:i.award_date||"",organizerId:i.organizer_id||null,organizerName:((c=i.organisers)==null?void 0:c.organisation_name)||""}}):r.type==="city_move"&&W(a=>({...a,moveDate:i.move_date||"",newCity:i.to_cities||null,previousCity:i.from_cities||null}))}},[r,t]);const j=x.useCallback(()=>{const i=[],a=d();return q.forEach(c=>{var Y,ee;const R=c.is_current&&a?a:c.venues?`${c.venues.city||"Unknown City"}, ${c.venues.country||"Unknown Country"}`:"Location unknown";i.push({type:"job_start",title:`Started as ${c.position_title}`,company:((Y=c.venues)==null?void 0:Y.name)||"Unknown Venue",date:c.start_date,location:R,id:`job_start_${c.id}`,rawData:c}),c.end_date&&!c.is_current&&i.push({type:"job_end",title:`Left ${c.position_title} position`,company:((ee=c.venues)==null?void 0:ee.name)||"Unknown Venue",date:c.end_date,location:R,id:`job_end_${c.id}`,rawData:c})}),G.forEach(c=>{var R,Y;i.push({type:"award",title:c.award_title,event:((R=c.organisers)==null?void 0:R.organisation_name)||"Competition",date:c.award_date,location:((Y=c.organisers)==null?void 0:Y.organisation_name)||"Competition Location",id:`award_${c.id}`,rawData:c})}),P.forEach(c=>{var R;i.push({type:"city_move",title:`Moved to ${((R=c.to_cities)==null?void 0:R.city)||"Unknown City"}`,location:c.to_cities?`${c.to_cities.city}${c.to_cities.state?", "+c.to_cities.state:""}, ${c.to_cities.country}`:"Unknown Location",date:c.move_date,previousCity:c.from_cities?`${c.from_cities.city}${c.from_cities.state?", "+c.from_cities.state:""}, ${c.from_cities.country}`:"Unknown Location",id:`city_move_${c.id}`,rawData:c})}),i.sort((c,R)=>new Date(R.date)-new Date(c.date))},[q,G,P,C]),D=()=>{var a,c;const i=q.find(R=>R.is_current);if(i){const R=d();return{name:((a=i.venues)==null?void 0:a.name)||"Current Workplace",position:i.position_title,location:R||"Location unknown"}}if(q.length>0){const R=q.reduce((Y,ee)=>new Date(ee.start_date)>new Date(Y.start_date)?ee:Y);return{name:((c=R.venues)==null?void 0:c.name)||"Recent Workplace",position:R.position_title,location:R.venues?`${R.venues.city||"Unknown City"}, ${R.venues.country||"Unknown Country"}`:"Unknown Location"}}return{name:"Your Current Workplace",position:"Your Position",location:"Your Location"}},d=()=>{var i;if(P.length>0){const c=[...P].sort((R,Y)=>new Date(Y.move_date)-new Date(R.move_date))[0];if(c.to_cities){const R=c.to_cities;return`${R.city}${R.state?", "+R.state:""}, ${R.country}`}}if((i=C==null?void 0:C.profile)!=null&&i.cities){const a=C.profile.cities;return`${a.city}${a.state?", "+a.state:""}, ${a.country}`}return null},h={coverPhoto:((ot=C==null?void 0:C.profile)==null?void 0:ot.cover_image_url)||Ye.cover,profilePhoto:((ct=C==null?void 0:C.profile)==null?void 0:ct.profile_image_url)||Ye.profile,fullName:((dt=C==null?void 0:C.bartender)==null?void 0:dt.full_name)||(E==null?void 0:E.full_name)||"Your Name",currentEmployer:D().name,currentPosition:D().position,currentLocation:D().location,city:d()||"Location unknown",publicProfileUrl:(ut=C==null?void 0:C.profile)!=null&&ut.public_profile_slug?Bt.generatePublicProfileUrl(C.profile.public_profile_slug):`${window.location.origin}${window.location.pathname.includes("masterbartendingchampionship")?"/masterbartendingchampionship":""}/#/profile/your-profile`,experience:j(),cocktails:[{id:1,name:"Smoky Manhattan",description:"A classic Manhattan with a smoky twist using mezcal",style:"Classic",category:"Whiskey",image:Ye.cocktail,details:{iceType:"Large cube",glassType:"Coupe",method:["Add ingredients to mixing glass with ice","Stir for 30 seconds until well chilled","Double strain into chilled coupe glass","Express orange peel over drink and garnish"],ingredients:["2 oz Rye Whiskey","0.5 oz Mezcal","1 oz Sweet Vermouth","2 dashes Angostura Bitters"],garnish:"Orange peel"}},{id:2,name:"Garden Gimlet",description:"A fresh take on the classic gimlet with cucumber and herbs",style:"Modern",category:"Gin",image:Ye.cocktail,details:{iceType:"Cubed ice",glassType:"Nick & Nora",method:["Muddle cucumber and basil in shaker","Add remaining ingredients and ice","Shake vigorously for 15 seconds","Double strain into chilled glass"],ingredients:["2 oz London Dry Gin","0.75 oz Fresh lime juice","0.75 oz Simple syrup","3 cucumber slices","4 fresh basil leaves"],garnish:"Cucumber wheel and basil sprig"}}]},u=i=>{Ne(i),ye(!0)},g=()=>`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(h.publicProfileUrl)}`,N=async()=>{if(navigator.share)try{await navigator.share({title:`${h.fullName} - MBC Profile`,text:`Check out ${h.fullName}'s bartending profile`,url:h.publicProfileUrl})}catch(i){be.warn("Error sharing:",i)}else try{await navigator.clipboard.writeText(h.publicProfileUrl),alert("Profile URL copied to clipboard!")}catch(i){be.warn("Could not copy to clipboard:",i)}},O=i=>{fe(ve===i?null:i)},$=i=>{switch(i){case"job_start":case"job_end":return"ðŸ’¼";case"award":return"ðŸ…";case"competition":return"ðŸ†";case"city_move":return"âœˆï¸";default:return"ðŸ“"}},U=i=>new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),J=(i,a)=>{const c=i.target.files[0];if(c){const R=new FileReader;R.onload=Y=>{Ae(ee=>({...ee,[a]:Y.target.result}))},R.readAsDataURL(c),W(Y=>({...Y,[`${a}File`]:c}))}},V=(i,a)=>{var R,Y,ee;const c={};switch(i){case"employment":(R=a.title)!=null&&R.trim()||(c.title="Position title is required"),!a.company&&!p.company&&(c.company="Company/Bar is required"),a.startDate||(c.startDate="Start date is required"),!a.stillWorking&&!a.endDate&&(c.endDate="End date is required when not currently working");break;case"cityChange":!a.newCity&&!p.newCity&&(c.newCity="New city is required"),!a.previousCity&&!p.previousCity&&(c.previousCity="Previous city is required"),!a.stillLiveHere&&!a.moveDate&&(c.moveDate="Move date is required when not currently living here");break;case"award":(Y=a.title)!=null&&Y.trim()||(c.title="Award title is required"),a.organizerId||(c.organizerId="Event/Organization is required"),a.date||(c.date="Award date is required");break;case"name":(ee=a.fullName)!=null&&ee.trim()||(c.fullName="Full name is required");break;case"city":!a.newCity&&!p.newCity&&(c.newCity="City is required");break}return c},ge=async(i,a)=>{var R,Y,ee,We,Be,Fe,Ie,le,ht,pt,ft,xt;console.log("handleFormSubmit called with:",{modalType:i,data:a,formData:p});const c=V(i,a);if(Q(c),Object.keys(c).length===0)try{Q({});let Ue={...a};switch(i){case"employment":const _t=((R=a.company)==null?void 0:R.id)||((Y=p.company)==null?void 0:Y.id),gt={position_title:a.title,venue_id:_t,start_date:a.startDate,end_date:a.stillWorking?null:a.endDate,is_current:a.stillWorking,description:a.description};console.log("Employment submission - full data:",{data:a,formData:p,employmentData:gt}),await B(gt),await ne(`Employment record for ${a.title} has been added successfully!`);break;case"award":await Ee({award_title:a.title,organizer_id:a.organizerId||p.organizerId,award_date:a.date}),await ne(`Award "${a.title}" has been added successfully!`);break;case"cityChange":const bt={from_city_id:((ee=a.previousCity)==null?void 0:ee.id)||((We=p.previousCity)==null?void 0:We.id),to_city_id:((Be=a.newCity)==null?void 0:Be.id)||((Fe=p.newCity)==null?void 0:Fe.id),move_date:a.stillLiveHere?new Date().toISOString().split("T")[0]:a.moveDate};console.log("City change submission - full data:",{data:a,formData:p,cityChangeData:bt}),await qe(bt);const Et=((Ie=a.newCity||p.newCity)==null?void 0:Ie.city)||"new city";await ne(`City change to ${Et} has been added successfully!`);break;case"city":if((le=a.newCity)!=null&&le.id||(ht=p.newCity)!=null&&ht.id){await _({cityId:((pt=a.newCity)==null?void 0:pt.id)||((ft=p.newCity)==null?void 0:ft.id)});const Oe=((xt=a.newCity||p.newCity)==null?void 0:xt.city)||"new city";await ne(`Your current city has been updated to ${Oe}!`)}break;case"cover":case"profile":if(He[i])try{const Oe=await He[i](),St=await(await fetch(Oe)).blob();await F(St,i),await ne(`Your ${i==="cover"?"cover photo":"profile image"} has been updated successfully!`)}catch(Oe){be.error("Error processing cropped image:",Oe),Q({submit:"Error processing image. Please try again."});return}break;case"name":await Ge(a.fullName),await ne(`Your name has been updated to "${a.fullName}" successfully!`);break;default:console.log("Unhandled form type:",i,Ue)}ue(null),Ce(null),W({stillWorking:!0}),Ae({cover:null,profile:null}),Me({cover:null,profile:null}),Se({cover:null,profile:null}),Q({})}catch(Ue){be.error("Error submitting form:",Ue),Q({submit:Ue.message||"An error occurred while saving. Please try again."})}},ne=x.useCallback(async i=>{try{await Promise.all([X(),v()]),De(i),se(!0),setTimeout(()=>{se(!1),De("")},3e3),be.info("Profile data and auth context refreshed, success shown")}catch(a){be.error("Error refreshing profile data:",a),De(i),se(!0),setTimeout(()=>{se(!1),De("")},3e3)}},[X,v]),tt=async(i,a)=>{var Y,ee,We,Be,Fe,Ie;console.log("handleEditExperience called with:",{experience:i,data:a,formData:p});let c;i.type==="job_start"||i.type==="job_end"?c="employment":i.type==="award"?c="award":i.type==="city_move"&&(c="cityChange");const R=V(c,a);if(Q(R),!(Object.keys(R).length>0))try{if(i.type==="job_start"||i.type==="job_end"){const le={position_title:a.title,venue_id:((Y=a.company)==null?void 0:Y.id)||((ee=p.company)==null?void 0:ee.id),start_date:a.startDate,end_date:a.stillWorking?null:a.endDate,is_current:a.stillWorking,description:a.description};console.log("Updating employment with:",le),await T(i.rawData.id,le),await ne("Employment record has been updated successfully!")}else if(i.type==="award"){const le={award_title:a.title,organizer_id:a.organizerId||p.organizerId,award_date:a.date};console.log("Updating award with:",le),await ze(i.rawData.id,le),await ne("Award has been updated successfully!")}else if(i.type==="city_move"){const le={from_city_id:((We=a.previousCity)==null?void 0:We.id)||((Be=p.previousCity)==null?void 0:Be.id),to_city_id:((Fe=a.newCity)==null?void 0:Fe.id)||((Ie=p.newCity)==null?void 0:Ie.id),move_date:a.moveDate};console.log("Updating city change with:",le),await Pe(i.rawData.id,le),await ne("City change has been updated successfully!")}n(!1),s(null),W({stillWorking:!0}),Q({})}catch(le){console.error("Error updating experience:",le),Q({submit:le.message||"An error occurred while updating the experience."})}},Nt=async i=>{if(!(!i||!window.confirm(`Are you sure you want to delete this ${i.type==="job_start"||i.type==="job_end"?"employment record":i.type==="award"?"award":i.type==="city_move"?"city change":"experience"}? This action cannot be undone.`)))try{Q({}),i.type==="job_start"||i.type==="job_end"?(await H(i.rawData.id),await ne("Employment record has been deleted successfully!")):i.type==="award"?(await Z(i.rawData.id),await ne("Award has been deleted successfully!")):i.type==="city_move"&&(await Ve(i.rawData.id),await ne("City change has been deleted successfully!")),n(!1),s(null),W({stillWorking:!0,stillLiveHere:!0}),Q({})}catch(c){console.error("Error deleting experience:",c),Q({submit:c.message||"An error occurred while deleting the experience."})}},Le=()=>{ue(null),Ce(null),Te(!1),W({stillWorking:!0,stillLiveHere:!0}),Ae({cover:null,profile:null}),Me({cover:null,profile:null}),Se({cover:null,profile:null}),Q({})},$e=x.useCallback((i,a)=>{a.getCroppedResult&&Se(c=>({...c,[i]:a.getCroppedResult})),Me(c=>({...c,[i]:a}))},[]),Ct=x.useCallback(i=>{$e("cover",i)},[$e]),kt=x.useCallback(i=>{$e("profile",i)},[$e]);return x.useEffect(()=>{const i=a=>{w.current&&!w.current.contains(a.target)&&ve==="edit"&&fe(null),y.current&&!y.current.contains(a.target)&&m&&f(!1)};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[ve,m]),I||k?e.jsx("div",{className:"min-h-screen bg-black py-8 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-neutral-600 mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-neutral-300",children:"Loading your profile..."})]})}):!z||!S?e.jsx("div",{className:"min-h-screen bg-black py-8 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-neutral-300",children:"You need to be signed in to view your profile."})]})}):M?e.jsx("div",{className:"min-h-screen bg-black py-8 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-400 mb-4",children:"Error Loading Profile"}),e.jsx("p",{className:"text-neutral-300 mb-4",children:M.message||"Failed to load profile data"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-neutral-700 text-white px-4 py-2 rounded hover:bg-neutral-600",children:"Retry"})]})}):I||k||!S?e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-neutral-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Loading Your Profile"}),e.jsx("p",{className:"text-neutral-300",children:"Please wait while we fetch your information..."})]})}):M?e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 19c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Error Loading Profile"}),e.jsx("p",{className:"text-neutral-300 mb-4",children:M.message||"Unable to load your profile data"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-neutral-700 text-white rounded-md hover:bg-neutral-600 transition-colors",children:"Retry"})]})}):e.jsxs("div",{className:"min-h-screen bg-black py-8",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-neutral-900 rounded-lg shadow-md overflow-hidden",children:[e.jsxs("div",{className:"group h-48 bg-gradient-to-r from-blue-500 to-purple-600 relative",children:[e.jsx(Ze,{src:h.coverPhoto,alt:"Cover",className:"w-full h-full object-cover"}),e.jsx("button",{onClick:()=>ue("cover"),className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity p-2 bg-black bg-opacity-50 text-white hover:bg-opacity-70 rounded-full",title:"Edit cover photo",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("div",{className:"absolute -bottom-16 left-6",children:e.jsxs("div",{className:"group relative w-32 h-32 bg-neutral-800 rounded-full p-1 shadow-lg",children:[e.jsx(Ze,{src:h.profilePhoto,alt:"Profile",className:"w-full h-full rounded-full object-cover"}),e.jsx("button",{onClick:()=>ue("profile"),className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity p-1.5 bg-black bg-opacity-50 text-white hover:bg-opacity-70 rounded-full",title:"Edit profile photo",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})})]}),e.jsxs("div",{className:"relative px-6 pt-20 pb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"group relative inline-block",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:h.fullName}),e.jsx("button",{onClick:()=>ue("name"),className:"absolute -top-1 -right-8 opacity-0 group-hover:opacity-100 transition-opacity p-1 text-neutral-500 hover:text-neutral-400 hover:bg-neutral-800 rounded-full",title:"Edit name",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]}),e.jsx("p",{className:"text-xl text-neutral-300 mb-1",children:h.currentEmployer}),e.jsx("p",{className:"text-lg text-neutral-400",children:h.city})]}),e.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-2",children:[e.jsxs("div",{className:"relative",ref:w,children:[e.jsxs("button",{onClick:()=>O("edit"),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-neutral-800 transition-colors text-sm font-medium",title:"Edit Profile",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit",e.jsx("span",{className:`transform transition-transform ${ve==="edit"?"rotate-180":""}`,children:"â–¼"})]}),ve==="edit"&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 bg-neutral-800 border border-neutral-700 rounded-md shadow-lg z-10 w-56",children:[e.jsx("button",{onClick:()=>{ue("name"),fe(null)},className:"block w-full text-left px-4 py-2 hover:bg-neutral-700 text-sm text-neutral-200",children:"Change Name"}),e.jsx("button",{onClick:()=>{ue("cover"),fe(null)},className:"block w-full text-left px-4 py-2 hover:bg-neutral-700 text-sm text-neutral-200",children:"Change Cover Photo"}),e.jsx("button",{onClick:()=>{ue("profile"),fe(null)},className:"block w-full text-left px-4 py-2 hover:bg-neutral-700 text-sm text-neutral-200",children:"Change Profile Image"})]})]}),e.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",title:"Share Profile",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share"]})]})]})]}),e.jsxs("div",{className:"bg-neutral-900 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Experience"}),e.jsxs("div",{className:"relative",ref:y,children:[e.jsx("button",{onClick:()=>f(!m),className:"w-8 h-8 bg-neutral-600 text-white rounded-full flex items-center justify-center hover:bg-neutral-500 transition-colors",title:"Add new experience",children:"+"}),m&&e.jsxs("div",{className:"absolute top-full right-0 bg-neutral-800 border border-neutral-700 rounded-md shadow-lg z-10 mt-1 w-48",children:[e.jsx("button",{onClick:()=>{Ce("employment"),f(!1)},className:"block w-full text-left px-4 py-2 hover:bg-neutral-700 text-sm text-neutral-200",children:"Add Employment"}),e.jsx("button",{onClick:()=>{Ce("cityChange"),f(!1)},className:"block w-full text-left px-4 py-2 hover:bg-neutral-700 text-sm text-neutral-200",children:"Add City Change"}),e.jsx("button",{onClick:()=>{Ce("award"),f(!1)},className:"block w-full text-left px-4 py-2 hover:bg-neutral-700 text-sm text-neutral-200",children:"Add Award"}),e.jsx("button",{onClick:()=>{Te(!0),f(!1)},className:"block w-full text-left px-4 py-2 hover:bg-neutral-700 text-sm text-neutral-200",children:"Submit Competition Result"})]})]})]}),e.jsx("div",{className:"space-y-6",children:h.experience.map((i,a)=>e.jsxs("div",{className:"group relative flex items-start space-x-4 p-3 rounded-lg hover:bg-neutral-800 transition-colors",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-neutral-800 flex items-center justify-center text-lg",children:$(i.type)})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:i.title}),e.jsxs("p",{className:"text-neutral-300",children:[i.company||i.event,i.type==="city_move"&&i.previousCity&&e.jsxs("span",{children:[" (from ",i.previousCity,")"]})]}),e.jsxs("p",{className:"text-sm text-neutral-400",children:[U(i.date)," â€¢ ",i.location]})]}),e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onClick:()=>{s(i),n(!0)},className:"p-2 text-neutral-500 hover:text-neutral-400 hover:bg-neutral-700 rounded-full transition-colors",title:"Edit this experience",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})})]},i.id||a))})]}),e.jsxs("div",{className:"bg-neutral-900 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"My Cocktails"}),e.jsx("button",{onClick:()=>de(!0),className:"w-8 h-8 bg-neutral-600 text-white rounded-full flex items-center justify-center hover:bg-neutral-500 transition-colors",title:"Add new cocktail",children:"+"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.cocktails.map(i=>e.jsxs("div",{onClick:()=>u(i),className:"border border-neutral-700 rounded-lg p-4 cursor-pointer hover:shadow-md hover:bg-neutral-800 transition-all",children:[e.jsx(Ze,{src:i.image,alt:i.name,className:"w-full h-32 object-cover rounded-md mb-3"}),e.jsx("h3",{className:"font-semibold text-lg text-white",children:i.name}),e.jsx("p",{className:"text-neutral-300 text-sm mb-2",children:i.description}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("span",{className:"px-2 py-1 bg-neutral-700 text-neutral-200 text-xs rounded",children:i.style}),e.jsx("span",{className:"px-2 py-1 bg-neutral-600 text-neutral-200 text-xs rounded",children:i.category})]})]},i.id))})]})]}),e.jsx("div",{className:"lg:col-span-1 space-y-6",children:e.jsx($t,{bartenderId:S,bartenderName:h.fullName})})]})}),Ke&&oe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[9999]",children:e.jsx("div",{className:"bg-neutral-900 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:oe.name}),e.jsx("button",{onClick:()=>ye(!1),className:"text-neutral-500 hover:text-neutral-400 text-2xl",children:"Ã—"})]}),e.jsx(Ze,{src:oe.image,alt:oe.name,className:"w-full h-48 object-cover rounded-lg mb-4"}),e.jsx("p",{className:"text-neutral-300 mb-4",children:oe.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 text-white",children:"Details"}),e.jsxs("p",{className:"text-neutral-300",children:[e.jsx("strong",{className:"text-white",children:"Ice Type:"})," ",oe.details.iceType]}),e.jsxs("p",{className:"text-neutral-300",children:[e.jsx("strong",{className:"text-white",children:"Glass Type:"})," ",oe.details.glassType]}),e.jsxs("p",{className:"text-neutral-300",children:[e.jsx("strong",{className:"text-white",children:"Garnish:"})," ",oe.details.garnish]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 text-white",children:"Ingredients"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:oe.details.ingredients.map((i,a)=>e.jsx("li",{className:"text-sm text-neutral-300",children:i},a))})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 text-white",children:"Method"}),e.jsx("ol",{className:"list-decimal list-inside space-y-2",children:oe.details.method.map((i,a)=>e.jsx("li",{className:"text-sm text-neutral-300",children:i},a))})]})]})})}),Qe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[9999]",children:e.jsx("div",{className:"bg-neutral-900 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Add New Cocktail"}),e.jsx("button",{onClick:()=>de(!1),className:"text-neutral-500 hover:text-neutral-400 text-2xl",children:"Ã—"})]}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Name*"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Description*"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500",rows:"3"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Style*"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500",children:[e.jsx("option",{value:"",children:"Select style"}),e.jsx("option",{value:"Classic",children:"Classic"}),e.jsx("option",{value:"Modern",children:"Modern"}),e.jsx("option",{value:"Tiki",children:"Tiki"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Category*"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500",children:[e.jsx("option",{value:"",children:"Select category"}),e.jsx("option",{value:"Whiskey",children:"Whiskey"}),e.jsx("option",{value:"Gin",children:"Gin"}),e.jsx("option",{value:"Vodka",children:"Vodka"}),e.jsx("option",{value:"Rum",children:"Rum"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Ice Type*"}),e.jsx("input",{type:"text",placeholder:"e.g., Large cube",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white placeholder-neutral-400 rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Glass Type*"}),e.jsx("input",{type:"text",placeholder:"e.g., Coupe",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white placeholder-neutral-400 rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Image"}),e.jsx("input",{type:"file",accept:"image/*",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Ingredients*"}),e.jsx("textarea",{placeholder:"List ingredients with measurements...",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white placeholder-neutral-400 rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500",rows:"4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Method Steps*"}),e.jsx("textarea",{placeholder:`1. Step one
2. Step two
3. Step three...`,className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white placeholder-neutral-400 rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500",rows:"4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Garnish"}),e.jsx("input",{type:"text",placeholder:"e.g., Orange peel",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white placeholder-neutral-400 rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>de(!1),className:"flex-1 px-4 py-2 text-gray-300 bg-neutral-700 rounded-md hover:bg-neutral-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-neutral-600 text-white rounded-md hover:bg-neutral-500",children:"Add Cocktail"})]})]})]})})}),ae&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[9999]",children:e.jsx("div",{className:"bg-neutral-900 rounded-lg max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:[ae==="name"&&"Change Name",ae==="cover"&&"Change Cover Photo",ae==="city"&&"Change City",ae==="profile"&&"Change Profile Image"]}),e.jsx("button",{onClick:Le,className:"text-gray-400 hover:text-gray-300 text-2xl",children:"Ã—"})]}),e.jsxs("form",{onSubmit:i=>{i.preventDefault();const a=new FormData(i.target),c=Object.fromEntries(a.entries());ge(ae,c)},className:"space-y-4",children:[ae==="name"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Full Name*"}),e.jsx("input",{type:"text",name:"fullName",defaultValue:h.fullName,className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.fullName&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.fullName}),e.jsx("div",{className:"mt-3 p-3 bg-blue-900/20 border border-blue-800 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-300",children:[e.jsx("strong",{children:"ðŸ’¡ Tip:"})," To update your employer or location in your bio, use the Experience card below to add or edit your employment and city change records."]})})]}),ae==="cover"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Cover Photo*"}),e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Upload an image and use the cropping tools to position it perfectly"}),e.jsx("input",{type:"file",name:"coverFile",accept:"image/*",onChange:i=>J(i,"cover"),className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),he.cover&&e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(jt,{imageUrl:he.cover,cropType:"cover",onCropChange:Ct,className:"rounded-lg"},`cover-${he.cover}`)})})]}),ae==="city"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"City*"}),e.jsx(ke,{value:h.city,onSelect:i=>W(a=>({...a,newCity:i}))}),b.newCity&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.newCity})]}),ae==="profile"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Profile Image*"}),e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Upload an image and use the cropping tools to position it perfectly"}),e.jsx("input",{type:"file",name:"profileFile",accept:"image/*",onChange:i=>J(i,"profile"),className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),he.profile&&e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(jt,{imageUrl:he.profile,cropType:"profile",onCropChange:kt,className:"rounded-lg"},`profile-${he.profile}`)})})]}),b.submit&&e.jsx("div",{className:"bg-red-900/20 border border-red-800 rounded-md p-3",children:e.jsx("p",{className:"text-red-400 text-sm",children:b.submit})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Le,className:"flex-1 px-4 py-2 text-gray-300 bg-neutral-700 rounded-md hover:bg-neutral-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-neutral-600 text-white rounded-md hover:bg-neutral-500",children:"Save Changes"})]})]})]})})}),me&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[9999]",children:e.jsx("div",{className:"bg-gray-800 rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:[me==="employment"&&"Add Employment",me==="cityChange"&&"Add City Change",me==="award"&&"Add Award"]}),e.jsx("button",{onClick:Le,className:"text-gray-400 hover:text-gray-300 text-2xl",children:"Ã—"})]}),e.jsxs("form",{onSubmit:i=>{i.preventDefault();const a=new FormData(i.target),c=Object.fromEntries(a.entries());c.stillWorking=p.stillWorking,c.organizerId=p.organizerId,c.newCity=p.newCity,c.previousCity=p.previousCity,c.location=p.location,c.company=p.company,ge(me,c)},className:"space-y-4",children:[me==="employment"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Position Title*"}),e.jsx("input",{type:"text",name:"title",placeholder:"e.g., Head Bartender",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white placeholder-neutral-400 rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.title&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Company/Bar*"}),e.jsx(vt,{onSelect:i=>{console.log("BarSelect onSelect called with:",i),W(a=>({...a,company:i}))},placeholder:"Select or enter bar name"}),b.company&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.company})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Start Date*"}),e.jsx("input",{type:"date",name:"startDate",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.startDate&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.startDate})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("input",{type:"checkbox",id:"stillWorking",checked:p.stillWorking!==!1,onChange:i=>W(a=>({...a,stillWorking:i.target.checked})),className:"h-4 w-4 text-blue-600 rounded border-neutral-700 bg-neutral-800 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"stillWorking",className:"ml-2 text-sm font-medium text-neutral-200",children:"I still work here"})]}),p.stillWorking===!1&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"End Date*"}),e.jsx("input",{type:"date",name:"endDate",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.endDate&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.endDate})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Location*"}),e.jsx(ke,{onSelect:i=>W(a=>({...a,location:i})),placeholder:"Select or enter city"}),b.location&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.location})]})]}),me==="cityChange"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"New City*"}),e.jsx(ke,{onSelect:i=>W(a=>({...a,newCity:i})),placeholder:"Select or enter new city"}),b.newCity&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.newCity})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-neutral-200",children:[e.jsx("input",{type:"checkbox",name:"stillLiveHere",checked:p.stillLiveHere!==void 0?p.stillLiveHere:!0,onChange:i=>W(a=>({...a,stillLiveHere:i.target.checked})),className:"mr-2 h-4 w-4 text-blue-600 rounded border-neutral-700 bg-neutral-800 focus:ring-blue-500"}),"I still live here"]})}),!p.stillLiveHere&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Previous City*"}),e.jsx(ke,{onSelect:i=>W(a=>({...a,previousCity:i})),placeholder:"Select or enter previous city"}),b.previousCity&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.previousCity})]}),!p.stillLiveHere&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Move Date*"}),e.jsx("input",{type:"date",name:"moveDate",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.moveDate&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.moveDate})]})]}),me==="award"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Award Title*"}),e.jsx("input",{type:"text",name:"title",placeholder:"e.g., Best Bartender 2024",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white placeholder-neutral-400 rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.title&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Event/Organization*"}),e.jsx(yt,{onSelect:i=>W(a=>({...a,organizerId:i.id,organizerName:i.organisation_name})),placeholder:"Select or add organization"}),b.organizerId&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.organizerId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Award Date*"}),e.jsx("input",{type:"date",name:"date",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.date&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Location*"}),e.jsx(ke,{onSelect:i=>W(a=>({...a,location:i})),placeholder:"Select or enter city"}),b.location&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.location})]})]}),b.submit&&e.jsx("div",{className:"bg-red-900/20 border border-red-800 rounded-md p-3",children:e.jsx("p",{className:"text-red-400 text-sm",children:b.submit})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Le,className:"flex-1 px-4 py-2 text-gray-300 bg-neutral-700 rounded-md hover:bg-neutral-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-neutral-600 text-white rounded-md hover:bg-neutral-500",children:"Add Experience"})]})]})]})})}),t&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[9999]",children:e.jsx("div",{className:"bg-gray-800 rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:["Edit ",r.type==="job_start"||r.type==="job_end"?"Employment":r.type==="award"?"Award":r.type==="city_move"?"City Change":"Experience"]}),e.jsx("button",{onClick:()=>{n(!1),s(null),W({stillWorking:!0}),Q({})},className:"text-gray-400 hover:text-gray-300 text-2xl",children:"Ã—"})]}),e.jsxs("form",{onSubmit:i=>{i.preventDefault();const a=new FormData(i.target),c=Object.fromEntries(a.entries());c.company=p.company,c.organizerId=p.organizerId,c.newCity=p.newCity,c.previousCity=p.previousCity,tt(r,c)},className:"space-y-4",children:[(r.type==="job_start"||r.type==="job_end")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Position Title*"}),e.jsx("input",{type:"text",name:"title",value:p.title||"",onChange:i=>W(a=>({...a,title:i.target.value})),placeholder:"e.g., Head Bartender",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white placeholder-neutral-400 rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.title&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Company/Bar*"}),e.jsx(vt,{value:((mt=p.company)==null?void 0:mt.name)||"",onSelect:i=>W(a=>({...a,company:i})),placeholder:"Select or add company"}),b.company&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.company})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Start Date*"}),e.jsx("input",{type:"date",name:"startDate",value:p.startDate||"",onChange:i=>W(a=>({...a,startDate:i.target.value})),className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.startDate&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.startDate})]}),e.jsx("div",{children:e.jsxs("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:[e.jsx("input",{type:"checkbox",name:"stillWorking",checked:p.stillWorking||!1,onChange:i=>W(a=>({...a,stillWorking:i.target.checked})),className:"mr-2 h-4 w-4 text-blue-600 rounded border-neutral-700 bg-neutral-800 focus:ring-blue-500"}),"I still work here"]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:p.endDate||"",onChange:i=>W(a=>({...a,endDate:i.target.value})),className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.endDate&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.endDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:p.description||"",onChange:i=>W(a=>({...a,description:i.target.value})),placeholder:"Describe your role and achievements",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white placeholder-neutral-400 rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500",rows:"3"})]})]}),r.type==="award"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Award Title*"}),e.jsx("input",{type:"text",name:"title",value:p.title||"",onChange:i=>W(a=>({...a,title:i.target.value})),placeholder:"e.g., Best Bartender 2024",className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white placeholder-neutral-400 rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.title&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Event/Organization*"}),e.jsx(yt,{value:p.organizerName||"",onSelect:i=>W(a=>({...a,organizerId:i.id,organizerName:i.organisation_name})),placeholder:"Select or add event/organization"}),b.organizerId&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.organizerId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Award Date*"}),e.jsx("input",{type:"date",name:"date",value:p.date||"",onChange:i=>W(a=>({...a,date:i.target.value})),className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.date&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.date})]})]}),r.type==="city_move"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"New City*"}),e.jsx(ke,{value:p.newCity?`${p.newCity.city}${p.newCity.state?", "+p.newCity.state:""}, ${p.newCity.country}`:"",onSelect:i=>W(a=>({...a,newCity:i})),placeholder:"Select or enter new city"}),b.newCity&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.newCity})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Previous City*"}),e.jsx(ke,{value:p.previousCity?`${p.previousCity.city}${p.previousCity.state?", "+p.previousCity.state:""}, ${p.previousCity.country}`:"",onSelect:i=>W(a=>({...a,previousCity:i})),placeholder:"Select or enter previous city"}),b.previousCity&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.previousCity})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-1",children:"Move Date*"}),e.jsx("input",{type:"date",name:"moveDate",value:p.moveDate||"",onChange:i=>W(a=>({...a,moveDate:i.target.value})),className:"w-full px-3 py-2 border border-neutral-700 bg-neutral-800 text-white rounded-md focus:border-neutral-500 focus:ring-1 focus:ring-neutral-500"}),b.moveDate&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:b.moveDate})]})]}),b.submit&&e.jsx("div",{className:"bg-red-900/20 border border-red-800 rounded-md p-3",children:e.jsx("p",{className:"text-red-400 text-sm",children:b.submit})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{n(!1),s(null),W({stillWorking:!0}),Q({})},className:"flex-1 px-4 py-2 text-gray-300 bg-neutral-700 rounded-md hover:bg-neutral-600",children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>Nt(r),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Delete"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-neutral-600 text-white rounded-md hover:bg-neutral-500",children:"Save Changes"})]})]})]})})}),Je&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[9999]",children:e.jsx("div",{className:"bg-gray-800 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Submit Competition Result"}),e.jsx("button",{onClick:Le,className:"text-gray-400 hover:text-gray-300 text-2xl",children:"Ã—"})]}),e.jsx(Ft,{onSuccess:async()=>{Le(),await showSuccessAndRefresh("Competition result has been submitted successfully!")},onError:i=>{console.error("Competition submission error:",i),Q({submit:i.message||"Error submitting competition result. Please try again."})}})]})})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[9999]",children:e.jsx("div",{className:"bg-gray-800 rounded-lg max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Share Public Profile"}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-300 text-2xl",children:"Ã—"})]}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("img",{src:g(),alt:"Profile QR Code",className:"mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Scan to view profile"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-200 mb-2",children:"Profile URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:h.publicProfileUrl,readOnly:!0,className:"flex-1 px-3 py-2 border border-neutral-700 rounded-md bg-neutral-800 text-white text-sm"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(h.publicProfileUrl)},className:"px-3 py-2 bg-neutral-700 hover:bg-neutral-600 text-white rounded-md text-sm font-medium transition-colors",title:"Copy URL",children:"Copy"})]})]}),e.jsx("button",{onClick:N,className:"w-full bg-neutral-600 text-white py-2 px-4 rounded-md hover:bg-neutral-500 transition-colors",children:"Share Profile"})]})})}),xe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999]",children:e.jsx("div",{className:"bg-gray-800 rounded-lg p-8 max-w-md w-full mx-4 transform animate-pulse",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Success!"}),e.jsx("p",{className:"text-gray-300 mb-4",children:et}),e.jsx("p",{className:"text-sm text-gray-400",children:"Your changes have been saved and your profile has been updated."})]})})})]})};export{Vt as default};
